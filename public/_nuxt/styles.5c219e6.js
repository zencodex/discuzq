(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r={name:"SvgIcon",props:{type:{type:String,default:""},rotate:{type:Boolean,default:!1}}},o=(n(481),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{class:["svg-icon","svg-icon-"+t.type,t.rotate?"rotate":""],attrs:{role:"img",title:t.type,"aria-hidden":"true"},on:{click:function(e){return t.$emit("click")}}},[n("use",{attrs:{"xlink:href":"#"+t.type}})])}),[],!1,null,"61a51cad",null);e.default=component.exports},,,,function(t,e,n){},,,,,function(t,e,n){"use strict";n.r(e);n(24);var r=n(379),o={props:{user:{type:[Object,String],default:function(){}},size:{type:[Number,String],default:50},round:{type:Boolean,default:!1},preventJump:{type:Boolean,default:!1}},data:function(){return{errorUrl:!1,sizes:{100:"font-size: 40px;line-height: 100px;border-radius: 2px",80:"font-size: 32px;line-height: 80px;border-radius: 2px",70:"font-size: 28px;line-height: 70px;border-radius: 2px",60:"font-size: 26px;line-height: 60px;border-radius: 2px",50:"font-size: 24px;line-height: 50px;border-radius: 2px",45:"font-size: 22px;line-height: 45px;border-radius: 2px",40:"font-size: 20px;line-height: 40px;border-radius: 2px",30:"font-size: 18px;line-height: 30px;border-radius: 2px",35:"font-size: 18px;line-height: 30px;border-radius: 2px",20:"font-size: 10px;line-height: 20px;border-radius: 2px"}}},computed:{avatarUrl:function(){return this.user.avatarUrl&&0!==this.user.avatarUrl.indexOf("/static/noavatar.gif")},usernameAt:function(){return this.user.username?this.user.username.charAt(0).toUpperCase():""},styleText:function(){return"background-color: #".concat(Object(r.a)(this.usernameAt),";").concat(this.sizes[this.size])},sizeClass:function(){return["avatar-size-"+this.size,this.preventJump?"prevent-jump":""]},isAnonymous:function(){return this.user._jv&&this.user._jv.id&&parseInt(this.user._jv.id)<0},roundClass:function(){return this.round?"round":""}},methods:{error:function(){this.errorUrl=!0}}},c=(n(484),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.user?n("a",{staticClass:"avatar-a",class:[t.sizeClass],attrs:{href:t.preventJump||t.isAnonymous?"javascript:void(0)":"/user/"+t.user.id}},[t.avatarUrl&&!t.errorUrl?n("img",{staticClass:"img",class:[t.sizeClass,t.roundClass],attrs:{src:t.user.avatarUrl,alt:t.user.username},on:{error:t.error}}):t.styleText?n("span",{class:["avatar",t.sizeClass,t.roundClass],style:t.styleText},[t._v("\n    "+t._s(t.usernameAt)+"\n  ")]):t._e(),t._v(" "),t.user.isReal?n("svg-icon",{class:{"auth-icon":!0,"auth-icon-round":t.round},attrs:{type:"auth"}}):t._e()],1):t._e()}),[],!1,null,"5bcd17f4",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);n(24);var r={mixins:[n(418).a],props:{loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},pageNum:{type:[Number,String],default:1},length:{type:[Number,String],default:0},surplus:{type:[Number,String],default:0},loadMoreText:{type:String,default:function(){return this.$t("topic.showMore")}}},methods:{scrollLoadMore:function(){(this.pageNum-1)%5>0&&!this.loading&&this.hasMore&&this.loadMore()},loadMore:function(){this.$emit("loadMore")}}},o=n(0),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"load-more-container"},[t.loading?n("loading"):[t.hasMore&&(t.pageNum-1)%5==0?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v("\n      "+t._s(t.surplus>0?t.$t("notice.checkMore",{surplus:t.surplus}):t.loadMoreText)+"\n    ")]):t.hasMore&&(t.pageNum-1)%5>0?n("loading"):n("div",{staticClass:"no-more"},[0===t.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v("\n      "+t._s(t.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Loading:n(364).default,SvgIcon:n(11).default})},,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);n(9);var r=n(49),time=n(21),o=n(95),c=n(1),l={filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[n.n(c).a],props:{item:{type:Object,default:function(){}},showShare:{type:Boolean,default:!0},lazy:{type:Boolean,default:!0},infoimage:{type:Boolean,default:!1},canDetail:{type:Boolean,default:!1}},data:function(){return{loading:!1,showVideoPop:!1,isLiked:!1,currentAudio:{id:"",url:"",currentTime:"",duration:"",audio:"",seeking:!1,isPlay:!1,isLoading:!1}}},computed:{unpaid:function(){return!(this.item.paid||0===parseFloat(this.item.price))}},watch:{item:{handler:function(t){this.isLiked=t.firstPost&&t.firstPost.isLiked,this.likeCount=t.firstPost&&t.firstPost.likeCount},deep:!0,immediate:!0}},mounted:function(){this.currentAudio.audio=document.getElementById("audio-player".concat(this.item&&this.item._jv&&this.item._jv.id))},methods:{handleLike:function(){var t=this;if(!this.loading){if(this.item.firstPost.canLike){this.loading=!0;var e=!this.isLiked,n={_jv:{type:"posts",id:this.item.firstPost&&this.item.firstPost._jv&&this.item.firstPost._jv.id},isLiked:e};return this.$store.dispatch("jv/patch",n).then((function(){t.$message.success(e?t.$t("discuzq.msgBox.likeSuccess"):t.$t("discuzq.msgBox.cancelLikeSuccess")),e?t.likeCount+=1:t.likeCount-=1,t.isLiked=e,t.$emit("change")}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))}this.$message.error(this.$t("topic.noThreadLikePermission"))}},toDetail:function(){this.canViewPostsFn()&&this.routerLink()},onClickImage:function(){this.unpaid&&this.canViewPostsFn()&&this.routerLink()},openVideo:function(){this.canViewPostsFn()&&(this.unpaid?this.routerLink():this.showVideoPop=!0)},routerLink:function(){window.open("/thread/".concat(this.item._jv&&this.item._jv.id),"_blank")},onClickContent:function(t){var e=t||window.event;"a"!==(e.target||e.srcElement).nodeName.toLocaleLowerCase()&&this.toDetail()},canViewPostsFn:function(){return this.item.canViewPosts?!this.canDetail||(this.$message.warning(this.$t("topic.joinAfterView")),!1):(this.$message.warning(this.$t("home.noPostingTopic")),!1)},formatTopicHTML:function(html){return r.a.parse(html)},extensionValidate:function(t){return o.extensionList.indexOf(t.toUpperCase())>0?t.toUpperCase():"UNKNOWN"},play:function(t){var e=this;this.unpaid?this.routerLink():this.canViewPostsFn()&&(this.currentAudio.id!==t._jv.id&&(this.resetAudio(this.currentAudio.audio),this.currentAudio.url=t.url||t.media_url,this.currentAudio.id=t._jv.id,this.currentAudio.audio.src=this.currentAudio.url,this.currentAudio.isLoading=!0,this.currentAudio.audio.load()),window.setTimeout((function(){e.currentAudio.audio.play(),e.currentAudio.isPlay=!0,e.currentAudio.audio.addEventListener("timeupdate",e.onProgressing),e.currentAudio.audio.addEventListener("ended",e.onEnded),e.$emit("audioPlay",e.currentAudio.id)}),0))},onProgressing:function(){this.currentAudio.seeking||(this.currentAudio.isLoading=!1,this.currentAudio.duration=this.currentAudio.audio.duration,this.currentAudio.currentTime=this.currentAudio.audio.currentTime)},onEnded:function(){this.resetAudio(this.currentAudio.audio)},resetAudio:function(audio){audio.removeEventListener("timeupdate",this.onProgressing),audio.removeEventListener("ended",this.onEnded),this.currentAudio.isPlay=!1,this.currentAudio.duration="",this.currentAudio.currentTime=""},pause:function(){this.currentAudio.isLoading=!1,this.currentAudio.isPlay=!1,this.currentAudio.audio.pause()},seek:function(time){this.currentAudio.seeking=!1,this.currentAudio.currentTime=time,this.currentAudio.audio.currentTime=time},seeking:function(time){this.currentAudio.seeking=!0,this.currentAudio.currentTime=time}}},d=(n(674),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-container"},[t.item.isEssence?n("div",{staticClass:"essence"},[n("svg-icon",{attrs:{type:"index-essence"}})],1):t._e(),t._v(" "),5===t.item.type&&t.item.question&&1===t.item.question.is_answer&&t.item.question.beUser?n("avatar",{staticClass:"avatar",attrs:{user:{id:t.item.question.beUser.id,username:t.item.question.beUser.username,avatarUrl:t.item.question.beUser.avatarUrl,isReal:t.item.question.beUser.isReal},"prevent-jump":t.canDetail}}):t.item.user?n("avatar",{staticClass:"avatar",attrs:{user:{id:t.item.user.id,username:t.item.user.username,avatarUrl:t.item.user.avatarUrl,isReal:t.item.user.isReal},"prevent-jump":t.canDetail}}):t._e(),t._v(" "),n("div",{staticClass:"main-cont"},[n("div",{staticClass:"top-flex"},[5===t.item.type&&t.item.question&&1===t.item.question.is_answer&&t.item.question.beUser?n("nuxt-link",{staticClass:"user-info",attrs:{to:t.item.user.id>0?"/user/"+t.item.question.beUser.id:""}},[n("span",{staticClass:"user-name"},[t._v(t._s(t.item.question.beUser.username))]),t._v(" "),t.item.question.beUser&&t.item.question.beUser.groups&&t.item.question.beUser.groups.length>0&&t.item.question.beUser.groups[0].isDisplay?n("span",{staticClass:"admin"},[t._v("\n          ("+t._s(t.item.question.beUser.groups[0].name)+")\n        ")]):t._e()]):t.item.user?n("nuxt-link",{staticClass:"user-info",attrs:{to:t.item.user.id>0?"/user/"+t.item.user.id:""}},[n("span",{staticClass:"user-name"},[t._v(t._s(t.item.user.username))]),t._v(" "),t.item.user&&t.item.user.groups&&t.item.user.groups.length>0&&t.item.user.groups[0].isDisplay?n("span",{staticClass:"admin"},[t._v("\n          ("+t._s(t.item.user.groups[0].name)+")\n        ")]):t._e()]):t._e(),t._v(" "),n("div",{staticClass:"time"},[5===t.item.type&&t.item.question&&1===t.item.question.is_answer?n("div",{staticClass:"answered"},[t._v(t._s(t.$t("topic.answered")))]):t._e(),t._v(" "),t.item.createdAt?[t._v(t._s(t.$t("topic.publishAt"))+" "+t._s(t._f("formatDate")(t.item.createdAt)))]:t._e()],2)],1),t._v(" "),5===t.item.type?n("div",[t.item.question&&0===t.item.question.is_answer?[t._v("\n        "+t._s(t.$t("topic.be"))+"\n        "),t.item.question&&t.item.question.beUser?n("nuxt-link",{staticClass:"blue",attrs:{to:t.item.question.beUser.id>0?"/user/"+t.item.question.beUser.id:""}},[t._v("@"+t._s(t.item.question.beUser.username))]):t._e(),t._v("\n        "+t._s(t.$t("topic.question"))+"\n      ")]:t._e(),t._v(" "),t.item.question&&1===t.item.question.is_answer?[t._v("\n        "+t._s(t.$t("topic.answer"))+"\n        "),t.item.user?n("nuxt-link",{staticClass:"blue",attrs:{to:t.item.user.id>0?"/user/"+t.item.user.id:""}},[t._v("@"+t._s(t.item.user.username))]):t._e(),t._v("\n        "+t._s(t.$t("topic.of"))+t._s(t.$t("topic.question"))+"\n      ")]:t._e()],2):t._e(),t._v(" "),t.item.firstPost?[n("div",{staticClass:"first-post",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[n("div",{on:{click:t.onClickContent}},[1===t.item.type?n("div",{staticClass:"title"},[t._v(t._s(t.$t("home.released"))+"\n            "),n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:parseFloat(t.item.price)>0||parseFloat(t.item.attachmentPrice)>0,expression:"parseFloat(item.price) > 0 || parseFloat(item.attachmentPrice) > 0"}],staticClass:"blue",staticStyle:{"font-size":"17px",display:"inline-block","margin-right":"5px"},attrs:{type:"pay-yuan"}}),t._v(" "),n("span",{staticClass:"blue "},[t._v(t._s(t.item.title))])],1):n("div",{staticClass:"content"},[5===t.item.type?n("svg-icon",{staticClass:"icon-pay-yuan blue",attrs:{type:"question-icon"}}):6===t.item.type?n("svg-icon",{staticClass:"icon-pay-yuan blue",attrs:{type:"product-icon"}}):parseFloat(t.item.price)>0||parseFloat(t.item.attachmentPrice)>0?n("svg-icon",{staticClass:"icon-pay-yuan grey",attrs:{type:"pay-yuan"}}):t._e(),t._v(" "),n("div",{class:{"content-block":5===t.item.type||6===t.item.type||parseFloat(t.item.price)>0,blue:5===t.item.type},domProps:{innerHTML:t._s(t.$xss(t.formatTopicHTML(t.item.firstPost.summary)))}})],1)]),t._v(" "),t.item.firstPost.images&&t.item.firstPost.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{ url: 'data-source' }"}],staticClass:"images",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},t._l(t.item.firstPost.images.slice(0,3),(function(image,e){return n("el-image",{key:e,class:{image:!0,infoimage:t.infoimage},attrs:{src:image.thumbUrl,"data-source":t.unpaid?"":image.url,alt:image.filename,fit:"cover",lazy:t.lazy},on:{click:function(e){return e.target!==e.currentTarget?null:t.onClickImage(e)}}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e(),t._v(" "),t.item.firstPost.images&&t.item.firstPost.images.length>3?n("div",{staticClass:"image-count",on:{click:t.toDetail}},[t._v("\n          "+t._s(t.$t("home.total"))+" "+t._s(t.item.firstPost.images.length)+"\n          "+t._s(t.$t("home.seeAllImage"))+"\n        ")]):t._e(),t._v(" "),2===t.item.type&&t.item.threadVideo?n("div",{staticClass:"video-main",on:{click:function(e){return e.stopPropagation(),t.openVideo(e)}}},[t.item.threadVideo.cover_url?n("el-image",{staticClass:"video-img-cover",attrs:{src:t.item.threadVideo.cover_url,alt:t.item.threadVideo.file_name,fit:"cover",lazy:t.lazy}}):n("div",{staticClass:"no-cover"},[t._v(t._s(t.$t("home.noPoster")))]),t._v(" "),n("svg-icon",{staticClass:"video-play",attrs:{type:"video-play"}})],1):t._e(),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{"cover-url":t.item.threadVideo.cover_url,url:t.item.threadVideo.media_url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e(),t._v(" "),t.item.firstPost.attachments&&t.item.firstPost.attachments.length>0?n("div",{staticClass:"attachment",on:{click:t.toDetail}},[n("svg-icon",{attrs:{type:t.extensionValidate(t.item.firstPost.attachments[0].extension)}}),t._v(" "),n("div",{staticClass:"name text-hidden"},[t._v("\n            "+t._s(t.item.firstPost.attachments[0].fileName)+"\n          ")]),t._v(" "),t.item.firstPost.attachments.length>1?n("div",{staticClass:"total"},[t._v("\n            "+t._s(t.$t("home.etc")+t.item.firstPost.attachments.length+t.$t("home.attachmentTotal"))+"\n          ")]):t._e()],1):t._e()],1),t._v(" "),6===t.item.type?n("product-item",{attrs:{item:t.item&&t.item.firstPost&&t.item.firstPost.postGoods}}):t._e(),t._v(" "),4===t.item.type?n("div",{on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[n("audio-player",{attrs:{file:t.item&&t.item.threadAudio,"current-audio":t.currentAudio},on:{play:t.play,pause:t.pause,seek:t.seek,seeking:t.seeking}}),t._v(" "),n("audio",{staticClass:"audio-player",staticStyle:{display:"none"},attrs:{id:"audio-player"+(t.item._jv&&t.item._jv.id),src:t.currentAudio.url}})],1):t._e(),t._v(" "),t.item.location?n("nuxt-link",{staticClass:"location",attrs:{to:"/topic/position?longitude="+t.item.longitude+"&latitude="+t.item.latitude}},[n("span",{staticClass:"flex"},[n("svg-icon",{staticClass:"icon",attrs:{type:"location"}}),t._v("\n          "+t._s(t.item.location)+"\n        ")],1)]):t._e(),t._v(" "),t.canDetail?t._e():n("div",{staticClass:"bottom-handle"},[n("div",{staticClass:"left"},[n("div",{directives:[{name:"permission",rawName:"v-permission:handleLike",value:"",expression:"''",arg:"handleLike"}],staticClass:"btn like",class:{liked:t.isLiked}},[n("svg-icon",{directives:[{name:"permission",rawName:"v-permission:handleLike",value:"",expression:"''",arg:"handleLike"}],staticClass:"icon",attrs:{type:"like"}}),t._v("\n            "+t._s(t.isLiked?t.$t("topic.liked"):t.$t("topic.like"))+"\n            "+t._s(t.likeCount>0?t.likeCount:"")+"\n          ")],1),t._v(" "),n("div",{directives:[{name:"permission",rawName:"v-permission:toDetail",value:"",expression:"''",arg:"toDetail"}],staticClass:"btn comment"},[n("svg-icon",{staticClass:"icon",attrs:{type:"post-comment"}}),t._v("\n            "+t._s(t.$t("topic.comment"))+"\n            "+t._s(t.item.postCount-1>0?t.item.postCount-1:"")+"\n          ")],1),t._v(" "),t.item._jv&&t.item._jv.id&&t.showShare?n("share-popover",{attrs:{"threads-id":t.item._jv.id}},[n("div",{staticClass:"btn share"},[n("svg-icon",{staticClass:"icon",attrs:{type:"link"}}),t._v("\n              "+t._s(t.$t("topic.share"))+"\n            ")],1)]):t._e()],1),t._v(" "),t._t("bottom-right")],2)]:t._e()],2)],1)}),[],!1,null,"6a77ee3f",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Avatar:n(20).default,VideoPop:n(305).default,ProductItem:n(374).default,AudioPlayer:n(375).default,SharePopover:n(299).default})},function(t,e,n){"use strict";n.r(e);var r={name:"Message",props:{title:{type:String,default:""}}},o=(n(714),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Cover"),t._v(" "),n("div",{staticClass:"checkout-counter"},[n("div",{staticClass:"container-title"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),t._t("default")],2)],1)}),[],!1,null,"307d337d",null);e.default=component.exports;installComponents(component,{Cover:n(137).default,SvgIcon:n(11).default})},,,,function(t,e,n){"use strict";n.r(e);var r=n(423),o={data:function(){return{qrcode:null,site_name:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{forums:{handler:function(t){t&&t.set_site&&(this.site_name=t.set_site.site_name?t.set_site.site_name:"Discuz! Q")},deep:!0}},mounted:function(){this.site_name=this.forums&&this.forums.set_site&&this.forums.set_site.site_name?this.forums.set_site.site_name:"Discuz! Q",this.createQrcode(window.location.href)},destroyed:function(){this.qrcode=null},methods:{createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new r(t.$refs.qrcode,{width:70,height:70,text:link})}))}}},c=(n(737),n(0)),component=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"adv-container"},[e("div",{ref:"qrcode",staticClass:"qrcode"}),this._v(" "),e("div",{staticClass:"adv-info"},[e("div",{staticClass:"adv-title"},[this._v(" 扫一扫，访问移动端")]),this._v("\n    "+this._s(this.site_name)+"\n  ")])])}),[],!1,null,"3629f340",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r={name:"Copyright",data:function(){return{year:"2019",site_record_code:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=window.currentTime||new Date;this.year=t.getFullYear()}},o=(n(738),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"copyright"},[n("div",{staticClass:"info"},[n("span",[t._v("Powered By")]),t._v(" "),n("a",{staticClass:"site",attrs:{href:"https://discuz.com",target:"_blank"}},[t._v("Discuz! Q")]),t._v(" "),n("span",{staticClass:"block"},[t._v("© "+t._s(t.year))])]),t._v(" "),t.forums&&t.forums.set_site&&(t.forums.set_site.site_record||t.forums.set_site.site_record_code)?n("div",{staticClass:"id"},[n("div",{staticClass:"site-record-code"},[n("a",{attrs:{href:"https://beian.miit.gov.cn/",target:"_blank"}},[t._v(t._s(t.forums.set_site?t.forums.set_site.site_record:""))])]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code?n("div",{staticClass:"site-record-code"},[n("a",{attrs:{href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode="+(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code.replace(/[^0-9]/gi,"")),target:"_blank"}},[t._v(t._s(t.forums.set_site.site_record_code))])]):t._e()]):t._e()])}),[],!1,null,"68b79e04",null);e.default=component.exports},,,,,,,,,function(t,e,n){"use strict";n.r(e);n(24);var r={name:"AvatarComponent",props:{author:{type:Object,default:function(){}},size:{type:Number,default:50},round:{type:Boolean,default:!1}},computed:{isAnonymous:function(){return this.author&&this.author.id&&parseInt(this.author.id)<0}}},o=(n(688),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("Avatar",{attrs:{user:t.author,size:t.size,round:t.round}}),t._v(" "),n("div",{staticClass:"title-info"},[n("div",{staticClass:"author-name"},[n("a",{staticClass:"username",attrs:{href:t.isAnonymous?"javascript:void(0)":"/user/"+t.author.id}},[t._v(t._s(t.author.username))]),t._v(" "),t.author.groups&&t.author.groups[0]&&t.author.groups[0].isDisplay?n("span",{staticClass:"group"},[t._v("（"+t._s(t.author.groups[0].name)+"）")]):t._e()]),t._v(" "),n("div",{staticClass:"timer"},[t._t("default")],2)])],1)}),[],!1,null,"a700310a",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r={name:"Regagreement",props:{check:{type:Boolean,default:!0}},data:function(){return{forums:"",popTitle:"",popDetail:"",showagree:!1,checked:!0}},mounted:function(){this.getAttachMent()},methods:{getAttachMent:function(){var t=this;this.$store.dispatch("jv/get",["forum",{params:{include:"users","filter[tag]":"agreement"}}]).then((function(e){t.forums=e}))},open:function(t){this.$router.push("/user/agreement?type=".concat(t))},rcheck:function(){this.$emit("check",this.checked)}}},o=(n(761),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums.agreement&&t.forums.agreement.register||t.forums.agreement&&t.forums.agreement.privacy?n("div",{staticClass:"reg-agreement"},[t.check?n("el-checkbox",{on:{change:t.rcheck},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}):t._e(),t._v(" "),n("span",{staticClass:"agree"},[t._v(t._s(t.$t("permission.user.agreement")))]),t._v(" "),t.forums.agreement&&t.forums.agreement.register?n("span",{staticClass:"regagree",on:{click:function(e){return t.open("register")}}},[t._v(t._s("《"+this.$t("permission.user.agreementRegister")+"》")+"\n  ")]):t._e(),t._v(" "),t.forums.agreement&&t.forums.agreement.privacy?n("span",{staticClass:"regagree",on:{click:function(e){return t.open("privacy")}}},[t._v(t._s("《"+this.$t("permission.user.agreementPrivacy")+"》")+"\n  ")]):t._e()],1):t._e()}),[],!1,null,"33d95e1c",null);e.default=component.exports},,,,,function(t,e,n){"use strict";n.r(e);n(51);var r=n(1),o={name:"Editor",mixins:[n.n(r).a],props:{post:{type:Object,default:function(){}},payment:{type:Object,default:function(){}},question:{type:Object,default:function(){}},product:{type:Object,default:function(){}},typeInformation:{type:Object,default:function(){}},editResourceShow:{type:Object,default:function(){}},isEdit:{type:Boolean,default:!1},onPublish:{type:Boolean,default:!1},editorStyle:{type:String,default:"post"},selector:{type:String,default:"editor"}},data:function(){return{input:{},vditor:{},selectionStart:0,selectionEnd:0,showEmoji:!1,showCaller:!1,showTopic:!1,showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1,onUploadImage:!1,onUploadVideo:!1,onUploadAttached:!1,listenerList:["emoji-list","topic-list"],actions:[{icon:"emoji",toggle:"showEmoji",show:!1},{icon:"call",toggle:"showCaller",show:!1},{icon:"topic",toggle:"showTopic",show:!1}],resources:[{icon:"picture",toggle:"showUploadImg",show:!1},{icon:"video",toggle:"showUploadVideo",show:!1}]}},computed:{userId:function(){return this.$store.state.session.userId},url:function(){return"/api"},header:function(){var t=window.localStorage.getItem("access_token");return{authorization:"Bearer ".concat(t)}},textarea:function(){return document.querySelector(".".concat(this.selector," #textarea"))},forums:function(){return this.$store.state.site.info.attributes||{}},canCreateThreadPaid:function(){return!(!this.forums||!this.forums.other)&&this.forums.other.can_create_thread_paid},canUploadAttachments:function(){return!(!this.forums||!this.forums.other)&&this.forums.other.can_upload_attachments},attachedSizeLimit:function(){return this.forums.set_attach?1024*this.forums.set_attach.support_max_size*1024:10485760},imageTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_img_ext.split(",").map((function(t){return"."+t})).join(","):""},attachedTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_file_ext.split(",").map((function(t){return"."+t})).join(","):""},isPost:function(){return this.typeInformation&&1===this.typeInformation.type||!1}},watch:{editResourceShow:{handler:function(t){if(t)for(var e in t)this[e]=t[e]},deep:!0,immediate:!0},typeInformation:{handler:function(t){t&&(this.actions[0].show=t.showEmoji,this.actions[1].show=t.showCaller,this.actions[2].show=t.showTopic,this.resources[0].show=t.showImage,this.resources[1].show=t.showVideo)},deep:!0,immediate:!0}},mounted:function(){this.textarea&&this.autoHeight(),this.emojiListener()},methods:{onPostContentChange:function(t,e){var n=Object.assign({},this.post);n[t]=e,this.$emit("update:post",n)},onPaymentChange:function(t,e){var n=Object.assign({},this.payment);n[t]=e,this.$emit("update:payment",n)},onQuestionChange:function(t,e){var n=Object.assign({},this.question);n[t]=e,this.$emit("update:question",n)},onProductChange:function(t){var e=Object.assign({},t);this.$emit("update:product",e)},autoHeight:function(){"chat"!==this.editorStyle&&(this.post.text.length>310&&(this.textarea.style.height="180px"),this.textarea.onkeyup=function(){var t=document.scrollingElement.scrollTop;this.style.height="auto",this.style.height=this.scrollHeight+"px",document.scrollingElement.scrollTop=t})},getSelection:function(){this.selectionStart=this.textarea.selectionStart,this.selectionEnd=this.textarea.selectionEnd},emojiListener:function(){var t=this;document.addEventListener("click",(function(e){var n=!0;(e.path||e.composedPath&&e.composedPath()).forEach((function(t){t.classList&&(t.classList.contains("emoji-list")||t.classList.contains("topic-list")||t.classList.contains("editor-bar"))&&(n=!1)})),n&&(t.showTopic=!1,t.showEmoji=!1)}))},onActions:function(t){var e=this;this.hideActions(),setTimeout((function(){e[t]=!e[t]}))},addResource:function(t){this[t]=!0},selectActions:function(code){this.getSelection();var t=this.post.text.slice(0,this.selectionStart)+code+this.post.text.slice(this.selectionStart,this.post.text.length);this.onPostContentChange("text",t),this.hideActions()},hideActions:function(){this.showEmoji=!1,this.showTopic=!1,this.showCaller=!1},publish:function(){return this.onUploadAttached?this.$message.warning(this.$t("post.pleaseWaitForTheAttachedUploadToComplete")):this.onUploadImage?this.$message.warning(this.$t("post.pleaseWaitForTheImageUploadToComplete")):this.onUploadVideo?this.$message.warning(this.$t("post.pleaseWaitForTheVideoUploadToComplete")):(this.$emit("update:onPublish",!0),void this.$emit("publish"))}}},c=(n(686),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[t.userId&&0===t.userId?n("div",{staticClass:"not-logged"},[n("span",[t._v(t._s(t.$t("post.publishAfterLogin")))])]):t._e(),t._v(" "),t.typeInformation&&t.typeInformation.showTitle?n("label",[n("input",{staticClass:"input-title",attrs:{placeholder:t.$t("post.pleaseInputPostTitle"),type:"text"},domProps:{value:t.post&&t.post.title},on:{input:function(e){return t.onPostContentChange("title",e.target.value)}}})]):t._e(),t._v(" "),t.typeInformation&&5===t.typeInformation.type?n("editor-qa",{attrs:{question:t.question},on:{paymentTypeChange:function(e){return t.onQuestionChange("paymentType",e)},isAnonymousChange:function(e){return t.onQuestionChange("isAnonymous",e)},isOnlookerChange:function(e){return t.onQuestionChange("isOnlooker",e)},beUserChange:function(e){return t.onQuestionChange("beUser",e)}}}):t._e(),t._v(" "),t.typeInformation&&6===t.typeInformation.type?n("editor-product",{attrs:{product:t.product},on:{productChange:t.onProductChange}}):t._e(),t._v(" "),t.typeInformation&&t.typeInformation.showPayment&&t.canCreateThreadPaid?n("editor-payment",{attrs:{payment:t.payment||{},type:t.typeInformation&&t.typeInformation.type,"can-upload-attachments":t.canUploadAttachments},on:{paymentChange:function(e){return t.onPaymentChange(e.key,e.value)}}}):t._e(),t._v(" "),t.isPost&&t.canUploadAttachments?n("attachment-upload",{attrs:{"file-list":t.post&&t.post.attachedList,"on-upload":t.onUploadAttached,action:"/attachments",accept:t.attachedTypeLimit,limit:99999,type:0,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadAttached=e},"update:on-upload":function(e){t.onUploadAttached=e},success:function(e){return t.onPostContentChange("attachedList",e)},remove:function(e){return t.onPostContentChange("attachedList",e)}}}):t._e(),t._v(" "),t.isPost?n("Vditor",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit,"text-length":t.post&&t.post.text&&t.post.text.length,placeholder:t.typeInformation&&t.typeInformation.placeholder,"image-accept":t.imageTypeLimit,text:t.post&&t.post.text,"show-caller":t.showCaller,"show-topic":t.showTopic,"show-emoji":t.showEmoji,"is-edit":t.isEdit,"on-publish":t.onPublish,"attachment-size-limit":t.attachedSizeLimit,"on-upload-image":t.onUploadImage},on:{"update:onUploadImage":function(e){t.onUploadImage=e},"update:on-upload-image":function(e){t.onUploadImage=e},textChange:function(e){return t.onPostContentChange("text",e)},close:function(e){t.showCaller=!1},hideActions:t.hideActions,onActions:t.onActions,publish:t.publish}}):t._e(),t._v(" "),t.isPost?t._e():n("div",{class:["container-textarea",t.editorStyle]},["post"===t.editorStyle?n("editor-tool-bar",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit,"text-length":t.post&&t.post.text&&t.post.text.length,actions:t.actions,"show-emoji":t.showEmoji,"show-topic":t.showTopic,"show-caller":t.showCaller,resources:t.resources,"on-publish":t.onPublish,"editor-style":t.editorStyle},on:{publish:t.publish,selectActions:t.selectActions,addResource:t.addResource,hidePop:t.hideActions,onActions:t.onActions}}):t._e(),t._v(" "),n("label",[n("textarea",{class:["input-text",t.editorStyle],attrs:{id:"textarea",placeholder:t.typeInformation?t.typeInformation.placeholder:"",maxlength:t.post&&t.post.textLimit},domProps:{value:t.post&&t.post.text},on:{input:function(e){return t.onPostContentChange("text",e.target.value)}}})]),t._v(" "),n("div",[t.showUploadImg||t.showUploadVideo?n("div",{staticClass:"resources-list"},[t.showUploadImg?n("image-upload",{attrs:{type:t.typeInformation.type&&15===t.typeInformation.type?5:1,"file-list":t.post&&t.post.imageList,"on-upload":t.onUploadImage,action:"/attachments",accept:t.imageTypeLimit,limit:9,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadImage=e},"update:on-upload":function(e){t.onUploadImage=e},success:function(e){return t.onPostContentChange("imageList",e)},remove:function(e){return t.onPostContentChange("imageList",e)}}}):t._e(),t._v(" "),t.showUploadVideo?n("video-upload",{attrs:{"on-upload-video":t.onUploadVideo,"video-list":t.post&&t.post.videoList},on:{"update:onUploadVideo":function(e){t.onUploadVideo=e},"update:on-upload-video":function(e){t.onUploadVideo=e},videoChange:function(e){return t.onPostContentChange(e.key,e.value)}}}):t._e()],1):t._e(),t._v(" "),"post"!==t.editorStyle?n("editor-tool-bar",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit||450,"text-length":t.post&&t.post.text&&t.post.text.length||0,actions:t.actions,"show-emoji":t.showEmoji,"show-topic":t.showTopic,"show-caller":t.showCaller,resources:t.resources,"on-publish":t.onPublish,"editor-style":t.editorStyle},on:{publish:t.publish,selectActions:t.selectActions,addResource:t.addResource,hidePop:t.hideActions,onActions:t.onActions}}):t._e()],1)],1),t._v(" "),t.showCaller&&!t.isPost?n("caller",{on:{close:function(e){t.showCaller=!1},selectedCaller:t.selectActions}}):t._e()],1)}),[],!1,null,"11aa4f42",null);e.default=component.exports;installComponents(component,{EditorQa:n(823).default,EditorProduct:n(824).default,EditorPayment:n(825).default,AttachmentUpload:n(826).default,Vditor:n(827).default,EditorToolBar:n(828).default,ImageUpload:n(829).default,VideoUpload:n(830).default,Caller:n(373).default})},function(t,e,n){"use strict";n.r(e);n(18),n(9);var r=n(1),o={name:"RecommendUser",mixins:[n.n(r).a],props:{list:{type:Array,default:function(){return[]}}},data:function(){return{userList:[],loading:!1,pageNum:1,pageSize:4}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{list:{handler:function(t){this.userList=t},deep:!0}},mounted:function(){0===this.list.length?this.getList():this.userList=this.list},methods:{getList:function(){var t=this;this.userList=[],this.loading=!0;var e={include:"groups",limit:this.pageSize};this.$store.dispatch("jv/get",["users/recommended",{params:e}]).then((function(e){var data=e;e&&Array.isArray(e)&&data.forEach((function(t,i){data[i].groupName=t.groups[0]?t.groups[0].name:""})),t.userList=data}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},refresh:function(){this.getList()}}},c=(n(754),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"recommend-user-container"},[n("div",{staticClass:"recommend-user-title"},[t._v(t._s(t.$t("home.recommentUser")))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"recommend-user-list"},[t._l(t.userList,(function(t,e){return n("user-item",{key:e,attrs:{item:t,show:"simple"}})})),t._v(" "),0===t.userList.length?n("div",{staticClass:"no-more"},[t._v(t._s(t.$t("discuzq.list.noData")))]):t._e()],2),t._v(" "),n("div",{staticClass:"refresh",on:{click:t.refresh}},[n("svg-icon",{staticClass:"icon",attrs:{type:"refresh"}}),t._v("\n    "+t._s(t.$t("home.refresh"))+"\n  ")],1)])}),[],!1,null,"f1a7d5f2",null);e.default=component.exports;installComponents(component,{UserItem:n(372).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={name:"TopicCheckoutCounter",props:{width:{type:String,default:"820px"},title:{type:String,default:""},overflow:{type:String,default:"auto"}}},o=(n(690),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Cover"),t._v(" "),n("div",{staticClass:"message-box",style:{overflow:t.overflow,width:t.width}},[n("div",{staticClass:"container-title"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),t._t("default")],2)],1)}),[],!1,null,"d86fe8e6",null);e.default=component.exports;installComponents(component,{Cover:n(137).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={name:"WalletpassInput",props:{error:{type:Boolean,default:!1}},data:function(){return{password:""}},mounted:function(){document.addEventListener("keyup",this.onInput)},methods:{onInput:function(t){if(["0","1","2","3","4","5","6","7","8","9"].indexOf(t.key)>=0&&(this.password+=t.key),this.password.length>=6)return this.$emit("password",this.password.substr(0,6));"Backspace"===t.key&&(this.password=this.password.substr(0,this.password.length-1))},deleat:function(){this.password=""}}},o=(n(713),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"code"},t._l(6,(function(e,r){return n("span",{key:r,class:{"code-item":!0,filled:t.password[r],error:t.error}},[t._v(t._s(t.password[r]?"*":" "))])})),0)}),[],!1,null,"99ebe848",null);e.default=component.exports},,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=n(23),c={name:"Header",mixins:[n.n(o).a],props:{headImg:{type:String,default:""}},data:function(){return{inputVal:"",code:"",canReg:!1,siteClose:!1,userInfoTimer:null,offsetTop:0,imgurl:n(290),islogin:!0}},computed:{userId:function(){return this.$store.state.user.info.id},forums:function(){return this.$store.state.site.info.attributes||{}},userInfo:function(){return this.$store.state.user.info.attributes||{}}},watch:{$route:function(t){"/site/close"===t.path?this.siteClose=!0:this.siteClose=!1}},mounted:function(){var t=this,code=this.$route.query.code;"undefined"!==code&&(this.code=code),this.$route.query.q&&(this.inputVal=this.$route.query.q),"/site/close"!==this.$route.path&&window.setTimeout(this.reloadUserInfo(),5e3),"/site/close"===this.$route.path&&(this.siteClose=!0),this.$nextTick((function(){var e=localStorage.getItem("user_id");t.islogin=e}))},destroyed:function(){window.clearInterval(this.userInfoTimer)},methods:{logout:function(){var t=this;this.$store.dispatch("session/logout").then((function(){location.href="".concat(t.$route.fullPath)}))},reloadUserInfo:function(){this.userInfo&&this.userInfo.id&&(window.clearInterval(this.userInfoTimer),this.userInfoTimer=window.setInterval(this.getUserInfo,6e4))},getUserInfo:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("user/getUserInfo",t.userId);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))()},register:function(){this.toregister(this.code)},login:function(){this.headerTologin()},onClickSearch:function(){this.inputVal&&this.$router.push("/site/search?q=".concat(this.inputVal))},toIndex:function(){"/"===this.$route.path?window.location.href="/":this.$router.push("/")}}},l=(n(480),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"head",staticClass:"header isFixed"},[r("div",{staticClass:"header-container"},[r("div",{staticClass:"flex"},[r("div",{staticClass:"logo",on:{click:t.toIndex}},[r("img",{directives:[{name:"show",rawName:"v-show",value:t.forums&&t.forums.set_site,expression:"forums && forums.set_site"}],attrs:{src:t.forums&&t.forums.set_site&&t.forums.set_site.site_logo?t.forums.set_site.site_logo:n(290),alt:"头部logo"}})]),t._v(" "),r("el-input",{staticClass:"h-search",attrs:{autocomplete:"off",size:"medium",placeholder:t.$t("search.search"),disabled:t.siteClose},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[r("svg-icon",{staticClass:"el-input__icon",attrs:{slot:"suffix",type:"search"},on:{click:t.onClickSearch},slot:"suffix"})],1)],1),t._v(" "),t.siteClose||!t.islogin?r("div",[t.siteClose||!t.userId?r("el-button",{staticClass:"h-button h-button1",attrs:{size:"small"},on:{click:t.login}},[t._v("\n        "+t._s(t.$t("user.login"))+"\n      ")]):t._e(),t._v(" "),t.siteClose||!t.userId?r("el-button",{staticClass:"h-button h-button2",attrs:{disabled:t.forums&&t.forums.set_reg&&!t.forums.set_reg.register_close||t.siteClose,size:"small"},on:{click:t.register}},[t._v("\n        "+t._s(t.$t("user.register"))+"\n      ")]):t._e()],1):t._e(),t._v(" "),t.userId&&"{}"!==JSON.stringify(t.userInfo)&&!t.siteClose?r("div",{staticClass:"flex"},[r("avatar",{attrs:{user:{id:t.userInfo.id,username:t.userInfo.username,avatarUrl:t.userInfo.avatarUrl,isReal:t.userInfo.isReal},size:35,round:!0}}),t._v(" "),t.userInfo.username&&t.userInfo.id?r("nuxt-link",{staticClass:"menu-item user-name text-hidden",attrs:{to:"/user/"+t.userInfo.id}},[t._v("\n        "+t._s(t.userInfo.username)+"\n      ")]):t._e(),t._v(" "),r("nuxt-link",{staticClass:"menu-item notice-btn",attrs:{to:"/my/notice"}},[r("span",{staticClass:"flex"},[t._v("\n          "+t._s(t.$t("home.tabsNews"))+"\n          "),t.userInfo.unreadNotifications&&t.userInfo.unreadNotifications>0?r("span",{staticClass:"unread-notice"},[t._v(t._s(t.userInfo.unreadNotifications>99?"99+":t.userInfo.unreadNotifications))]):t._e()])]),t._v(" "),r("nuxt-link",{staticClass:"menu-item",attrs:{to:"/my/profile"}},[t._v(t._s(t.$t("profile.personalhomepage")))]),t._v(" "),r("div",{staticClass:"menu-item",on:{click:t.logout}},[t._v(t._s(t.$t("user.logout")))])],1):t._e()])])}),[],!1,null,"afb5e5da",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Avatar:n(20).default})},,function(t,e,n){"use strict";var r={name:"NuxtError",props:{error:{type:Object,default:null}},computed:{statusCode:function(){return this.error&&this.error.statusCode||500},message:function(){return this.error.message||"Error"}},head:function(){return{title:this.message,meta:[{name:"viewport",content:"width=device-width,initial-scale=1.0,minimum-scale=1.0"}]}}},o=(n(473),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"__nuxt-error-page"},[n("div",{staticClass:"error"},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"90",height:"90",fill:"#DBE1EC",viewBox:"0 0 48 48"}},[n("path",{attrs:{d:"M22 30h4v4h-4zm0-16h4v12h-4zm1.99-10C12.94 4 4 12.95 4 24s8.94 20 19.99 20S44 35.05 44 24 35.04 4 23.99 4zM24 40c-8.84 0-16-7.16-16-16S15.16 8 24 8s16 7.16 16 16-7.16 16-16 16z"}})]),t._v(" "),n("div",{staticClass:"title"},[t._v(t._s(t.message))]),t._v(" "),404===t.statusCode?n("p",{staticClass:"description"},[n("NuxtLink",{staticClass:"error-link",attrs:{to:"/"}},[t._v("Back to the home page")])],1):t._e(),t._v(" "),t._m(0)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logo"},[e("a",{attrs:{href:"https://nuxtjs.org",target:"_blank",rel:"noopener"}},[this._v("Nuxt.js")])])}],!1,null,null,null);e.a=component.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(7),o=n(1),c={name:"Category",mixins:[n.n(o).a],props:{postLoading:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}}},data:function(){return{selectId:0,categoryList:[]}},watch:{list:{handler:function(t){var e=0;t.forEach((function(t){e+=t.thread_count})),this.categoryList=[{_jv:{id:0},name:this.$t("topic.whole"),threadCount:e}].concat(Object(r.a)(t))},deep:!0}},mounted:function(){if(0===this.list.length)this.getCategoryList();else{var t=0;this.list.forEach((function(e){t+=e.thread_count})),this.categoryList=[{_jv:{id:0},name:this.$t("topic.whole"),threadCount:t}].concat(Object(r.a)(this.list))}this.$route.params.id&&(this.selectId=this.$route.params.id)},methods:{getCategoryList:function(){var t=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(e){var n=Object(r.a)(e)||[],o=0;n.forEach((function(t){o+=t.thread_count})),t.categoryList=[{_jv:{id:0},name:t.$t("topic.whole"),threadCount:o}].concat(Object(r.a)(n))}),(function(e){t.handleError(e)}))},onChange:function(t){this.postLoading||(this.selectId=t,this.$emit("onChange",t))}}},l=(n(736),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.categoryList.length>0?n("div",{staticClass:"category-container"},t._l(t.categoryList,(function(e,r){return n("div",{key:r,staticClass:"category-item",class:{active:t.selectId===(e._jv&&e._jv.id),loading:t.postLoading},on:{click:function(n){return t.onChange(e._jv&&e._jv.id)}}},[t.selectId===(e._jv&&e._jv.id)?n("i",{staticClass:"el-icon-arrow-left arrow-icon"}):t._e(),t._v(" "),n("div",{staticClass:"flex"},[n("div",{staticClass:"title"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"count"},[t._v(t._s(e.thread_count))])])])})),0):t._e()}),[],!1,null,"b206628e",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r={name:"Cover",mounted:function(){var t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0, 0, 0, .4)",t.style.zIndex="10",t.id="cover",document.querySelector("body").appendChild(t)},destroyed:function(){var t=document.querySelector("#cover");t.parentNode.removeChild(t)},render:function(){return""}},o=n(0),component=Object(o.a)(r,void 0,void 0,!1,null,null,null);e.default=component.exports},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);n(24);var r=n(423),o={props:{threadsId:{type:[String,Number],default:""},type:{type:String,default:""}},data:function(){return{qrcode:null,currentType:""}},methods:{copyLink:function(){var t=document.createElement("input");"topic"===this.type?t.value=window.location.href:t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success("链接复制成功"),setTimeout((function(){t.remove()}),100)},onShowPopover:function(){this.currentType=this.type;var path=window.location.href;path="topic"===this.type?window.location.href:"".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),this.createQrcode(path)},createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new r(t.$refs.qrcode,{width:88,height:88,text:link})}))},closeCode:function(){this.$refs.qrcode.innerHTML=""}}},c=(n(679),n(680),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"share-container"},[n("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"click","popper-class":"custom-popover-width"},on:{show:t.onShowPopover,hide:t.closeCode}},[n("div",{staticClass:"share-cont"},[n("div",{staticClass:"copy",on:{click:t.copyLink}},[n("svg-icon",{staticClass:"copy-icon",attrs:{type:"copy-link"}}),t._v(" "),n("span",[t._v(t._s(t.$t("core.copyLink")))])],1),t._v(" "),n("div",{staticClass:"qrcode"},[n("div",{staticClass:"qrcode-text"},[n("svg-icon",{staticClass:"wechat-logo",attrs:{type:"wechat-logo"}}),t._v(" "),n("span",[t._v(t._s(t.$t("core.wxShare")))])],1),t._v(" "),n("div",{ref:"qrcode",staticClass:"qrcode-cont"})])]),t._v(" "),n("template",{slot:"reference"},[t._t("default")],2)],2)],1)}),[],!1,null,"4165063c",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(18),n(273)),c=n.n(o),l=n(1),d={name:"ChatBox",mixins:[n.n(l).a],props:{dialog:{type:Object,default:function(){}}},data:function(){return{recordList:[],recordTotal:0,pageLimit:10,pollId:"",loading:!1,onChatPublish:!1,chatContent:{text:"",imageList:[],attachedList:[]},chatType:{type:10,textLimit:450,showPayment:!1,showTitle:!1,showImage:!1,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!1,placeholder:"请输入 ..."},loadMoreMessage:!1}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")},noMore:function(){return this.recordList.length===this.recordTotal}},watch:{dialog:{handler:function(t){var e=this;this.loading=!0,t.id&&t.name?this.getChatRecord(t.id).then((function(){e.loading=!1,e.$nextTick((function(){e.$refs.chatContent.scrollTop=e.$refs.chatContent.scrollHeight}))})):this.loading=!1},deep:!0,immediate:!0}},mounted:function(){this.activePolling(),this.scrollListener()},beforeDestroy:function(){window.clearInterval(this.pollId)},methods:{scrollListener:function(){var t=this;this.$refs.chatContent.addEventListener("scroll",(function(e){if(0===e.target.scrollTop){if(t.loadMoreMessage)return;t.loadMoreMessage=!0,t.pageLimit+=10,t.getChatRecord(t.dialog.id)}}))},activePolling:function(){var t=this;this.pollId=window.setInterval((function(){t.dialog.id&&t.getChatRecord(t.dialog.id)}),1500)},getChatRecord:function(t){var e=this,n={"filter[dialog_id]":t,include:"user,user.groups","page[number]":1,"page[limit]":this.pageLimit,sort:"-createdAt"};return this.$store.dispatch("jv/get",["dialog/message",{params:n}]).then((function(t){var n=t._jv.json.meta.total;e.recordList=Object(r.a)(t).reverse(),e.onChatPublish=!1,e.recordTotal===n||e.loadMoreMessage||e.$nextTick((function(){e.$refs.chatContent.scrollTop=e.$refs.chatContent.scrollHeight})),e.loadMoreMessage=!1,e.recordTotal=n}),(function(t){return e.handleError(t)}))},formatDate:function(t){return c()(new Date(t)).format("YYYY-MM-DD HH:mm")},postMessage:function(){var t=this,e={_jv:{type:"dialog/message"},dialog_id:this.dialog.id,message_text:this.chatContent.text};this.$store.dispatch("jv/post",e).then((function(){t.getChatRecord(t.dialog.id),t.chatContent.text=""}),(function(e){t.onChatPublish=!1,t.handleError(e)}))},createDialogAndPost:function(){var t=this,e={_jv:{type:"dialog"},recipient_username:this.dialog.name,message_text:this.chatContent.text};this.$store.dispatch("jv/post",e).then((function(e){t.getChatRecord(e._jv.id),t.chatContent.text=""}),(function(e){t.onChatPublish=!1,t.handleError(e)}))},chatPublish:function(){return this.chatContent.text?this.chatContent.text.length>450?this.$message.warning(this.$t("chat.messageLengthCannotOver")):void(this.onChatPublish||(this.onChatPublish=!0,this.dialog.id?this.postMessage():this.createDialogAndPost())):this.$message.warning(this.$t("chat.messageCannotBeBlack"))}}},h=(n(685),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-box"},[n("div",{staticClass:"header"},[n("span",{staticClass:"name"},[t._v(t._s(t.dialog.name))]),t._v(" "),n("span",[t._v(t._s(t.$t("chat.chatWithYou")))]),t._v(" "),n("svg-icon",{staticClass:"icon-close",staticStyle:{"font-size":"16px",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"chatContent",staticClass:"chat-content",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[t.loadMoreMessage?n("div",{staticClass:"load-tip"},[t._v(t._s(t.noMore?t.$t("chat.noMore"):t.$t("chat.loadRecord")))]):t._e(),t._v(" "),t._l(t.recordList,(function(e,r){return n("div",{key:r,staticClass:"record"},[e.user_id===parseInt(t.userId)?n("div",{staticClass:"record-item mine"},[n("div",{staticClass:"message"},[n("div",{staticClass:"message-box",domProps:{innerHTML:t._s(t.$xss(e.message_text_html))}}),t._v(" "),n("div",{staticClass:"created-at"},[t._v(t._s(t.formatDate(e.updated_at)))])]),t._v(" "),n("Avatar",{attrs:{user:e.user,size:50}})],1):n("div",{staticClass:"record-item his"},[n("Avatar",{attrs:{user:e.user,size:50}}),t._v(" "),n("div",{staticClass:"message"},[n("div",{staticClass:"message-box"},[n("div",{staticClass:"message-box",domProps:{innerHTML:t._s(t.$xss(e.message_text_html))}})]),t._v(" "),n("div",{staticClass:"created-at"},[t._v(t._s(t.formatDate(e.updated_at)))])])],1)])}))],2),t._v(" "),n("editor",{staticClass:"chat-editor",attrs:{"editor-style":"chat",selector:"chat-editor","type-information":t.chatType,post:t.chatContent,"on-publish":t.onChatPublish},on:{"update:post":function(e){t.chatContent=e},publish:t.chatPublish}}),t._v(" "),n("Cover")],1)}),[],!1,null,"51058ffb",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Avatar:n(20).default,Editor:n(88).default,Cover:n(137).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(28),n(13)),c=n(1),l=n.n(c),d=n(55),h={name:"Phonecode",mixins:[n.n(d).a,l.a],props:{mobile:{type:String,default:""},phonenum:{type:String,default:""}},data:function(){return{phoneNumber:"",isVerifyDisabled:!0,canCountDown:!1,countDownSecond:60,loading:!1,verifyCode:"",newPassword:"",newPasswordRepeat:"",username:"",realphoneNumber:"",userId:this.$store.getters["session/get"]("userId")}},mounted:function(){this.phoneNumber=this.mobile,this.realphoneNumber=this.phonenum},methods:{onInput:function(t){this.phoneNumber=t.target.value.replace(/[^\d]/g,""),this.isVerifyDisabled=11!==this.phoneNumber.length},countDown:function(t){var e=this;this.canCountDown=!0,this.countDownSecond=t;var n=setInterval((function(){e.countDownSecond-=1,0===e.countDownSecond&&(e.canCountDown=!1,clearInterval(n))}),1e3)},sendVerifyCode:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={_jv:{type:"sms/send"},mobile:t.realphoneNumber,type:"reset_pay_pwd"},e.next=3,t.checkCaptcha(n);case 3:n=e.sent,o.b.run((function(){return t.$store.dispatch("jv/post",n)})).then((function(e){e.interval&&t.countDown(e.interval)}),(function(e){var n=e.response.data.errors;if(n[0])return t.$message.error(n[0].detail[0])}));case 5:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;if(""===this.verifyCode)this.$message.error("验证码不能为空");else if(""===this.newPassword)this.$message.error("新密码不能为空");else if(""===this.newPasswordRepeat)this.$message.error("重复密码不能为空");else if(this.newPassword!==this.newPasswordRepeat)this.$message.error("二次密码输入不一致");else{var e={_jv:{type:"sms/verify"},mobile:this.realphoneNumber,code:this.verifyCode,pay_password:this.newPassword,pay_password_confirmation:this.newPasswordRepeat,type:"reset_pay_pwd"};o.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(){t.$message.success(t.$t("modify.paymentsucceed")),t.$emit("close")}),(function(e){return t.handleError(e)}))}}}},m=(n(723),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("modify.forgetPassword")+"/"+t.$t("modify.retrievePassword")+" "},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"retrieve-inputs"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],attrs:{maxlength:"11",type:"text",placeholder:t.$t("modify.placeEnterRegisteredPhone")},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=e.target.value)}}}),t._v(" "),t.canCountDown?n("button",{class:{disabled:t.canCountDown},attrs:{disabled:t.canCountDown}},[t._v(t._s(t.countDownSecond+t.$t("modify.retransmission")))]):n("button",{staticClass:"sendbtn",on:{click:t.sendVerifyCode}},[t._v("\n          "+t._s(t.$t("modify.sendVerifyCode"))+"\n        ")])]),t._v(" "),n("el-input",{attrs:{maxlength:"6",placeholder:t.$t("modify.placeEnterCode")},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),t._v(" "),n("el-input",{attrs:{placeholder:"请输入新支付密码","show-password":""},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),t._v(" "),n("el-input",{attrs:{placeholder:"请重新输入新支付密码","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.newPasswordRepeat,callback:function(e){t.newPasswordRepeat=e},expression:"newPasswordRepeat"}})],1),t._v(" "),n("button",{staticClass:"submit",on:{click:t.submit}},[t._v(t._s(t.$t("modify.newPayPwdTitle")))])])])}),[],!1,null,"d2d6c350",null);e.default=component.exports;installComponents(component,{Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r={name:"WalletPassword",data:function(){return{}},methods:{tobind:function(){this.$router.push("/my/profile?phonebind=true")}}},o=(n(724),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("modify.forgetPassword")+"/"+t.$t("modify.retrievePassword")+" "},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("modify.nohasphon")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.forgetPassword")+"/"+t.$t("modify.retrievePassword")+",需要您先绑定常用手机号码"))])]),t._v(" "),n("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.tobind}},[t._v("前去绑定")])],1)])])}),[],!1,null,"0d299855",null);e.default=component.exports;installComponents(component,{Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r={name:"TopicPassword",props:{qrCode:{type:String,default:""}}},o=(n(732),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("pay.pay")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[n("svg-icon",{staticStyle:{fill:"#09BB07","font-size":"30px"},attrs:{type:"wechat"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wxPay")))])],1),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("pay.wechatTimeLimit")))]),t._v(" "),n("div",{staticClass:"container-qr-code"},[n("img",{staticStyle:{width:"138px",height:"138px"},attrs:{src:t.qrCode,alt:"qr-code"}})]),t._v(" "),n("div",{staticClass:"scan-tip"},[n("svg-icon",{staticStyle:{display:"block","font-size":"32px"},attrs:{type:"wx-scan"}}),t._v(" "),n("div",{staticClass:"tip"},[n("span",[t._v(t._s(t.$t("pay.wechatScan")))]),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wechatScanPay")))])])],1)])])}),[],!1,null,"13cb0b20",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,MessageBox:n(90).default})},function(t,e,n){"use strict";n.r(e);var r={data:function(){return{userId:this.$store.getters["session/get"]("userId"),visible:!1,noCreateThread:!1,can_create_thread:!0,can_create_thread_long:!0,can_create_thread_video:!0,can_create_thread_image:!0,can_create_thread_question:!0,can_create_thread_goods:!0}},computed:{userInfo:function(){return this.$store.getters["jv/get"]("/users/".concat(this.userId))},forums:function(){return this.$store.state.site.info.attributes||{}},categoryId:function(){return this.$route.query.categoryId}},methods:{showAndHidePopover:function(){if(!this.visible){var t=this.forums.other,e=this.userInfo;if(!t)return;if(!(t.can_create_thread||t.can_create_thread_long||t.can_create_thread_video||t.can_create_thread_image||t.can_create_thread_question||t.can_create_thread_goods))return void this.$message.error(this.$t("home.noPostingPermission"));if(t.publish_need_real_name&&!e.realname)return void this.$message.error(this.$t("home.needRealname"));if(t.publish_need_bind_phone&&!e.mobile)return void this.$message.error(this.$t("home.needPhone"));if(!t.can_create_thread_in_category)return void this.$message.error(this.$t("home.noPostingCategory"));if(this.categoryId)this.$store.getters["jv/get"]("categories/".concat(this.categoryId)).canCreateThread||this.$message.error(this.$t("home.noPostingCategory"));t.can_create_thread||(this.can_create_thread=!1),t.can_create_thread_long||(this.can_create_thread_long=!1),t.can_create_thread_video||(this.can_create_thread_video=!1),t.can_create_thread_image||(this.can_create_thread_image=!1),t.can_create_thread_question||(this.can_create_thread_question=!1),t.can_create_thread_goods||(this.can_create_thread_goods=!1)}this.visible=!this.visible},toRouter:function(t){this.$router.push("/thread/post?type=".concat(t).concat(this.categoryId?"&categoryId=".concat(this.categoryId):""))}}},o=(n(735),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"manual","popper-class":"custom-popover-width"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("ul",{staticClass:"type-container"},[t.can_create_thread?n("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(0)}}},[t._v(t._s(t.$t("home.word")))]):t._e(),t._v(" "),t.can_create_thread_long?n("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(1)}}},[t._v(t._s(t.$t("home.invitation")))]):t._e(),t._v(" "),t.can_create_thread_image?n("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(3)}}},[t._v(t._s(t.$t("home.picture")))]):t._e(),t._v(" "),t.can_create_thread_video?n("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(2)}}},[t._v(t._s(t.$t("home.video")))]):t._e(),t._v(" "),t.can_create_thread_question?n("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(5)}}},[t._v(t._s(t.$t("home.question")))]):t._e(),t._v(" "),t.can_create_thread_goods?n("li",{on:{click:function(e){return e.stopPropagation(),t.toRouter(6)}}},[t._v(t._s(t.$t("home.product")))]):t._e()]),t._v(" "),n("template",{slot:"reference"},[t._t("button",[n("el-button",{directives:[{name:"permission",rawName:"v-permission:showAndHidePopover",value:"",expression:"''",arg:"showAndHidePopover"}],staticClass:"new-post",attrs:{type:"primary"}},[n("span",{staticClass:"add-icon"},[t._v("+")]),t._v(t._s(t.$t("profile.post"))+"\n      ")])])],2)],2)}),[],!1,null,"28d1142c",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r=n(417),o={name:"VideoPop",props:{url:{type:String,default:""},coverUrl:{type:String,default:""}},data:function(){return{options:{autoplay:!0,controls:!0},player:null}},mounted:function(){document.addEventListener("click",this.removeVideoPop),this.initVideoJs()},methods:{initVideoJs:function(){var t=this;this.player=Object(r.a)("videoPlayer",this.options,(function(){var e=this;r.a.log("Your player is ready!"),this.play(),this.on("error",(function(){e.errorDisplay.close(),e.createModal(t.$t("core.videoError"))}))}))},removeVideoPop:function(t){var e=!0;(t.path||t.composedPath&&t.composedPath()).forEach((function(t){"video-pop"===t.id&&(e=!1),t.classList&&t.classList.contains("svg-icon-video-play")&&(e=!1)})),e&&(this.$emit("remove"),this.player.dispose(),document.removeEventListener("click",this.removeVideoPop))}}},c=(n(676),n(0)),component=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-pop",attrs:{id:"video-pop"}},[e("Cover"),this._v(" "),e("video",{staticClass:"video-js",attrs:{id:"videoPlayer",controls:"",width:"800px",height:"600px",preload:"auto","data-setup":"{}"}},[e("source",{attrs:{src:this.url}}),this._v(" "),e("source",{attrs:{src:this.url,type:"video/webm"}})])],1)}),[],!1,null,"5d02c715",null);e.default=component.exports;installComponents(component,{Cover:n(137).default})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){},,,,,,,function(t,e,n){},,,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(24),n(49)),c=n(45),l=n.n(c),d=(n(345),n(312)),h=n.n(d),m={props:{images:{type:Array},rebuild:{type:Boolean,default:!1},trigger:{},options:{type:Object}},data:function(){return{}},computed:{},methods:{onChange:function(){this.rebuild?this.rebuildViewer():this.updateViewer()},rebuildViewer:function(){this.destroyViewer(),this.createViewer()},updateViewer:function(){this.$viewer?(this.$viewer.update(),this.$emit("inited",this.$viewer)):this.createViewer()},destroyViewer:function(){this.$viewer&&this.$viewer.destroy()},createViewer:function(){this.$viewer=new h.a(this.$el,this.options),this.$emit("inited",this.$viewer)}},watch:{images:function(){var t=this;this.$nextTick((function(){t.onChange()}))},trigger:{handler:function(){var t=this;this.$nextTick((function(){t.onChange()}))},deep:!0},options:{handler:function(){var t=this;this.$nextTick((function(){t.rebuildViewer()}))},deep:!0}},mounted:function(){this.createViewer()},destroyed:function(){this.destroyViewer()}},f=n(0),v={name:"TopicContent",components:{Viewer:Object(f.a)(m,(function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default",null,{images:this.images,options:this.options})],2)}),[],!1,null,null,null).exports},mixins:[l.a],props:{article:{type:Object,default:function(){}},title:{type:String,default:function(){return""}},video:{type:Object,default:function(){}},audio:{type:Object,default:function(){}},paidInformation:{type:Object,default:function(){}},threadType:{type:Number,default:0},category:{type:Object,default:function(){}},location:{type:Object,default:function(){}}},data:function(){return{showVideoPop:!1,options:{filter:function(image){return Object(r.a)(image.classList).indexOf("qq-emotion")<0}},currentAudio:{id:"",url:"",currentTime:"",duration:"",audio:"",seeking:!1,isPlay:!1,isLoading:!1}}},computed:{unpaid:function(){return this.paidInformation.paid&&this.removeTextHideCover(),!(this.paidInformation.paid||0===parseFloat(this.paidInformation.price))}},watch:{article:{handler:function(){this.addTextHideCover()},deep:!0}},mounted:function(){this.currentAudio.audio=document.getElementById("audio-player")},methods:{formatTopicHTML:function(html){return o.a.parse(html)},addTextHideCover:function(){if(1===this.threadType&&this.unpaid){var t=document.querySelector(".content-html");parseInt(t.offsetHeight)>100&&t.classList.add("hide-cover")}},removeTextHideCover:function(){var t=document.querySelector(".content-html");t&&t.classList.remove("hide-cover")},openVideo:function(){if(this.isLogin())return this.unpaid?this.$emit("payForThread"):void(this.showVideoPop=!0)},play:function(t){var e=this;if(this.isLogin()){if(this.unpaid)return this.$emit("payForThread");this.currentAudio.id!==t._jv.id&&(this.resetAudio(this.currentAudio.audio),this.currentAudio.url=t.media_url,this.currentAudio.id=t._jv.id,this.currentAudio.audio.src=this.currentAudio.url,this.currentAudio.isLoading=!0,this.currentAudio.audio.load()),window.setTimeout((function(){e.currentAudio.audio.play(),e.currentAudio.isPlay=!0,e.currentAudio.audio.addEventListener("timeupdate",e.onProgressing),e.currentAudio.audio.addEventListener("ended",e.onEnded)}),0)}},onProgressing:function(){this.currentAudio.seeking||(this.currentAudio.isLoading=!1,this.currentAudio.duration=this.currentAudio.audio.duration,this.currentAudio.currentTime=this.currentAudio.audio.currentTime)},onEnded:function(){this.resetAudio(this.currentAudio.audio)},resetAudio:function(audio){audio.removeEventListener("timeupdate",this.onProgressing),audio.removeEventListener("ended",this.onEnded),this.currentAudio.isPlay=!1,this.currentAudio.duration="",this.currentAudio.currentTime=""},pause:function(){this.currentAudio.isLoading=!1,this.currentAudio.isPlay=!1,this.currentAudio.audio.pause()},seek:function(time){this.currentAudio.seeking=!1,this.currentAudio.currentTime=time,this.currentAudio.audio.currentTime=time},seeking:function(time){this.currentAudio.seeking=!0,this.currentAudio.currentTime=time}}},_=(n(742),Object(f.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"global"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("viewer",{attrs:{trigger:t.$xss(t.formatTopicHTML(t.article.contentHtml||"")),options:t.options}},[n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(t.formatTopicHTML(t.article.contentHtml||"")))}})]),t._v(" "),t.video.cover_url?n("div",{staticClass:"container-video-img-cover"},[n("div",{staticClass:"warp-video-img-cover"},[n("img",{staticClass:"video-img-cover",attrs:{src:t.video.cover_url,alt:t.video.file_name},on:{click:function(e){return e.stopPropagation(),t.openVideo(e)}}}),t._v(" "),n("svg-icon",{staticClass:"icon-play",staticStyle:{"font-size":"50px"},attrs:{type:"video-play"},on:{click:t.openVideo}})],1)]):t._e(),t._v(" "),t.article.images&&t.article.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images",on:{click:function(e){t.unpaid&&t.openVideo()}}},t._l(t.article.images,(function(image,e){return n("el-image",{key:e,staticClass:"image",attrs:{"data-source":t.unpaid?"":image.url,src:image.thumbUrl,alt:image.filename,fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e(),t._v(" "),(t.article.attachments||[]).length>0?n("div",{staticClass:"container-attachment"},[n("h3",{staticClass:"name"},[t._v(t._s(t.$t("topic.attachment")))]),t._v(" "),n("div",[t._l(t.article.attachments,(function(e,r){return[n("attachment-list",{key:r,attrs:{file:e,price:t.paidInformation.price,"is-paid":t.paidInformation.paid,"is-paid-attachment":t.paidInformation.isPaidAttachment,"attachment-price":t.paidInformation.attachmentPrice}})]}))],2)]):t._e(),t._v(" "),t.unpaid&&1===t.threadType?n("div",{staticClass:"hide-content-tip"},[t._v(t._s(t.$t("pay.contentHide")))]):t._e(),t._v(" "),t.category.name?n("nuxt-link",{staticClass:"tag",attrs:{to:{path:"/",query:{categoryId:t.category._jv.id}}}},[t._v(t._s(t.category.name))]):t._e(),t._v(" "),t.location&&t.location.location?n("div",[n("nuxt-link",{staticClass:"location",attrs:{to:"/topic/position?longitude="+t.location.longitude+"&latitude="+t.location.latitude}},[n("span",{staticClass:"flex"},[n("svg-icon",{staticClass:"icon",attrs:{type:"location"}}),t._v(" "),n("span",[t._v(" "+t._s(t.location.location)+" ")])],1)])],1):t._e(),t._v(" "),6===t.threadType?n("div",{staticClass:"product"},[n("product-item",{attrs:{item:t.article&&t.article.postGoods}})],1):t._e(),t._v(" "),4===t.threadType?n("div",{staticClass:"audio"},[t._l([].concat(t.audio),(function(e,r){return[n("audio-player",{key:r,attrs:{file:e,"current-audio":t.currentAudio},on:{play:t.play,pause:t.pause,seek:t.seek,seeking:t.seeking}})]}))],2):t._e(),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{"cover-url":t.video.cover_url,url:t.video.media_url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e(),t._v(" "),n("audio",{staticStyle:{display:"none"},attrs:{id:"audio-player",src:t.currentAudio.url}})],1)}),[],!1,null,"3daa0b7b",null));e.default=_.exports;installComponents(_,{SvgIcon:n(11).default,AttachmentList:n(832).default,ProductItem:n(374).default,AudioPlayer:n(375).default,VideoPop:n(305).default})},function(t,e,n){"use strict";n.r(e);var r={name:"Footer",data:function(){return{year:"2019"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=window.currentTime||new Date;this.year=t.getFullYear()}},o=(n(485),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"footer"},[n("span",[t._v(" Powered By    "),n("a",{staticClass:"bold",attrs:{href:"https://discuz.com",target:"_blank"}},[t._v("Discuz! Q")]),t._v("  © "+t._s(t.year)+"   ")]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_record?n("a",{staticClass:"site-record",attrs:{href:"https://beian.miit.gov.cn/",target:"_blank"}},[t._v(t._s(t.forums.set_site.site_record))]):t._e(),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code?n("a",{attrs:{href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode="+(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code.replace(/[^0-9]/gi,"")),target:"_blank"}},[t._v(t._s(t.forums.set_site.site_record_code))]):t._e()])}),[],!1,null,"614a39ec",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);n(24);var r={props:{loading:{type:Boolean,default:!1},fontSize:{type:Number,default:32}}},o=(n(681),n(0)),component=Object(o.a)(r,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"loading-container"},[this._v("\n  "+this._s(this.$t("discuzq.list.loading"))+"...\n")])}),[],!1,null,"d9c61874",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r={data:function(){return{filterQuery:[{label:this.$t("home.all"),value:"",isShow:!0},{label:this.$t("home.essence"),value:"isEssence",isShow:!0},{label:this.$t("home.followed"),value:"followed",isShow:!1}],filterType:[{label:this.$t("home.noLimit"),value:""},{label:this.$t("home.text"),value:0},{label:this.$t("home.invitation"),value:1},{label:this.$t("home.video"),value:2},{label:this.$t("home.picture"),value:3},{label:this.$t("home.voice"),value:4},{label:this.$t("home.question"),value:5},{label:this.$t("home.product"),value:6}],filterSort:[{label:this.$t("home.noLimit"),value:""},{label:this.$t("home.sortCreatedAt"),value:"-createdAt"},{label:this.$t("home.sortUpdatedAt"),value:"-updatedAt"}],query:{filter:"",filterType:"",filterSort:""}}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},watch:{userId:function(t){this.filterQuery[2].isShow=t>0}},mounted:function(){this.userId>0?this.filterQuery[2].isShow=!0:this.filterQuery[2].isShow=!1},methods:{onClickFilter:function(t){"followed"!==t||this.userId&&0!=+this.userId?(this.query.filter=t,this.$emit("onChangeFilter",t)):this.$message.error(this.$t("core.not_authenticated"))},handleCommandType:function(t){this.query.filterType=t,this.$emit("onChangeType",t)},handleCommandSort:function(t){this.query.filterSort=t,this.$emit("onChangeSort",t)}}},o=(n(770),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index-top-conttainer"},[n("div",{staticClass:"index-filter"},[t._l(t.filterQuery,(function(e,r){return[e.isShow?n("div",{key:r,staticClass:"filter-btn",class:{active:t.query.filter===e.value},on:{click:function(n){return t.onClickFilter(e.value)}}},[t._v("\n        "+t._s(e.label)+"\n      ")]):t._e()]})),t._v(" "),n("el-dropdown",{staticClass:"filter-dropdown",attrs:{placement:"bottom"},on:{command:t.handleCommandType}},[n("span",{staticClass:"el-dropdown-link",class:{active:""!==t.query.filterType}},[t._v("\n        "+t._s(t.$t("home.filterType"))),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.filterType,(function(e,r){return n("el-dropdown-item",{key:r,class:{active:e.value===t.query.filterType},attrs:{command:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1)],1),t._v(" "),n("el-dropdown",{staticClass:"filter-dropdown",attrs:{placement:"bottom"},on:{command:t.handleCommandSort}},[n("span",{staticClass:"el-dropdown-link",class:{active:""!==t.query.filterSort}},[t._v("\n        "+t._s(t.$t("core.sort"))),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.filterSort,(function(e,r){return n("el-dropdown-item",{key:r,class:{active:e.value===t.query.filterSort},attrs:{command:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1)],1)],2),t._v(" "),n("create-post-popover")],1)}),[],!1,null,"be1d1e86",null);e.default=component.exports;installComponents(component,{CreatePostPopover:n(304).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=n(1),c={name:"TopicList",mixins:[n.n(o).a],data:function(){return{searchValue:"",searchList:[],searchTotal:0,pageNumber:1,pageLimit:5,setTimeoutId:null,loading:!1}},computed:{noMore:function(){return!this.loading&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.getTopics()},methods:{searchTopics:function(t){var e=this;this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getTopics(),e.setTimeoutId=null}),300)},getTopics:function(){var t=this,e={"page[limit]":this.pageLimit,"page[number]":this.pageNumber,sort:"recommended"};return this.searchValue&&(e["filter[content]"]=this.searchValue),this.searchValue||(e["filter[recommended]"]=1),this.$store.dispatch("jv/get",["topics",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(r.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getTopics())},emitValue:function(t){this.$emit("selectedTopic"," #"+t+"# "),this.searchValue="",this.searchList=[],this.getTopics()}}},l=(n(702),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-search-list",on:{click:function(t){t.stopPropagation()}}},[n("label",{on:{click:function(t){if(t.target!==t.currentTarget)return null}}},[n("input",{staticClass:"input-topic",attrs:{type:"text",placeholder:t.$t("post.topicInputTip")},domProps:{value:t.searchValue},on:{input:t.searchTopics,click:function(t){if(t.target!==t.currentTarget)return null}}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},[t.searchValue&&t.searchList.map((function(t){return t.content})).indexOf(t.searchValue)<0&&!t.loading?n("li",{on:{click:function(e){return t.emitValue(t.searchValue)}}},[n("span",[t._v("#"+t._s(t.searchValue)+"#")]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.newTopic")))])]):t._e(),t._v(" "),t._l(t.searchList,(function(e,r){return n("li",{key:r,staticClass:"infinite-list-item",on:{click:function(n){return t.emitValue(e.content)}}},[n("span",[t._v("#"+t._s(e.content)+"#")]),t._v(" "),n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:1===e.recommended,expression:"topic.recommended === 1"}],staticStyle:{"font-size":"16px"},attrs:{type:"recommend"}}),t._v(" "),n("span",[t._v(t._s(e.view_count+t.$t("topic.hot")))])],1)}))],2),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e()])])}),[],!1,null,"5d9c9c32",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={name:"Emoji",data:function(){return{emojiList:[]}},mounted:function(){this.getEmojiList()},methods:{getEmojiList:function(){var t=this;this.$store.dispatch("jv/get",["emoji",{}]).then((function(data){t.emojiList=data}))}}},o=(n(703),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji-list"},t._l(t.emojiList,(function(e,r){return n("span",{key:r,on:{click:function(n){return t.$emit("selectEmoji",e.code)}}},[n("img",{attrs:{src:e.url,alt:e.code}})])})),0)}),[],!1,null,"20b15f26",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);n(24);var r={name:"TopicPassword",props:{price:{type:[Number,String],default:""},passwordError:{type:Boolean,default:!1},passwordErrorTip:{type:String,default:""}}},o=(n(750),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("pay.checkoutCounter")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("pay.pay")+t.$t("pay.sumOfMoney")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",{staticClass:"icon"},[t._v("￥")]),t._v(" "),n("span",[t._v(t._s(t.price))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("pay.payPassword")))]),t._v(" "),n("password-input",{attrs:{error:t.passwordError},on:{password:function(e){return t.$emit("password",e)},type:function(e){return t.$emit("update:passwordError",!1)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.passwordError,expression:"passwordError"}],staticClass:"error-tip"},[t._v(t._s(t.passwordErrorTip?t.passwordErrorTip:t.$t("pay.passwordError")))])],1),t._v(" "),n("span",{staticClass:"forget-password",on:{click:function(e){return t.$emit("findPassword")}}},[t._v(t._s(t.$t("topic.forgetPasswordFindIt")))])])])}),[],!1,null,"7e5a73cb",null);e.default=component.exports;installComponents(component,{PasswordInput:n(833).default,MessageBox:n(90).default})},function(t,e,n){"use strict";n.r(e);n(24);var r=n(115),o={name:"TopicCheckoutCounter",props:{threadType:{type:Number,default:0},user:{type:Object,default:function(){}},amount:{type:[String,Number],default:""},content:{type:String,default:""},rewardOrPay:{type:String,default:""},beAskedUser:{type:Object,default:function(){}},showAnonymous:{type:Boolean,default:!0},askOrWatchAnswer:{type:String,default:"ask"},showWechatPay:{type:Boolean,default:!0}},data:function(){return{hideAvatar:!1,text:["getRemainingContent","getRemainingContent","getVideo","getPicture","getAudio"],payWay:"wxPay",rewardAmount:"",defaultAmounts:["1","2","5","10","20","50","88","128"],loading:!1}},computed:{showAmount:function(){return"reward"===this.rewardOrPay?this.formatToFixed(this.rewardAmount):this.amount},userWallet:function(){var t=this.$store.state.user.info.attributes;return{walletBalance:t.walletBalance,canWalletPay:t.canWalletPay}},enoughBalance:function(){return"reward"===this.rewardOrPay?parseFloat(this.rewardAmount||"0")<=parseFloat(this.userWallet.walletBalance):parseFloat(this.amount)<=parseFloat(this.userWallet.walletBalance)}},created:function(){var t=this;this.loading=!0;var e=this.$store.state.user.info.id;e?this.$store.dispatch("user/getUserInfo",e).then((function(){t.$store.commit("session/SET_USER_ID",e),t.loading=!1}),(function(e){return t.$store.commit("user/SET_USER_INFO",{})})):this.loading=!1},methods:{formatAmount:function(t){t.target.value=Object(r.a)(t.target.value),this.rewardAmount=t.target.value},formatToFixed:function(t){return(parseFloat(t||"0")+1e-6).toFixed(2)}}},c=(n(749),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("pay.checkoutCounter")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("pay.payProduct")))]),t._v(" "),5===t.threadType?n("div",{staticClass:"body product-information"},[n("span",{staticClass:"title"},[t._v(t._s("ask"===t.askOrWatchAnswer?t.$t("post.askHim"):t.$t("topic.watchAnswer")))]),t._v(" "),n("span",[t._v(t._s(t.$t("post.answerer")+t.beAskedUser.username))])]):n("div",{staticClass:"body product-information"},["reward"===t.rewardOrPay?n("span",{staticClass:"title"},[t._v(t._s(t.$t("pay.supportAuthor")+t.$t("pay.keepWriting")))]):n("span",{staticClass:"title"},[t._v(t._s(t.$t("pay.supportAuthor")+t.$t("pay."+t.text[t.threadType])+t.$t("pay.getRight")))]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.author")+": "+(t.user.username||"")))]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.content")+": "+t.content))])]),t._v(" "),"pay"===t.rewardOrPay?n("div",{staticClass:"amount"},[t._v("￥"+t._s(t.showAmount))]):t._e()]),t._v(" "),"reward"===t.rewardOrPay?n("div",{staticClass:"row"},[n("div",{staticClass:"head reward"},[t._v(t._s(t.$t("topic.reward")+t.$t("pay.sumOfMoney")))]),t._v(" "),n("div",{staticClass:"body reward"},[n("label",[n("span",[t._v("￥")]),t._v(" "),n("input",{attrs:{placeholder:t.$t("pay.inputRewardAmount"),maxlength:"7",type:"text"},domProps:{value:t.rewardAmount},on:{input:t.formatAmount}})]),t._v(" "),n("div",{staticClass:"default-amounts"},t._l(t.defaultAmounts,(function(e,r){return n("button",{key:r,class:{selected:e===t.rewardAmount},on:{click:function(n){t.rewardAmount=e}}},[t._v("￥"+t._s(e)+"\n          ")])})),0)])]):t._e(),t._v(" "),t.showAnonymous?n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("pay.hideAvatar")))]),t._v(" "),n("div",{staticClass:"body hide-avatar",on:{click:function(e){t.hideAvatar=!t.hideAvatar}}},[t.hideAvatar?n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"checked"}}):n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"unchecked"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.hideMyAvatar")))])],1)]):t._e(),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("pay.payType")))]),t._v(" "),t.showWechatPay?n("div",{staticClass:"body pay-way"},[n("div",{staticClass:"pay-card",class:{"pay-card":!0,selected:"wxPay"===t.payWay},on:{click:function(e){t.payWay="wxPay"}}},[n("div",{staticClass:"detail"},[n("div",{staticClass:"pay-title"},[n("svg-icon",{staticClass:"active-svg-wx",staticStyle:{fill:"#8590A6","font-size":"20px"},attrs:{type:"wechat"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wxPay")))]),t._v(" "),n("div",{staticClass:"pay-tip"},[n("div",[n("span",[t._v(t._s(t.$t("pay.wxPayTipUse")))]),t._v(" "),n("span",{staticClass:"active-tip",staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.$t("pay.wxPayTipScan")))])]),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wxPayTipPay")))])])],1),t._v(" "),n("div",{staticClass:"pay-amount"},[t._v("￥"+t._s(t.showAmount))])])])]):t._e(),t._v(" "),n("div",{staticClass:"body pay-way"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pay-card",class:{"pay-card":!0,selected:"walletPay"===t.payWay},on:{click:function(e){t.payWay="walletPay"}}},[n("div",{staticClass:"detail"},[n("div",{staticClass:"pay-title"},[n("svg-icon",{staticClass:"active-svg-wallet",staticStyle:{fill:"#8590a6","font-size":"20px"},attrs:{type:"wallet"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.walletPay")))]),t._v(" "),n("div",{staticClass:"pay-tip"},[t.enoughBalance?n("div",[t.userWallet.canWalletPay?t._e():n("nuxt-link",{staticClass:"not-enough-balance",attrs:{to:"/my/wallet"}},[t._v(t._s(t.$t("pay.needToResetPassword")))]),t._v(" "),n("div",[t._v(t._s(t.$t("pay.walletBalance")))])],1):n("div",[t.userWallet.canWalletPay?n("span",{staticClass:"not-enough-balance"},[t._v(t._s(t.$t("pay.walletBalanceNo")))]):n("nuxt-link",{staticClass:"not-enough-balance",attrs:{to:"/my/wallet"}},[t._v(t._s(t.$t("pay.needToResetPassword")))])],1),t._v(" "),n("div",[n("span",[t._v("￥ "+t._s(t.userWallet.walletBalance))])])])],1),t._v(" "),n("div",{staticClass:"pay-amount"},[t._v("￥"+t._s(t.showAmount))])])])])])]),t._v(" "),n("div",{staticClass:"bottom"},[n("span",[t._v("￥ "+t._s(t.showAmount+t.$t("pay.rmb")+t.$t("pay.payTo")+"，"+(t.beAskedUser.username||t.user.username))+" "+t._s("wxPay"===t.payWay?t.$t("pay.ofAccount"):t.$t("pay.ofWalletAccount")))]),t._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"wxPay"===t.payWay,expression:"payWay === 'wxPay'"}],staticClass:"checkout-button",attrs:{type:"primary"},on:{click:function(e){t.$emit("paying",{payWay:t.payWay,hideAvatar:t.hideAvatar,rewardAmount:t.formatToFixed(t.rewardAmount)})}}},[t._v("\n      "+t._s(t.$t("pay.scanPay"))+"\n    ")]),t._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"walletPay"===t.payWay,expression:"payWay === 'walletPay'"}],staticClass:"checkout-button",staticStyle:{margin:"0"},attrs:{disabled:!t.enoughBalance||!t.userWallet.canWalletPay,type:"primary"},on:{click:function(e){t.$emit("paying",{payWay:t.payWay,hideAvatar:t.hideAvatar,rewardAmount:t.formatToFixed(t.rewardAmount)})}}},[t._v("\n      "+t._s(t.$t("pay.surePay"))+"\n    ")])],1)])}),[],!1,null,"50909a7a",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,MessageBox:n(90).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(19),n(25),n(37),n(9),n(1)),c={name:"TopicAside",mixins:[n.n(o).a],props:{author:{type:Object,default:function(){}}},data:function(){return{threeEssenceThread:[],EssenceThread:[],followStatus:0,followLoading:!1,loading:!0,billboard:[{key:"threadCount",count:"",text:this.$t("home.thread")},{key:"questionCount",count:"",text:this.$t("profile.question")},{key:"likedCount",count:"",text:this.$t("topic.getLike")},{key:"followCount",count:"",text:this.$t("home.followed")},{key:"fansCount",count:"",text:this.$t("profile.followers")}]}},computed:{canOpera:function(){var t=this.$store.getters["session/get"]("userId");return!!(this.author.id&&this.author.id>0)&&(parseInt(t)>0&&t!==this.author.id.toString())}},watch:{author:{handler:function(t){0!==Object.keys(t).length&&(this.followStatus=t.follow,this.billboard.forEach((function(e){e.count=t[e.key]})))},deep:!0,immediate:!0}},mounted:function(){this.getEssenceThread()},methods:{getEssenceThread:function(){var t=this;return this.loading=!0,this.$store.dispatch("jv/get",["threads",{params:{"filter[isApproved]":1,"filter[isEssence]":"yes","filter[isDeleted]":"no"}}]).then((function(data){if(t.EssenceThread=Object(r.a)(data),0!==t.EssenceThread.length)for(var e=t.EssenceThread.length>3?3:t.EssenceThread.length;t.threeEssenceThread.length<e;){var n=t.getRandom(t.EssenceThread.length);t.threeEssenceThread.push(t.EssenceThread[n]),t.EssenceThread.splice(n,1)}}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))},getRandom:function(t){return Math.floor(Math.random()*t)},follow:function(){var t=this;if(!this.followLoading){this.followLoading=!0;var e={_jv:{type:"follow"},to_user_id:this.author.id.toString()};return this.$store.dispatch("jv/post",e).then((function(e){t.followLoading=!1,t.followStatus=0===e.is_mutual?1:2}),(function(e){return t.handleError(e)}))}},unFollow:function(){var t=this;this.followLoading||(this.followLoading=!0,this.$store.dispatch("jv/delete","follow/".concat(this.author.id,"/1")).then((function(){t.followLoading=!1,t.followStatus=0})))},goToPage:function(t){window.open("/thread/".concat(t._jv.id))}}},l=(n(746),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("aside-header",{attrs:{author:t.author,billboard:t.billboard,"follow-status":t.followStatus,"follow-loading":t.followLoading,"can-opera":t.canOpera},on:{follow:t.follow,unFollow:t.unFollow}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.threeEssenceThread.length>0,expression:"threeEssenceThread.length > 0"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"recommend block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("topic.recommend")))]),t._v(" "),t._l(t.threeEssenceThread,(function(e,r){return n("div",{key:r,staticClass:"container-post"},[e.title&&e.firstPost.summaryText?n("div",{staticClass:"content-html",on:{click:function(n){return t.goToPage(e)}}},[t._v(" "+t._s(e.title||e.firstPost.summaryText)+" ")]):n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(e.firstPost.summary))},on:{click:function(n){return t.goToPage(e)}}}),t._v(" "),n("span",{staticClass:"view-count"},[t._v(t._s(e.viewCount)+" "+t._s(t.$t("topic.readAlready")))])])}))],2),t._v(" "),n("advertising",{staticStyle:{"margin-top":"15px","margin-bottom":"3px"}}),t._v(" "),n("copyright")],1)}),[],!1,null,"d40523f6",null);e.default=component.exports;installComponents(component,{AsideHeader:n(834).default,Advertising:n(62).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);n(24);var r={name:"CommentHeader",props:{commentCount:{type:Number,default:0},isPositiveSort:{type:Boolean,default:!1}}},o=(n(744),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-header"},[n("div",{staticClass:"count"},[t._v(t._s(t.commentCount+" "+t.$t("topic.item")+t.$t("topic.comment")))]),t._v(" "),n("div",{staticClass:"sort",on:{click:function(e){return t.$emit("changeSort",!t.isPositiveSort)}}},[n("svg-icon",{staticStyle:{"font-size":"14px"},attrs:{type:"sort"}}),t._v(" "),n("span",[t._v(t._s(t.isPositiveSort?t.$t("topic.switchToNegativeSort"):t.$t("topic.switchToPositiveSort")))])],1)])}),[],!1,null,"7d28ce9c",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={name:"UserItem",props:{item:{type:Object,default:function(){}},show:{type:String,default:"all"},isFollow:{type:Boolean,default:!1}},data:function(){return{}},methods:{toUser:function(){this.$router.push("/user/".concat(this.item.id))}}},o=(n(740),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-item-container",class:{simple:"simple"===t.show}},[n("div",{staticClass:"flex user-item",on:{click:function(e){return e.stopPropagation(),t.toUser(e)}}},[n("avatar",{attrs:{user:t.item,size:"simple"===t.show?40:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"flex"},[n("span",{staticClass:"name text-hidden"},[t._v(t._s(t.item.username))]),t._v(" "),"all"===t.show&&t.item.groupName?n("span",{staticClass:"role"},[t._v(t._s(t.item.groupName))]):t._e()]),t._v(" "),n("div",{staticClass:"flex count"},["all"===t.show?n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(t.item.threadCount||0))]):t._e(),t._v(" "),"all"===t.show?n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(t.item.followCount||0))]):t._e(),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(t.item.fansCount||0))])])])],1),t._v(" "),t.isFollow?n("el-button",{staticClass:"follow",attrs:{type:"text"}},[t._v("\n    "+t._s(t.$t("profile.following"))+"\n  ")]):t._e()],1)}),[],!1,null,"5777916a",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=n(1),c={name:"Caller",mixins:[n.n(o).a],data:function(){return{friends:[],friendsLoading:!0,selectedFriends:[],searchList:[],searchValue:"",searchTotal:10,loading:!1,setTimeoutId:null,pageLimit:10,pageNumber:1}},computed:{noMore:function(){return!(!this.searchValue||this.loading)&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.getFriends()},methods:{getFriends:function(){var t=this,e={"filter[type]":2,include:"fromUser,toUser.groups"};return this.$store.dispatch("jv/get",["follow",{params:e}]).then((function(data){t.friendsLoading=!1,t.friends=data.filter((function(t){return 1===t.is_mutual})),t.friends=t.friends.map((function(t){return t.fromUser}))}),(function(e){return t.handleError(e)}))},searchUser:function(t){var e=this;this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue&&(this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getSearchList(),e.setTimeoutId=null}),300))},getSearchList:function(){var t=this,e={"filter[username]":"*"+this.searchValue+"*","filter[status]":"normal","page[limit]":this.pageLimit,"page[number]":this.pageNumber};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(r.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchValue&&this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getSearchList())},formatValue:function(){var t=Object(r.a)(this.selectedFriends);return" @"+(t=t.map((function(t){return t+" "}))).join("@")},selectFriendFromUl:function(t){this.selectedFriends.indexOf(t.username)<0&&this.selectedFriends.push(t.username),this.clear()},clear:function(){this.$refs.inputCaller.value="",this.searchValue="",this.searchList=[]}}},l=(n(704),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("post.callFriends"),overflow:"visible"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"container-selectedCaller"},t._l(t.selectedFriends,(function(e,r){return n("div",{key:r,staticClass:"selectedCaller"},[n("span",[t._v("@ "+t._s(e))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(n){t.selectedFriends.splice(t.selectedFriends.indexOf(e),1)}}})],1)})),0),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("post.searchFriends")))]),t._v(" "),n("div",{staticClass:"container-search-list"},[n("label",[n("input",{ref:"inputCaller",staticClass:"input-caller",attrs:{placeholder:t.$t("post.pleaseInput"),type:"text"},on:{input:t.searchUser}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.searchList,(function(e,r){return n("li",{key:r,class:{"infinite-list-item":!0,selected:t.selectedFriends.indexOf(e.username)>=0},on:{click:function(n){return t.selectFriendFromUl(e)}}},[t._v(t._s(e.username))])})),0),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e(),t._v(" "),t.noMore?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.noMoreData")))]):t._e()])]),t._v(" "),n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.myFriends")))]),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.friendsLoading,expression:"friendsLoading"}],staticClass:"container-caller"},t._l(t.friends,(function(e,r){return n("div",{key:r,class:{caller:!0,selected:t.selectedFriends.indexOf(e.username)>=0},on:{click:function(n){t.selectedFriends.indexOf(e.username)>=0?t.selectedFriends.splice(t.selectedFriends.indexOf(e.username),1):t.selectedFriends.push(e.username)}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0)])]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("span",{staticClass:"text"},[t._v(t._s(t.$t("post.chosen")+" "+t.selectedFriends.length+" "+t.$t("topic.personUnit")))]),t._v(" "),n("el-button",{attrs:{disabled:0===t.selectedFriends.length,size:"medium",type:"primary"},on:{click:function(e){t.$emit("selectedCaller",t.formatValue())}}},[t._v(t._s(t.$t("post.confirmChoice")))])],1)])])}),[],!1,null,"b2de57ee",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Avatar:n(20).default,MessageBox:n(90).default})},function(t,e,n){"use strict";n.r(e);var r={name:"ProductItem",props:{item:{type:Object,default:function(){}}},data:function(){return{}}},o=(n(677),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("a",{staticClass:"product-container",attrs:{href:t.item.detail_content,target:"_blank",el:"nofollow"}},[n("el-image",{staticClass:"image",attrs:{src:t.item.image_path,alt:t.item.title,fit:"cover",lazy:""}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])]),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"info-header"},[n("div",{staticClass:"title"},[t._v(t._s(t.item.title))]),t._v(" "),t.item.price>0?n("div",{staticClass:"price"},[t._v(t._s(t.$t("post.yuanItem")+t.item.price+t.$t("post.yuan")))]):t._e()]),t._v(" "),n("div",{staticClass:"btn"},[n("svg-icon",{staticClass:"icon",attrs:{type:"product-icon"}}),t._v(t._s(t.$t("post.buyProudct")))],1)])],1):t._e()}),[],!1,null,"4589e254",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(37),n(9);var r={name:"AudioPlayer",props:{file:{type:Object,default:function(){}},currentAudio:{type:Object,default:function(){}}},data:function(){return{onDragging:!1,delta:0}},computed:{currentFile:function(){return this.currentAudio.id===this.file._jv.id},playing:function(){return this.currentAudio.currentTime&&this.currentAudio.duration}},methods:{formatDuration:function(t){var e=Math.floor(t/60),n=(t-60*e).toString().substr(0,2);return"."===n[1]&&(n="0"+n[0]),e+":"+n},formatCurrentTime:function(t){var e=parseInt(t/60)%60,n=(t%60).toFixed();return(e<10?"0"+e:e)+":"+(n<10?"0"+n:n)},convertToPercentage:function(){return this.currentAudio.currentTime/this.currentAudio.duration*100},onmousedown:function(){window.document.addEventListener("mousemove",this.dragging),window.document.addEventListener("mouseup",this.onMouseUp)},dragging:function(t){this.delta=t.clientX-this.$refs.progress.getBoundingClientRect().x,this.delta<0&&(this.delta=0),this.delta>290&&(this.delta=290);var time=this.delta/290*this.currentAudio.duration;this.$emit("seeking",time)},onMouseUp:function(){var time=this.delta/290*this.currentAudio.duration;this.$emit("seek",time),window.document.removeEventListener("mousemove",this.dragging),window.document.removeEventListener("mouseup",this.onMouseUp)}}},o=(n(678),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"audio"},[t.currentFile&&t.currentAudio.isLoading?n("div",{staticClass:"control"},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"loading",rotate:""}})],1):t.currentFile&&t.currentAudio.isPlay?n("div",{staticClass:"control",on:{click:function(e){return t.$emit("pause")}}},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-pause"}})],1):n("div",{staticClass:"control",on:{click:function(e){return t.$emit("play",t.file)}}},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-play"}})],1),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"title"},[n("span",{staticClass:"title-audio"},[t._v(t._s(t.file.fileName||t.file.file_name))]),t._v(" "),t.currentFile&&t.playing?n("span",{staticClass:"duration-audio"},[t._v("\n        "+t._s(t.formatCurrentTime(t.currentAudio.currentTime))+" / "+t._s(t.formatDuration(t.currentAudio.duration))+"\n      ")]):n("span",{staticClass:"duration-audio"},[t._v("--:--")])]),t._v(" "),t.currentFile&&t.playing?n("div",{ref:"progress",staticClass:"progress",attrs:{id:"progress"}},[n("div",{staticClass:"progress-item",style:{width:t.convertToPercentage()+"%"}}),t._v(" "),n("div",{staticClass:"control-ball",style:{left:t.convertToPercentage()+"%"},attrs:{id:"control-ball"},on:{mousedown:t.onmousedown}})]):t._e()])])}),[],!1,null,"5944d781",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(18),n(24);var r=n(1),o={mixins:[n.n(r).a],props:{threadId:{type:String,default:""},type:{type:Number,default:0},commentId:{type:String,default:""}},data:function(){return{radio:"",inputInfo:"",otherReasonValue:"",currentReport:"",isOther:!1,reportData:[{value:"advertisingRubbish",name:"广告垃圾"},{value:"illegalContent",name:"违规内容"},{value:"maliciousIrrigation",name:"恶意灌水"},{value:"repeatPost",name:"重复发帖"},{value:"other",name:"其他"}]}},computed:{currentLoginId:function(){var t=this.$store.getters["session/get"]("userId");return parseInt(t,10)}},mounted:function(){this.otherReasonValue=""},methods:{select:function(t){this.currentReport=t,this.isOther="other"===this.currentReport},reportConfirmClick:function(t){var e=this;if(this.currentReport){var n="";if("other"===this.currentReport){if(!this.otherReasonValue)return void this.$message.error(this.$t("report.enterOtherReason"));n=this.otherReasonValue}else this.reportData.forEach((function(t){t.value===e.currentReport&&(n=t.name)}));var r={_jv:{type:"reports"},user_id:this.currentLoginId,thread_id:parseInt(this.threadId),type:t,reason:"".concat(n)};2===t&&(r.post_id=parseInt(this.commentId)),this.$store.dispatch("jv/post",r).then((function(t){t._jv&&(e.$emit("close"),e.$message.success(e.$t("report.reportSucceed")))}),(function(t){return e.handleError(t)}))}else this.$message.error(this.$t("report.pleaseClickReasons"))},reportCancelClick:function(){this.otherReasonValue="",this.currentReport="",this.$emit("close")}}},c=(n(773),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("report.reportTitle")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"reportcontainer"},[n("div",{staticClass:"reportselect"},[n("el-radio-group",{on:{change:t.select},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[n("el-radio",{attrs:{label:"advertisingRubbish"}},[t._v(t._s(this.$t("report.advertisingRubbish")))]),t._v(" "),n("el-radio",{attrs:{label:"illegalContent"}},[t._v(t._s(this.$t("report.illegalContent")))]),t._v(" "),n("el-radio",{attrs:{label:"maliciousIrrigation"}},[t._v(t._s(this.$t("report.maliciousIrrigation")))]),t._v(" "),n("el-radio",{attrs:{label:"repeatPost"}},[t._v(t._s(this.$t("report.repeatPost")))]),t._v(" "),n("el-radio",{staticClass:"otherr",attrs:{label:"other"}},[t._v(t._s(this.$t("report.otherreason")))])],1)],1),t._v(" "),n("div",{staticClass:"other"},[t.isOther?n("el-input",{attrs:{type:"textarea",rows:5,disabled:!t.isOther,placeholder:t.$t("report.enterOtherReason")},model:{value:t.otherReasonValue,callback:function(e){t.otherReasonValue=e},expression:"otherReasonValue"}}):t._e()],1)]),t._v(" "),n("div",{staticClass:"confirmbtn"},[n("div",{staticClass:"allbtn"},[n("el-button",{staticClass:"comfirm",attrs:{type:"small"},on:{click:function(e){return t.reportConfirmClick(t.type)}}},[t._v(t._s(this.$t("report.confirm")))]),t._v(" "),n("el-button",{staticClass:"cancel",attrs:{type:"small"},on:{click:t.reportCancelClick}},[t._v(t._s(this.$t("report.cancel")))])],1)])])}),[],!1,null,"b44bc6c4",null);e.default=component.exports;installComponents(component,{Message:n(58).default})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r={data:function(){return{}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},head:function(){return{link:[{rel:"icon",type:"image/x-icon",href:this.forums&&this.forums.set_site&&this.forums.set_site.site_favicon}]}}},o=(n(488),n(0)),component=Object(o.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"global"},[e("Nuxt")],1)}),[],!1,null,"2ab95d5f",null);e.a=component.exports},function(t,e,n){"use strict";var r={data:function(){return{}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},head:function(){return{link:[{rel:"icon",type:"image/x-icon",href:this.forums&&this.forums.set_site&&this.forums.set_site.site_favicon}]}}},o=(n(487),n(0)),component=Object(o.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"global"},[e("Header",{key:this.$route.path}),this._v(" "),e("div",{staticClass:"app-container"},[e("div",{staticClass:"app-cont"},[e("Nuxt")],1)]),this._v(" "),e("Footer")],1)}),[],!1,null,"7c2ca91c",null);e.a=component.exports;installComponents(component,{Header:n(107).default,Footer:n(363).default})},function(t,e,n){"use strict";var r={data:function(){return{}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},head:function(){return{link:[{rel:"icon",type:"image/x-icon",href:this.forums&&this.forums.set_site&&this.forums.set_site.site_favicon}]}}},o=(n(486),n(0)),component=Object(o.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"global"},[e("Header"),this._v(" "),e("div",{staticClass:"app-cont"},[e("Nuxt")],1)],1)}),[],!1,null,"6220adb2",null);e.a=component.exports;installComponents(component,{Header:n(107).default})},function(t,e,n){"use strict";var r={name:"CenterLayout",data:function(){return{currentNumber:0,menuList:[{index:"/my/profile",classname:"padd",content:"profile.myprofile",hidden:!1},{index:"/my/wallet",classname:"padd",content:"profile.mywallet",hidden:!1},{index:"/my/favorite",classname:"padd",content:"profile.myfavorite",hidden:!1},{index:"/my/shield",classname:"padd",content:"profile.myshield",hidden:!1},{index:"/my/notice",classname:"padd",content:"profile.notice",hidden:!1},{index:"/site",classname:"padd divided",content:"manage.circleinfo",hidden:!1},{index:"/manage",classname:"padd",content:"manage.siteManagement",hidden:!1},{index:"/invite",classname:"padd",content:"invite.invite",hidden:!1}]}},computed:{forums:function(){return this.$store.state.site.info.attributes},userId:function(){return localStorage.getItem("user_id")||""},userInfo:function(){return this.$store.state.user.info.attributes||{}}},mounted:function(){this.initMenu()},methods:{initMenu:function(){if(!this.userId){this.$message.error(this.$t("core.not_authenticated"));var t=this;window.setTimeout((function(){t.$router.push("/")}),1e3)}},currentInfo:function(t){this.currentNumber=t,this.$route.path===this.menuList[t].index&&(window.location.href=this.$route.path)}},head:function(){return{link:[{rel:"icon",type:"image/x-icon",href:this.forums&&this.forums.set_site&&this.forums.set_site.site_favicon}]}}},o=(n(479),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("Header",{key:this.$route.path}),t._v(" "),n("div",{staticClass:"app-container"},[n("div",{staticClass:"app-cont"},[n("el-menu",{attrs:{"default-active":t.$route.path,router:!0}},[t._l(t.menuList,(function(e,r){return["/manage"===e.index?[t.forums&&t.forums.other&&(t.forums.other.can_edit_user_group||t.forums.other.can_edit_user_status||t.forums.other.can_create_invite)?n("el-menu-item",{key:e.index,class:e.classname,attrs:{index:e.index},on:{click:function(e){return t.currentInfo(r)}}},[n("span",{staticClass:"menu-title",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t(e.content)))]),t._v(" "),n("span",{staticClass:"arrow"},[n("i",{staticClass:"el-icon-arrow-right icon"})])]):t._e()]:"/invite"===e.index?[t.forums&&t.forums.other&&t.forums.other.can_invite_user_scale?n("el-menu-item",{key:e.index,class:e.classname,attrs:{index:e.index},on:{click:function(e){return t.currentInfo(r)}}},[n("span",{staticClass:"menu-title",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t(e.content)))]),t._v(" "),n("span",{staticClass:"arrow"},[n("i",{staticClass:"el-icon-arrow-right icon"})])]):t._e()]:[e.hidden?t._e():n("el-menu-item",{key:e.index,class:e.classname,attrs:{index:e.index},on:{click:function(e){return t.currentInfo(r)}}},[n("span",{staticClass:"menu-title",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t(e.content))+"\n                "),"/my/notice"===e.index&&t.userInfo.unreadNotifications>0?n("span",{staticClass:"unread-notice"},[t._v("\n                  "+t._s(t.userInfo.unreadNotifications>99?"99+":t.userInfo.unreadNotifications)+"\n                ")]):t._e()]),t._v(" "),n("span",{staticClass:"arrow"},[n("i",{staticClass:"el-icon-arrow-right icon"})])])]]}))],2),t._v(" "),n("Nuxt",{staticClass:"my-main"})],1)]),t._v(" "),n("Footer")],1)}),[],!1,null,"92f55800",null);e.a=component.exports;installComponents(component,{Header:n(107).default,Footer:n(363).default})},function(t,e,n){"use strict";var r={name:"NuxtLoading",data:function(){return{percent:0,show:!1,canSucceed:!0,reversed:!1,skipTimerCount:0,rtl:!1,throttle:200,duration:5e3,continuous:!1}},computed:{left:function(){return!(!this.continuous&&!this.rtl)&&(this.rtl?this.reversed?"0px":"auto":this.reversed?"auto":"0px")}},beforeDestroy:function(){this.clear()},methods:{clear:function(){clearInterval(this._timer),clearTimeout(this._throttle),this._timer=null},start:function(){var t=this;return this.clear(),this.percent=0,this.reversed=!1,this.skipTimerCount=0,this.canSucceed=!0,this.throttle?this._throttle=setTimeout((function(){return t.startTimer()}),this.throttle):this.startTimer(),this},set:function(t){return this.show=!0,this.canSucceed=!0,this.percent=Math.min(100,Math.max(0,Math.floor(t))),this},get:function(){return this.percent},increase:function(t){return this.percent=Math.min(100,Math.floor(this.percent+t)),this},decrease:function(t){return this.percent=Math.max(0,Math.floor(this.percent-t)),this},pause:function(){return clearInterval(this._timer),this},resume:function(){return this.startTimer(),this},finish:function(){return this.percent=this.reversed?0:100,this.hide(),this},hide:function(){var t=this;return this.clear(),setTimeout((function(){t.show=!1,t.$nextTick((function(){t.percent=0,t.reversed=!1}))}),500),this},fail:function(t){return this.canSucceed=!1,this},startTimer:function(){var t=this;this.show||(this.show=!0),void 0===this._cut&&(this._cut=1e4/Math.floor(this.duration)),this._timer=setInterval((function(){t.skipTimerCount>0?t.skipTimerCount--:(t.reversed?t.decrease(t._cut):t.increase(t._cut),t.continuous&&(t.percent>=100||t.percent<=0)&&(t.skipTimerCount=1,t.reversed=!t.reversed))}),100)}},render:function(t){var e=t(!1);return this.show&&(e=t("div",{staticClass:"nuxt-progress",class:{"nuxt-progress-notransition":this.skipTimerCount>0,"nuxt-progress-failed":!this.canSucceed},style:{width:this.percent+"%",left:this.left}})),e}},o=(n(474),n(0)),component=Object(o.a)(r,void 0,void 0,!1,null,null,null);e.a=component.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(138);n.n(r).a},function(t,e,n){"use strict";var r=n(139);n.n(r).a},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";var r=n(140);n.n(r).a},function(t,e,n){"use strict";var r=n(141);n.n(r).a},function(t,e,n){"use strict";var r=n(142);n.n(r).a},,,function(t,e,n){"use strict";var r=n(143);n.n(r).a},function(t,e,n){"use strict";var r=n(144);n.n(r).a},function(t,e,n){"use strict";var r=n(145);n.n(r).a},function(t,e,n){"use strict";var r=n(146);n.n(r).a},function(t,e,n){"use strict";var r=n(147);n.n(r).a},,,,,,,,,,,,,function(t,e,n){},,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},,,,,function(t,e,n){},function(t,e,n){},,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(149);n.n(r).a},function(t,e,n){"use strict";var r=n(150);n.n(r).a},function(t,e,n){"use strict";var r=n(151);n.n(r).a},function(t,e,n){"use strict";var r=n(152);n.n(r).a},function(t,e,n){"use strict";var r=n(153);n.n(r).a},function(t,e,n){"use strict";var r=n(154);n.n(r).a},function(t,e,n){"use strict";var r=n(155);n.n(r).a},function(t,e,n){"use strict";var r=n(156);n.n(r).a},function(t,e,n){"use strict";var r=n(157);n.n(r).a},function(t,e,n){"use strict";var r=n(158);n.n(r).a},function(t,e,n){"use strict";var r=n(159);n.n(r).a},,function(t,e,n){"use strict";var r=n(160);n.n(r).a},,function(t,e,n){"use strict";var r=n(161);n.n(r).a},function(t,e,n){"use strict";var r=n(162);n.n(r).a},function(t,e,n){"use strict";var r=n(163);n.n(r).a},function(t,e,n){"use strict";var r=n(164);n.n(r).a},function(t,e,n){"use strict";var r=n(165);n.n(r).a},function(t,e,n){"use strict";var r=n(166);n.n(r).a},function(t,e,n){"use strict";var r=n(167);n.n(r).a},function(t,e,n){"use strict";var r=n(168);n.n(r).a},function(t,e,n){"use strict";var r=n(169);n.n(r).a},function(t,e,n){"use strict";var r=n(170);n.n(r).a},function(t,e,n){"use strict";var r=n(171);n.n(r).a},function(t,e,n){"use strict";var r=n(172);n.n(r).a},function(t,e,n){"use strict";var r=n(173);n.n(r).a},function(t,e,n){"use strict";var r=n(174);n.n(r).a},function(t,e,n){"use strict";var r=n(175);n.n(r).a},function(t,e,n){"use strict";var r=n(176);n.n(r).a},,,function(t,e,n){"use strict";var r=n(177);n.n(r).a},function(t,e,n){"use strict";var r=n(178);n.n(r).a},,,,,function(t,e,n){"use strict";var r=n(179);n.n(r).a},function(t,e,n){"use strict";var r=n(180);n.n(r).a},function(t,e,n){"use strict";var r=n(181);n.n(r).a},function(t,e,n){"use strict";var r=n(182);n.n(r).a},function(t,e,n){"use strict";var r=n(183);n.n(r).a},function(t,e,n){"use strict";var r=n(184);n.n(r).a},function(t,e,n){"use strict";var r=n(185);n.n(r).a},function(t,e,n){"use strict";var r=n(186);n.n(r).a},function(t,e,n){"use strict";var r=n(187);n.n(r).a},,function(t,e,n){"use strict";var r=n(188);n.n(r).a},function(t,e,n){"use strict";var r=n(189);n.n(r).a},function(t,e,n){"use strict";var r=n(190);n.n(r).a},function(t,e,n){"use strict";var r=n(191);n.n(r).a},function(t,e,n){"use strict";var r=n(192);n.n(r).a},,function(t,e,n){"use strict";var r=n(193);n.n(r).a},function(t,e,n){"use strict";var r=n(194);n.n(r).a},function(t,e,n){"use strict";var r=n(195);n.n(r).a},function(t,e,n){"use strict";var r=n(196);n.n(r).a},function(t,e,n){"use strict";var r=n(197);n.n(r).a},function(t,e,n){"use strict";var r=n(198);n.n(r).a},function(t,e,n){"use strict";var r=n(199);n.n(r).a},function(t,e,n){"use strict";var r=n(200);n.n(r).a},function(t,e,n){"use strict";var r=n(201);n.n(r).a},function(t,e,n){"use strict";var r=n(202);n.n(r).a},function(t,e,n){"use strict";var r=n(203);n.n(r).a},function(t,e,n){"use strict";var r=n(204);n.n(r).a},function(t,e,n){"use strict";var r=n(205);n.n(r).a},function(t,e,n){"use strict";var r=n(206);n.n(r).a},function(t,e,n){"use strict";var r=n(207);n.n(r).a},function(t,e,n){"use strict";var r=n(208);n.n(r).a},function(t,e,n){"use strict";var r=n(209);n.n(r).a},function(t,e,n){"use strict";var r=n(210);n.n(r).a},function(t,e,n){"use strict";var r=n(211);n.n(r).a},function(t,e,n){"use strict";var r=n(212);n.n(r).a},function(t,e,n){"use strict";var r=n(213);n.n(r).a},function(t,e,n){"use strict";var r=n(214);n.n(r).a},function(t,e,n){"use strict";var r=n(215);n.n(r).a},function(t,e,n){"use strict";var r=n(216);n.n(r).a},function(t,e,n){"use strict";var r=n(217);n.n(r).a},function(t,e,n){"use strict";var r=n(218);n.n(r).a},function(t,e,n){"use strict";var r=n(219);n.n(r).a},function(t,e,n){"use strict";var r=n(220);n.n(r).a},function(t,e,n){"use strict";var r=n(221);n.n(r).a},function(t,e,n){"use strict";var r=n(222);n.n(r).a},function(t,e,n){"use strict";var r=n(223);n.n(r).a},function(t,e,n){"use strict";var r=n(224);n.n(r).a},function(t,e,n){"use strict";var r=n(225);n.n(r).a},function(t,e,n){"use strict";var r=n(226);n.n(r).a},function(t,e,n){"use strict";var r=n(227);n.n(r).a},function(t,e,n){"use strict";var r=n(228);n.n(r).a},function(t,e,n){"use strict";var r=n(229);n.n(r).a},function(t,e,n){"use strict";var r=n(230);n.n(r).a},function(t,e,n){"use strict";var r=n(231);n.n(r).a},function(t,e,n){"use strict";var r=n(232);n.n(r).a},function(t,e,n){"use strict";var r=n(233);n.n(r).a},function(t,e,n){"use strict";var r=n(234);n.n(r).a},function(t,e,n){"use strict";var r=n(235);n.n(r).a},function(t,e,n){"use strict";var r=n(236);n.n(r).a},function(t,e,n){"use strict";var r=n(237);n.n(r).a},function(t,e,n){"use strict";var r=n(238);n.n(r).a},function(t,e,n){"use strict";var r=n(239);n.n(r).a},function(t,e,n){"use strict";var r=n(240);n.n(r).a},function(t,e,n){"use strict";var r=n(241);n.n(r).a},function(t,e,n){"use strict";var r=n(242);n.n(r).a},function(t,e,n){"use strict";var r=n(243);n.n(r).a},function(t,e,n){"use strict";var r=n(244);n.n(r).a},function(t,e,n){"use strict";var r=n(245);n.n(r).a},function(t,e,n){"use strict";var r=n(246);n.n(r).a},function(t,e,n){"use strict";var r=n(247);n.n(r).a},function(t,e,n){"use strict";var r=n(248);n.n(r).a},function(t,e,n){"use strict";var r=n(249);n.n(r).a},function(t,e,n){"use strict";var r=n(250);n.n(r).a},function(t,e,n){"use strict";var r=n(251);n.n(r).a},function(t,e,n){"use strict";var r=n(252);n.n(r).a},function(t,e,n){"use strict";var r=n(253);n.n(r).a},function(t,e,n){"use strict";var r=n(254);n.n(r).a},function(t,e,n){"use strict";var r=n(255);n.n(r).a},function(t,e,n){"use strict";var r=n(256);n.n(r).a},function(t,e,n){"use strict";var r=n(257);n.n(r).a},function(t,e,n){"use strict";var r=n(258);n.n(r).a},function(t,e,n){"use strict";var r=n(259);n.n(r).a},function(t,e,n){"use strict";var r=n(260);n.n(r).a},function(t,e,n){"use strict";var r=n(261);n.n(r).a},function(t,e,n){"use strict";var r=n(262);n.n(r).a},function(t,e,n){"use strict";var r=n(263);n.n(r).a},function(t,e,n){"use strict";var r=n(264);n.n(r).a},function(t,e,n){"use strict";var r=n(265);n.n(r).a},function(t,e,n){"use strict";var r=n(266);n.n(r).a},function(t,e,n){"use strict";n.r(e);var r=n(7),o=n(1),c={name:"Caller",mixins:[n.n(o).a],data:function(){return{preQaUsers:{loading:!0,list:[]},currentQaUsers:{loading:!0,list:[]},nextQaUsers:{loading:!0,list:[]},preTimerId:null,nextTimerId:null,qaFriendsLoading:!1,selectedFriend:{},searchList:[],searchValue:"",searchTotal:10,loading:!1,setTimeoutId:null,pageLimit:10,pageNumber:1,pageLimitPagination:10,pageNumberPagination:1,totalPage:""}},computed:{noMore:function(){return!(!this.searchValue||this.loading)&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.initUserList()},methods:{initUserList:function(){1===this.pageNumberPagination?(this.getUserList(this.pageNumberPagination,this.currentQaUsers),this.getUserList(this.pageNumberPagination+1,this.nextQaUsers)):this.pageNumberPagination===(this.totalPage||10)?(this.getUserList(this.pageNumberPagination-1,this.preQaUsers),this.getUserList(this.pageNumberPagination+1,this.currentQaUsers)):(this.getUserList(this.pageNumberPagination-1,this.preQaUsers),this.getUserList(this.pageNumberPagination,this.currentQaUsers),this.getUserList(this.pageNumberPagination+1,this.nextQaUsers))},getUserList:function(t,e){var n=this;if(!(e.list.length>0)){e.loading=!0;var o={"filter[canBeAsked]":"yes","page[limit]":this.pageLimitPagination,"page[number]":t};return this.$store.dispatch("jv/get",["/users",{params:o}]).then((function(data){var meta=data._jv.json.meta;n.totalPage=meta.pageCount,e.loading=!1,e.list=Object(r.a)(data)}),(function(t){return n.handleError(t)}))}},prePage:function(){var t=this;this.pageNumberPagination<=1||(this.$refs.currentQaUser.classList.add("transfer-right"),this.$refs.preQaUser.classList.add("transfer-right"),setTimeout((function(){t.$refs.currentQaUser.classList.remove("transfer-right"),t.$refs.preQaUser.classList.remove("transfer-right"),t.nextQaUsers=t.currentQaUsers,t.currentQaUsers=t.preQaUsers,t.preQaUsers={loading:!0,list:[]}}),300),this.pageNumberPagination-=1,this.preTimerId&&window.clearTimeout(this.preTimerId),this.preTimerId=setTimeout((function(){t.preTimerId=null,t.initUserList()}),310))},nextPage:function(){var t=this;this.pageNumberPagination>=this.totalPage||(this.$refs.currentQaUser.classList.add("transfer-left"),this.$refs.nextQaUser.classList.add("transfer-left"),setTimeout((function(){t.$refs.currentQaUser.classList.remove("transfer-left"),t.$refs.nextQaUser.classList.remove("transfer-left"),t.preQaUsers=t.currentQaUsers,t.currentQaUsers=t.nextQaUsers,t.nextQaUsers={loading:!0,list:[]}}),300),this.pageNumberPagination+=1,this.nextTimerId&&window.clearTimeout(this.nextTimerId),this.nextTimerId=setTimeout((function(){t.initUserList(),t.nextTimerId=null}),310))},searchUser:function(t){var e=this;this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue&&(this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getSearchList(),e.setTimeoutId=null}),300))},getSearchList:function(){var t=this,e={"filter[username]":"*"+this.searchValue+"*","filter[status]":"normal","page[limit]":this.pageLimit,"page[number]":this.pageNumber,"filter[canBeAsked]":"yes"};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(r.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchValue&&this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getSearchList())},selectFriendFromUl:function(t){this.selectedFriend=t,this.clear()},clear:function(){this.$refs.inputCaller.value="",this.searchValue="",this.searchList=[]}}},l=(n(689),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("post.callAnswer"),overflow:"visible"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"container-selectedCaller"},[n("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.selectedFriend).length>0,expression:"Object.keys(selectedFriend).length > 0"}],staticClass:"selectedCaller"},[n("span",[t._v("@ "+t._s(t.selectedFriend.username))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){t.selectedFriend={}}}})],1)]),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("post.searchFriendsCanBeAsd")))]),t._v(" "),n("div",{staticClass:"container-search-list"},[n("label",[n("input",{ref:"inputCaller",staticClass:"input-caller",attrs:{placeholder:t.$t("post.pleaseInput"),type:"text"},on:{input:t.searchUser}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.searchList,(function(e,r){return n("li",{key:r,class:{"infinite-list-item":!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){return t.selectFriendFromUl(e)}}},[t._v(t._s(e.username))])})),0),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e(),t._v(" "),t.noMore?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.noMoreData")))]):t._e()])]),t._v(" "),n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.recommendAnswer")))]),t._v(" "),n("div",{staticClass:"container-user-list"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.preQaUsers.loading,expression:"preQaUsers.loading"}],ref:"preQaUser",staticClass:"container-caller prePage"},t._l(t.preQaUsers.list,(function(e,r){return n("div",{key:r,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.currentQaUsers.loading,expression:"currentQaUsers.loading"}],ref:"currentQaUser",staticClass:"container-caller currentPage"},t._l(t.currentQaUsers.list,(function(e,r){return n("div",{key:r,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.nextQaUsers.loading,expression:"nextQaUsers.loading"}],ref:"nextQaUser",staticClass:"container-caller nextPage"},t._l(t.nextQaUsers.list,(function(e,r){return n("div",{key:r,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0)]),t._v(" "),t.totalPage?n("div",{staticClass:"container-pagination"},[n("div",{staticClass:"pagination"},[n("svg-icon",{class:{"page-button":!0,"pre-button":!0,disabled:t.pageNumberPagination<=1},attrs:{type:"drop-down"},on:{click:t.prePage}}),t._v(" "),n("span",[t._v(t._s(t.pageNumberPagination))]),t._v(" "),n("svg-icon",{class:{"page-button":!0,"next-button":!0,disabled:t.pageNumberPagination>=t.totalPage},attrs:{type:"drop-down"},on:{click:t.nextPage}})],1)]):t._e()])]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("el-button",{attrs:{disabled:0===Object.keys(t.selectedFriend).length,size:"medium",type:"primary"},on:{click:function(e){return t.$emit("selectedQaCaller",t.selectedFriend)}}},[t._v(t._s(t.$t("post.confirmChoice")))])],1)])])}),[],!1,null,"786b977c",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Avatar:n(20).default,MessageBox:n(90).default})},function(t,e,n){"use strict";n.r(e);n(9),n(692);var r=n(1),o={name:"ProductDialog",mixins:[n.n(r).a],data:function(){return{supportedType:[{icon:"product-jd",text:this.$t("post.jd")},{icon:"product-taobao",text:this.$t("post.taobao")},{icon:"product-tmall",text:this.$t("post.tmall")},{icon:"product-pinduoduo",text:this.$t("post.pinduoduo")},{icon:"product-youzan",text:this.$t("post.youzan")}],link:"",loading:!1}},computed:{},mounted:function(){},methods:{handleLink:function(){var t=this;if(this.link){this.loading=!0;var e={_jv:{type:"goods/analysis"},type:"analysis",address:this.link};this.$store.dispatch("jv/post",e).then((function(e){e&&e._jv&&(t.link="",t.$emit("inputedLink",e))}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))}else this.$message.error(this.$t("post.goodsLinkEmpty"))}}},c=(n(694),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"message-box-product",attrs:{title:t.$t("post.addProduct"),overflow:"visible",width:"620px"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"tips"},[t._v(t._s(t.$t("post.supportedLink")))]),t._v(" "),n("div",{staticClass:"supported-type"},t._l(t.supportedType,(function(e,r){return n("div",{key:r,staticClass:"item"},[n("svg-icon",{staticClass:"icon",attrs:{type:e.icon}}),t._v(t._s(e.text)+"\n      ")],1)})),0),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.link,expression:"link"}],staticClass:"input-link",attrs:{placeholder:t.$t("post.goodsLink")},domProps:{value:t.link},on:{input:function(e){e.target.composing||(t.link=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.handleLink}},[t._v(t._s(t.$t("discuzq.ok")))]),t._v(" "),n("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("post.cancel")))])],1)])])}),[],!1,null,"33d30d80",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,MessageBox:n(90).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(9),n(18),n(1)),c=n.n(o),time=n(21),l={filters:{formatDate:function(t){return Object(time.b)(t)},formatDateDay:function(t){return Object(time.a)(t)}},mixins:[c.a],props:{groupInviteList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,selectedGroup:"",groupId:[],groupList:[],handleValue:"",pageNum:1,pageSize:10,total:0,searchText:"",userList:[],selectedHandle:"",multipleSelection:[],layout:"total, sizes, prev, pager, next, jumper",isPad:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userInfo:function(){return this.$store.state.user.info.attributes||{}}},mounted:function(){this.getUserList(),this.getGroupList()},methods:{getGroupList:function(){var t=this;this.$store.dispatch("jv/get",["groups",{}]).then((function(e){e&&Array.isArray(e)&&e.length>0&&e.forEach((function(e){t.groupList.push({label:e.name,value:e._jv.id})}))}))},getUserList:function(){var t=this;this.loading=!0;var e={include:"groups","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[group_id][]":this.groupId,"filter[username]":"*".concat(this.searchText,"*")};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(e){e&&(t.total=e._jv.json.meta.total,t.userList=e,t.reloadForums())}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},reloadForums:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("site/getSiteInfo");case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))()},onClickSearch:function(){this.reloadList()},onChangeFilter:function(t){this.groupId=t?[t]:[],this.reloadList()},reloadList:function(){this.pageNum=1,this.getUserList()},handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getUserList()},handleCurrentChange:function(t){this.pageNum=t,this.getUserList()},handleCommand:function(t){if("disable"===t.command||"normal"===t.command){var e="disable"===t.command?1:0;this.modifyUserStatus(e,t.userId)}else this.modifyUserGroup(t.command,t.userId)},handleSelectionChange:function(t){this.multipleSelection=t},onChangeGroup:function(t){this.modifyUserGroup(t),this.handleValue=""},modifyUserGroup:function(t,e){var n=this;if(this.forums&&this.forums.other&&!this.forums.other.can_edit_user_group)return this.$message.error(this.$t("core.permission_denied"));var data=[];if(e&&t)data.push({attributes:{id:e,groupId:parseInt(t,10)}});else{if(!(this.multipleSelection&&this.multipleSelection.length>0))return void this.$message.error(this.$t("manage.selectUser"));for(var i=0;i<this.multipleSelection.length;i+=1)data.push({attributes:{id:this.multipleSelection[i].id,groupId:parseInt(t,10)}})}var r=[{_jv:{type:"users"}},{data:{data:data}}];this.loading=!0,this.$store.dispatch("jv/patch",r).then((function(t){if(t){if(t._jv&&t._jv.json&&t._jv.json.data&&t._jv.json.data.length>0&&t._jv.json.data[0].attributes&&"Permission Denied"===t._jv.json.data[0].attributes.error)return n.$message.error(n.$t("manage.modifyFail"));n.$message.success(n.$t("discuzq.msgBox.modifySuccess")),n.getUserList()}}),(function(t){n.handleError(t)})).finally((function(){n.loading=!1}))},modifyUserStatus:function(t,e){var n=this;if(this.forums&&this.forums.other&&!this.forums.other.can_edit_user_status)return this.$message.error(this.$t("core.permission_denied"));if(+this.userInfo.id==+e)return this.$message.error(this.$t("core.no_edit_self"));var r={data:{attributes:{status:t}}};this.loading=!0,this.$store.dispatch("jv/patch",[{_jv:{type:"users/".concat(e)}},{data:r}]).then((function(t){t&&(n.$message.success(n.$t("discuzq.msgBox.modifySuccess")),n.getUserList())}),(function(t){n.handleError(t)})).finally((function(){n.loading=!1}))},handleCommandInvite:function(t){this.createAdminInvite(t)},createAdminInvite:function(t){var e=this,n={data:{attributes:{group_id:t}}};this.$store.dispatch("jv/post",[{_jv:{type:"invite"}},{data:n}]).then((function(t){e.copyLink(t.code)}),(function(t){e.handleError(t)}))},copyLink:function(code){var t=document.createElement("input");t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/site/partner-invite?code=").concat(code),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success(this.$t("discuzq.msgBox.copySuccess")),setTimeout((function(){t.remove()}),100)}}},d=(n(667),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("div",{staticClass:"filter-cont"},[n("el-select",{attrs:{placeholder:t.$t("profile.pleaseselect"),size:"medium"},on:{change:t.onChangeFilter},model:{value:t.selectedGroup,callback:function(e){t.selectedGroup=e},expression:"selectedGroup"}},[n("el-option",{attrs:{label:t.$t("manage.allIdentity"),value:""}}),t._v(" "),t._l(t.groupList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2),t._v(" "),n("div",{staticClass:"content"},[t.loading?t._e():[t._v("\n        "+t._s(t.$t("manage.userTotal",{total:t.total}))+"\n      ")]],2),t._v(" "),n("el-input",{staticClass:"search",attrs:{placeholder:t.$t("manage.pleaseInputUserName"),size:"medium"},on:{input:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),t._v(" "),t.forums&&t.forums.other&&t.forums.other.can_edit_user_group?n("el-select",{staticClass:"el-select-margin",attrs:{placeholder:t.$t("manage.batchOperate"),size:"medium"},on:{change:t.onChangeGroup},model:{value:t.handleValue,callback:function(e){t.handleValue=e},expression:"handleValue"}},t._l(t.groupInviteList,(function(e){return n("el-option",{key:e.value,attrs:{label:t.$t("manage.set")+e.label,value:e.value}})})),1):t._e(),t._v(" "),t.forums&&t.forums.other&&t.forums.other.can_create_invite?n("el-dropdown",{staticClass:"handle-dropdown",attrs:{placement:"bottom",trigger:"click"},on:{command:t.handleCommandInvite}},[n("el-button",{staticClass:"create-url",attrs:{type:"primary",size:"medium"}},[t._v(t._s(t.$t("manage.generateInvitationUrl")))]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.groupInviteList,(function(e,r){return n("el-dropdown-item",{key:r,attrs:{command:e.value}},[t._v("\n          "+t._s(e.label+t.$t("manage.invitationUrl"))+"\n        ")])})),1)],1):t._e()],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.userList},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"35"}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.userName"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"flex"},[n("avatar",{attrs:{user:{id:e.row.id,username:e.row.username,avatarUrl:e.row.avatarUrl},size:30,round:!0}}),t._v(" "),n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+e.row.id}},[t._v(t._s(e.row.username))])],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.identity")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.groups&&e.row.groups.length>0&&e.row.groups[0]?e.row.groups[0].name:"")+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.status"),"min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?[t._v(t._s(t.$t("manage.normal")))]:n("span",{staticClass:"red"},[t._v(t._s(t.$t("manage.disable")))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.circleAge")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("formatDateDay")(e.row.createdAt))+"\n      ")]}}])}),t._v(" "),t.forums&&t.forums.other&&(t.forums.other.can_edit_user_group||t.forums.other.can_edit_user_status)?n("el-table-column",{attrs:{fixed:"right",label:t.$t("manage.operate"),width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-dropdown",{staticClass:"handle-dropdown",attrs:{placement:"bottom",trigger:"click"},on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n            "+t._s(t.$t("manage.modifyRole"))+"\n          ")]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.forums&&t.forums.other&&t.forums.other.can_edit_user_group?t._l(t.groupInviteList,(function(r,o){return n("el-dropdown-item",{key:o,attrs:{command:{userId:e.row._jv.id,command:r.value}}},[t._v(t._s(t.$t("manage.set")+r.label))])})):t._e(),t._v(" "),t.forums&&t.forums.other&&t.forums.other.can_edit_user_status&&0===e.row.status?n("el-dropdown-item",{attrs:{command:{userId:e.row._jv.id,command:"disable"}}},[t._v(t._s(t.$t("manage.disable")))]):t.forums&&t.forums.other&&t.forums.other.can_edit_user_status&&1===e.row.status?n("el-dropdown-item",{attrs:{command:{userId:e.row._jv.id,command:"normal"}}},[t._v(t._s(t.$t("manage.cancelDisable")))]):t._e()],2)],1)]}}],null,!1,3974112810)}):t._e()],1),t._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"","hide-on-single-page":"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:t.layout,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)}),[],!1,null,"62d7fcb5",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(1),l={name:"Following",mixins:[n.n(c).a],props:{userId:{type:String,default:""}},data:function(){return{value:"",inputVal:"",loadingType:"",followingList:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,sort:"",options:[{label:this.$t("home.noLimit"),value:""},{label:"用户创建时间",value:"users.createdAt"}]}},mounted:function(){this.getFollowingList()},methods:{getFollowingList:function(t){var e=this;this.loading=!0;var n={include:"toUser,toUser.groups","filter[type]":1,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[user_id]":this.userId,"filter[username]":"".concat(this.inputVal)};o.b.run((function(){return e.$store.dispatch("jv/get",["follow",{params:n}])})).then((function(n){e.loading=!1,e.hasMore=n.length===e.pageSize,e.followingList="change"===t?n:[].concat(Object(r.a)(e.followingList),Object(r.a)(n)),n._jv&&(e.hasMore=e.followingList.length<n._jv.json.meta.total),e.pageNum+=1}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},addFollow:function(t,e){var n=this;if(this.$store.getters["session/get"]("isLogin"))if(0===t.follow){var r={_jv:{type:"follow"},type:"user_follow",to_user_id:t.id};this.$store.dispatch("jv/post",r).then((function(t){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var r=n.followingList[e],o=JSON.parse(JSON.stringify(r));o.toUser.follow=1===t.is_mutual?2:1,n.$set(n.followingList,e,o)}))}else this.deleteFollow(t,e)},deleteFollow:function(t,e){var n=this;this.$store.getters["session/get"]("isLogin")&&this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var t=n.followingList[e],r=JSON.parse(JSON.stringify(t));r.toUser.follow=0,n.$set(n.followingList,e,r)}))},loadMore:function(){this.hasMore&&this.getFollowingList()},toUser:function(t){this.$router.push("/user/".concat(t))},confirm:function(t){this.sort=t,this.pageNum=1,this.followingList=[],this.getFollowingList("change")},onClickSearch:function(){this.pageNum=1,this.getFollowingList("change")}}},d=(n(786),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"following"},[n("div",{staticClass:"ftop"},[n("el-select",{staticClass:"fselect",attrs:{placeholder:"排序",size:"small"},on:{change:t.confirm},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("el-input",{staticClass:"h-search",attrs:{size:"small",placeholder:t.$t("manage.pleaseInputUserName")},on:{change:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.onClickSearch},slot:"suffix"})])],1),t._v(" "),t._l(t.followingList,(function(e,r){return n("div",{key:r,staticClass:"user-item-container"},[n("div",{staticClass:"flex user-item",on:{click:function(n){return n.stopPropagation(),t.toUser(e.toUser.id)}}},[n("avatar",{attrs:{user:e.toUser,size:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"flex"},[n("span",{staticClass:"name text-hidden"},[t._v(t._s(e.toUser.username))]),t._v(" "),e.toUser.groups&&e.toUser.groups[0]&&e.toUser.groups[0].isDisplay?n("span",{staticClass:"role"},[t._v(t._s(e.toUser&&e.toUser.groups&&e.toUser.groups[0]?e.toUser.groups[0].name:""))]):t._e()]),t._v(" "),n("div",{staticClass:"flex count"},[n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(e.toUser.threadCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(e.toUser.followCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(e.toUser.fansCount||0))])])])],1),t._v(" "),(e.toUser&&e.toUser.id)!=t.currentLoginId?n("el-button",{staticClass:"follow",attrs:{type:"text"},on:{click:function(n){return t.addFollow(e.toUser,r)}}},[2===e.toUser.follow?n("svg-icon",{staticClass:"follow-icon",attrs:{type:"follow-heart"}}):t._e(),t._v("\n      "+t._s(0==(e.toUser&&e.toUser.follow)?t.$t("profile.following"):1==(e.toUser&&e.toUser.follow)?t.$t("profile.followed"):t.$t("profile.mutualfollow"))+"\n    ")],1):t._e()],1)})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.followingList.length},on:{loadMore:t.loadMore}})],2)}),[],!1,null,"ce18ea66",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,SvgIcon:n(11).default,ListLoadMore:n(40).default})},function(t,e,n){"use strict";n.r(e);n(78),n(9);var r=n(1),o=n.n(r),time=n(21),c={mixins:[o.a],props:{groupMap:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,selectedStatus:"",handleValue:"",pageNum:1,pageSize:10,total:0,inviteList:[],selectedHandle:"",multipleSelection:[],statusList:[{label:this.$t("manage.invalid"),value:0},{label:this.$t("manage.nouse"),value:1},{label:this.$t("manage.used"),value:2},{label:this.$t("manage.overdue"),value:3}]}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userInfo:function(){return this.$store.state.user.info.attributes||{}}},watch:{groupMap:{handler:function(){0===this.inviteList.length&&this.getInviteList()},deep:!0}},mounted:function(){this.getInviteList()},methods:{getInviteList:function(){var t=this;this.loading=!0;var e={"page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[status]":this.selectedStatus};this.$store.dispatch("jv/get",["invite",{params:e}]).then((function(e){if(e){t.total=e._jv.json.meta.total;var n=e,r=t.groupMap;n&&n.length>0&&n.forEach((function(e){var n=Object(time.c)(e.endtime);1===e.status?e.time=t.$t("manage.remainDay",{day:n}):e.time=t.$t("manage.remain0Day"),e.title=r[e.group_id]+t.$t("manage.invitationUrl")})),t.inviteList=n}}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},createAdminInvite:function(t){var e=this;if(!this.loading){this.loading=!0;var n={data:{attributes:{group_id:t}}};this.$store.dispatch("jv/post",[{_jv:{type:"invite"}},{data:n}]).then((function(){e.reloadList()}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))}},deleteInvite:function(t){var e=this;if(!this.loading){var n={_jv:{type:"invite",id:t}};this.$confirm(this.$t("manage.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel")}).then((function(){e.loading=!0,e.$store.dispatch("jv/delete",n).then((function(){e.$message.success(e.$t("discuzq.msgBox.operateSuccess")),e.reloadList()}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))})).catch((function(){}))}},copyLink:function(code){var t=document.createElement("input");t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/site/partner-invite?code=").concat(code),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success(this.$t("discuzq.msgBox.copySuccess")),setTimeout((function(){t.remove()}),100)},reloadList:function(){this.pageNum=1,this.getInviteList()},handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getInviteList()},handleCurrentChange:function(t){this.pageNum=t,this.getInviteList()},formatStatus:function(t){if(this.statusList.find((function(e){return e.value===t})))return this.statusList.find((function(e){return e.value===t})).label},handleCommand:function(t){this.createAdminInvite(t)},handleSelectionChange:function(t){this.multipleSelection=t},onChangeGroup:function(t){this.modifyUserGroup(t),this.handleValue=""}}},l=(n(668),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("div",{staticClass:"filter-cont"},[n("el-select",{attrs:{placeholder:t.$t("profile.pleaseselect"),size:"medium"},on:{change:t.reloadList},model:{value:t.selectedStatus,callback:function(e){t.selectedStatus=e},expression:"selectedStatus"}},[n("el-option",{attrs:{label:t.$t("manage.allStatus"),value:""}}),t._v(" "),t._l(t.statusList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],2),t._v(" "),n("div",{staticClass:"content"},[t.loading?t._e():[[t._v(t._s(t.$t("manage.total",{total:t.total})))]]],2),t._v(" "),n("el-dropdown",{staticClass:"handle-dropdown",attrs:{placement:"bottom",trigger:"click"},on:{command:t.handleCommand}},[n("el-button",{staticClass:"create-url",attrs:{type:"primary",size:"medium"}},[t._v(t._s(t.$t("manage.generateInvitationUrl")))]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(Object.keys(t.groupMap),(function(e,r){return n("el-dropdown-item",{key:r,attrs:{command:e}},[t._v("\n          "+t._s(t.groupMap[e]+t.$t("manage.invitationUrl"))+"\n        ")])})),1)],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:t.inviteList},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{prop:"title",label:t.$t("manage.urlType")}}),t._v(" "),n("el-table-column",{attrs:{prop:"time",label:t.$t("site.periodvalidity")}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.status")},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?n("span",{staticClass:"red"},[t._v(" "+t._s(t.formatStatus(e.row.status)))]):[t._v(t._s(t.formatStatus(e.row.status)))]]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.operate"),width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"btn",attrs:{type:"text",disabled:1!==e.row.status},on:{click:function(n){return t.deleteInvite(e.row._jv.id)}}},[t._v("\n          "+t._s(t.$t("manage.setInvalid"))+"\n        ")]),t._v(" "),n("el-button",{staticClass:"btn",attrs:{type:"text",disabled:1!==e.row.status},on:{click:function(n){return t.copyLink(e.row.code)}}},[t._v("\n          "+t._s(t.$t("manage.share"))+"\n        ")])]}}])})],1),t._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"","hide-on-single-page":"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)}),[],!1,null,"7b5dcf42",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(1),l={mixins:[n.n(c).a],props:{userId:{type:String,default:""},likethreadsData:{type:Array,default:function(){return[]}}},data:function(){return{data:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,editThreadId:"",currentAudioId:""}},mounted:function(){this.data=this.likethreadsData,0===this.data.length&&this.loadlikes()},methods:{loadlikes:function(){var t=this;this.loading=!0;var e={include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[isApproved]":1,"filter[user_id]":this.userId};o.b.run((function(){return t.$store.dispatch("jv/get",["threads/likes",{params:e}])})).then((function(e){t.loading=!1,t.hasMore=e.length===t.pageSize;var n=JSON.parse(JSON.stringify(e));t.data=[].concat(Object(r.a)(t.data),Object(r.a)(n)),e._jv&&(t.hasMore=t.data.length<e._jv.json.meta.threadCount),t.pageNum+=1}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.hasMore&&this.loadlikes()},changelike:function(){this.pageNum=1,this.data=[],this.$emit("changeFollow",{userId:this.userId}),this.loadlikes()},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},d=(n(785),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"like"},[n("div",{staticClass:"post-list"},[t._l(t.data,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,lazy:!1},on:{change:t.changelike,audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e,lazy:!1},on:{change:t.changelike}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.data.length},on:{loadMore:t.loadMore}})],2)])}),[],!1,null,"7b8ede94",null);e.default=component.exports;installComponents(component,{PostItem:n(57).default,ListLoadMore:n(40).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(1),l={mixins:[n.n(c).a],props:{userId:{type:String,default:""},askthreadData:{type:Array,default:function(){return[]}}},data:function(){return{askthreadsData:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1}},mounted:function(){this.askthreadsData=this.askthreadData,0===this.askthreadsData.length&&this.loadThreads()},methods:{loadThreads:function(){var t=this;this.loading=!0;var e={"filter[isDeleted]":"no",sort:"-createdAt",include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question,question.beUser,question.beUser.groups","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[isApproved]":1,"filter[userId]":this.userId,"filter[type]":5,"filter[answer]":"yes"};o.b.run((function(){return t.$store.dispatch("jv/get",["threads",{params:e}])})).then((function(e){t.loading=!1,t.hasMore=e.length===t.pageSize,t.askthreadsData=[].concat(Object(r.a)(t.askthreadsData),Object(r.a)(e)),e._jv&&(t.hasMore=t.askthreadsData.length<e._jv.json.meta.threadCount),t.pageNum+=1}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.hasMore&&this.loadThreads()},changelike:function(){this.$emit("changeLike",{userId:this.userId})},changetopiclike:function(){this.pageNum=1,this.askthreadsData=[],this.loadThreads()}}},d=(n(784),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic"},[n("div",{staticClass:"post-list"},[t._l(t.askthreadsData,(function(e,r){return n("post-item",{key:r,attrs:{item:e,lazy:!1},on:{change:t.changelike}})})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.askthreadsData.length},on:{loadMore:t.loadMore}})],2)])}),[],!1,null,"42af2217",null);e.default=component.exports;installComponents(component,{PostItem:n(57).default,ListLoadMore:n(40).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(1),l={mixins:[n.n(c).a],props:{userId:{type:String,default:""},threadData:{type:Array,default:function(){return[]}}},data:function(){return{threadsData:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,currentAudioId:""}},mounted:function(){this.threadsData=this.threadData,0===this.threadsData.length&&this.loadThreads()},methods:{loadThreads:function(){var t=this;this.loading=!0;var e={"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[type]":"0,1,2,3,4,6",sort:"-createdAt",include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question,question.beUser,question.beUser.groups","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[isApproved]":1,"filter[userId]":this.userId};o.b.run((function(){return t.$store.dispatch("jv/get",["threads",{params:e}])})).then((function(e){t.loading=!1,t.hasMore=e.length===t.pageSize,t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(e)),e._jv&&(t.hasMore=t.threadsData.length<e._jv.json.meta.threadCount),t.pageNum+=1}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.hasMore&&this.loadThreads()},changelike:function(){this.$emit("changeLike",{userId:this.userId})},changetopiclike:function(){this.pageNum=1,this.threadsData=[],this.loadThreads()},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},d=(n(783),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic"},[n("div",{staticClass:"post-list"},[t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,lazy:!1},on:{change:t.changelike,audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e,lazy:!1},on:{change:t.changelike}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})],2)])}),[],!1,null,"d8560e2c",null);e.default=component.exports;installComponents(component,{PostItem:n(57).default,ListLoadMore:n(40).default})},function(t,e,n){"use strict";n.r(e);var r={name:"TopicActions",props:{actions:{type:Array,default:function(){return[]}},threadId:{type:String,default:""}},methods:{onClick:function(t){t.command&&this.$emit("clickAction",t)},copyLink:function(){var t=document.createElement("input");t.value=window.location.href,t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success("链接复制成功"),setTimeout((function(){t.remove()}),100)}}},o=(n(777),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"actions"},[t._l(t.actions.slice(0,3),(function(e,r){return n("button",{key:r,class:{action:!0,disabled:!e.canOpera},attrs:{disabled:!e.canOpera},on:{click:function(n){return t.onClick(e)}}},[n("svg-icon",{staticClass:"action-icon",attrs:{type:e.icon}}),t._v(" "),n("span",{staticClass:"content"},[n("span",[t._v(t._s(e.text))]),t._v(" "),e.count?n("span",[t._v(" ("+t._s(e.count)+")")]):t._e()])],1)})),t._v(" "),n("div",{staticClass:"action"},[n("share-popover",{attrs:{"threads-id":t.threadId}},[n("div",{staticClass:"btn share"},[n("button",{class:{action:!0,disabled:!t.actions[3].canOpera},attrs:{slot:"reference",disabled:!t.actions[3].canOpera},slot:"reference"},[n("svg-icon",{staticClass:"action-icon",attrs:{type:t.actions[3].icon}}),t._v(" "),n("span",{staticClass:"content"},[n("span",[t._v(t._s(t.actions[3].text))]),t._v(" "),t.actions[3].count?n("span",[t._v(" ("+t._s(t.actions[3].count)+")")]):t._e()])],1)])])],1)],2)}),[],!1,null,"64a49188",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,SharePopover:n(299).default})},function(t,e,n){"use strict";n.r(e);n(24);var r=n(45),o={name:"TopicRewardList",mixins:[n.n(r).a],props:{author:{type:Object,default:function(){}},userLists:{type:Array,default:function(){return[]}},paidInformation:{type:Object,default:function(){}},threadType:{type:Number,default:0},canReward:{type:Boolean,default:!1},canPaid:{type:Boolean,default:!1}},data:function(){return{payButtonText:["",this.$t("topic.paymentViewRemainingContent"),this.$t("topic.paymentViewVideo"),this.$t("topic.paymentViewPicture"),this.$t("topic.paymentViewAudio")],command:[{value:24,title:"pay",buttonText:this.$t("topic.pay"),showButton:!1,icon:"pay"},{value:24,title:"reward",buttonText:this.$t("topic.reward"),showButton:!1,icon:"heart"},{value:24,title:"like"},{value:24,title:"pay",buttonText:this.$t("topic.pay"),showButton:!1,icon:"pay"}]}},watch:{paidInformation:{handler:function(t){this.command[0].showButton=parseFloat(t.price)>0&&!t.paid&&this.canPaid,this.command[3].showButton=parseFloat(t.attachmentPrice)>0&&!t.isPaidAttachment&&this.canPaid,this.command[1].showButton=0===parseFloat(t.price)&&0===parseFloat(t.attachmentPrice)&&this.canReward,this.command[3].buttonText=this.$t("topic.pay")+this.paidInformation.attachmentPrice+this.$t("topic.paymentViewAttachment")},deep:!0},threadType:function(t){this.command[0].buttonText=this.$t("topic.pay")+this.paidInformation.price+this.payButtonText[t]}},methods:{showMore:function(t,e){t.value<e?t.value+=24:t.value=24},onClick:function(t,e){if(this.isLogin()){var n=this.$store.state.user.info.id;return parseInt(n)===parseInt(this.author.id)?this.$message.error(this.$t("topic.iCantRewardMyself")):this.$emit("payOrReward",t[e].title)}}}},c=(n(776),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},t._l(t.userLists,(function(e,r){return n("div",{key:r,staticClass:"group"},[e.length>0?n("div",{staticClass:"title"},[t._v("\n      "+t._s(e.length+t.$t("topic.personUnit")+t.$t("topic."+t.command[r].title))+"\n    ")]):t._e(),t._v(" "),e.length>0?n("div",{staticClass:"person-list"},[n("div",{staticClass:"first-show"},[t._l(e.slice(0,t.command[r].value),(function(t,e){return[n("Avatar",{key:e,staticClass:"container-avatar",attrs:{size:"30",round:"",user:t}})]}))],2)]):t._e(),t._v(" "),e.length>24?n("div",{class:{rotate:t.command[r].value>e.length},on:{click:function(n){return t.showMore(t.command[r],e.length)}}},[n("svg-icon",{staticStyle:{"font-size":"20px","margin-top":"10px",fill:"#8590A6"},attrs:{type:"drop-down"}})],1):t._e(),t._v(" "),t.command[r].showButton&&t.command[r].buttonText&&5!==t.threadType&&6!==t.threadType?n("button",{on:{click:function(e){return t.onClick(t.command,r)}}},[n("svg-icon",{staticStyle:{"font-size":"16px",fill:"white","margin-right":"10px"},attrs:{type:t.command[r].icon}}),t._v(" "),n("span",[t._v(t._s(t.command[r].buttonText))])],1):t._e()])})),0)}),[],!1,null,"348686fe",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(9),n(24);var r=n(32),o=n.n(r),c=n(65),l=n.n(c),d=n(84),h=n.n(d),m=n(1),f=n.n(m),v=n(45),_=n.n(v),y={name:"QaActions",mixins:[o.a,l.a,h.a,f.a,_.a],props:{question:{type:Object,default:function(){}},questionUserId:{type:[String,Number],default:""},currentUserId:{type:[String,Number],default:""}},data:function(){return{answerType:{type:15,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的评论 ..."},editResourceShow:{showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1},answer:{text:"",imageList:[],attachedList:[]},onAnswerPublish:!1,showAnswerEditor:!1}},computed:{isQuestionUser:function(){return parseInt(this.questionUserId)===parseInt(this.currentUserId)},isBeAskedUser:function(){return parseInt(this.question.be_user_id)===parseInt(this.currentUserId)},showAnswer:function(){return 0!==this.question.is_answer&&!(!this.isBeAskedUser&&!this.isQuestionUser&&"0"===this.question.onlookerState&&this.question.onlooker_price>0)},showAnswerButton:function(){return this.isBeAskedUser&&0===this.question.is_answer},showOnLookerButton:function(){return!this.isBeAskedUser&&!this.isQuestionUser&&this.question.onlooker_unit_price>0&&!this.question.onlookerState&&1===this.question.is_answer},forums:function(){return this.$store.state.site.info.attributes||{}},siteMasterScale:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_master_scale/10:""},siteUserScale:function(){return this.siteMasterScale?1-this.siteMasterScale:""}},methods:{closeEditor:function(){this.answer.text="",this.answer.imageList=[],this.showAnswerEditor=!1},answerPublish:function(){var t=this;if(this.isLogin()&&!this.onAnswerPublish){if(!this.answer.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.answer.text.length>this.answerType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onAnswerPublish=!0;var e=this.question._jv.id,n={_jv:{type:"answer",links:{self:"questions/".concat(e,"/answer")},relationships:{}},content:this.answer.text,type:5};return this.publishPostResource(n,this.answer),this.$store.dispatch("jv/post",[n,{url:"/questions/".concat(e,"/answer")}]).then((function(e){t.postLegalityCheck(e,t.$t("topic.answerPublishSuccess")),t.$emit("answerPublished"),t.closeEditor()}),(function(e){return t.handleError(e)})).finally((function(){t.onAnswerPublish=!1}))}}}},w=(n(774),n(775),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qa"},[t.showAnswer?n("div",{staticClass:"block answer"},[n("div",{staticClass:"header"},[n("avatar-component",{attrs:{size:40,round:"",author:t.question.beUser||{}}},[t._v("\n        "+t._s(t.timerDiff(t.question.answered_at)+t.$t("topic.before"))+".. 回答\n      ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.question.onlooker_number,expression:"question.onlooker_number"}],staticClass:"counter"},[n("span",[t._v(t._s(t.question.onlooker_number+"人阅读"))]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.onlooker_number>0,expression:"question.onlooker_number > 0"}]},[t._v(", "+t._s(t.question.onlooker_number+"人已支付"))])])],1),t._v(" "),n("div",{staticClass:"answer-text content-html",domProps:{innerHTML:t._s(t.$xss(t.question.content_html))}}),t._v(" "),t.question.images&&t.question.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images"},t._l(t.question.images,(function(image,t){return n("el-image",{key:t,staticClass:"image",attrs:{"data-source":image.url,src:image.thumbUrl,alt:image.filename,fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e()]):t._e(),t._v(" "),t.showAnswerButton?n("div",{staticClass:"block"},[n("button",{on:{click:function(e){t.showAnswerEditor=!0}}},[n("svg-icon",{staticStyle:{"font-size":"15px"},attrs:{type:"question"}}),t._v(" "),n("span",[t._v(t._s(t.$t("topic.answerQuestion")))])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:parseFloat(t.question.price)>0,expression:"parseFloat(question.price) > 0"}],staticClass:"tip"},[n("span",[t._v(t._s(t.$t("topic.answerCanGet")))]),t._v(" "),n("span",{staticClass:"amount"},[t._v(" ￥"+t._s((parseFloat(t.question.price)*t.siteUserScale).toFixed(2))+" ")]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.answerTip")))]),t._v(" "),n("span",{staticClass:"amount"},[t._v("￥ "+t._s((parseFloat(t.question.onlooker_unit_price)*t.siteUserScale/2).toFixed(2))+" ")]),t._v(" "),n("span",[t._v(t._s(t.$t("post.yuan")))])])]):t._e(),t._v(" "),t.showOnLookerButton?n("div",{staticClass:"block"},[n("button",{on:{click:function(e){return t.$emit("payForAnswer")}}},[n("svg-icon",{staticStyle:{"font-size":"15px"},attrs:{type:"yuan"}}),t._v(" "),n("span",[t._v(t._s(t.$t("topic.payAmountCanWatch",{amount:t.question.onlooker_unit_price})))])],1)]):t._e(),t._v(" "),n("el-dialog",{attrs:{title:t.$t("topic.answerQuestion"),visible:t.showAnswerEditor,"destroy-on-close":"",width:"820px"},on:{"update:visible":function(e){t.showAnswerEditor=e}}},[n("editor",{staticClass:"edit-answer-editor",attrs:{"editor-style":"comment",selector:"edit-answer-editor","edit-resource-show":t.editResourceShow,"on-publish":t.onAnswerPublish,"type-information":t.answerType,post:t.answer},on:{"update:post":function(e){t.answer=e},publish:t.answerPublish}})],1)],1)}),[],!1,null,"a3c4218a",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,SvgIcon:n(11).default,Editor:n(88).default})},function(t,e,n){"use strict";n.r(e);var r=n(32),o={name:"TopicHeader",mixins:[n.n(r).a],props:{author:{type:Object,default:function(){}},thread:{type:Object,default:function(){}},managementList:{type:Array,default:function(){return[]}},beAskedUser:{type:Object,default:function(){}}},data:function(){return{isManagementDrop:!1,isReport:!1}},methods:{handleCommand:function(t){var e=t.command,n=t.item;return"toEdit"===e?this.$router.push("/thread/post?type=".concat(this.thread.type,"&operating=edit&threadId=").concat(this.thread._jv.id)):"isDeleted"===e?this.deleteConfirm(n):void this.$emit("managementSelected",n)},deleteConfirm:function(t){var e=this;this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$emit("managementSelected",t)}))},reportClick:function(){this.isReport=!0}}},c=(n(772),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[5!==t.thread.type?n("avatar-component",{attrs:{author:t.author}},[t._v("\n    "+t._s(t.$t("topic.publishAt"))+" "+t._s(t.timerDiff(t.thread.createdAt)+t.$t("topic.before"))+" ..\n    （"+t._s(t.$t("topic.editAt"))+" "+t._s(t.timerDiff(t.thread.firstPost?t.thread.firstPost.updatedAt:"")+t.$t("topic.before"))+"）\n  ")]):n("avatar-component",{attrs:{author:t.author}},[t._v("\n    "+t._s(t.timerDiff(t.thread.createdAt)+t.$t("topic.before")+"..."+t.$t("topic.to"))+"\n    "),n("nuxt-link",{staticClass:"be-ask-user",attrs:{to:"/user/"+t.beAskedUser._jv.id}},[t._v(t._s(" @"+t.beAskedUser.username))]),t._v("\n    "+t._s(" "+t.$t("topic.ask"))+"\n  ")],1),t._v(" "),n("div",{staticClass:"container-management"},[n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.managementList.length>0&&t.managementList.some((function(t){return t.canOpera})),expression:"managementList.length > 0 && managementList.some(item => item.canOpera)"}],staticClass:"dropdown",attrs:{placement:"bottom",trigger:"click"},on:{command:t.handleCommand,"visible-change":function(e){return t.isManagementDrop=e}}},[n("div",{class:{management:!0,"on-drop":t.isManagementDrop}},[n("svg-icon",{staticClass:"icon-setting",staticStyle:{"font-size":"16px"},attrs:{type:"setting"}}),t._v(" "),n("span",[t._v(" "+t._s(t.$t("topic.management"))+" ")])],1),t._v(" "),n("el-dropdown-menu",{staticStyle:{padding:"0 10px"},attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.managementList,(function(e,r){return n("el-dropdown-item",{key:r,staticStyle:{"border-bottom":"1px solid #EDEDED",width:"98px","text-align":"center"},attrs:{command:{command:e.command,item:e}}},[t._v("\n          "+t._s(e.text)+"\n        ")])})),1)],1),t._v(" "),n("div",{staticClass:"report",on:{click:t.reportClick}},[n("svg-icon",{staticClass:"icon-setting",staticStyle:{"font-size":"16px"},attrs:{type:"report"}}),t._v(" "),n("span",[t._v(t._s(t.$t("report.reportTitle")))])],1),t._v(" "),t.isReport?n("topic-report",{attrs:{"thread-id":t.thread._jv.id,type:1},on:{close:function(e){t.isReport=!1}}}):t._e(),t._v(" "),t.thread.isEssence?n("div",{staticClass:"essence"},[n("svg-icon",{staticStyle:{"font-size":"25px"},attrs:{type:"essence"}})],1):t._e()],1)],1)}),[],!1,null,"1e51a23a",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,SvgIcon:n(11).default,TopicReport:n(376).default})},function(t,e,n){"use strict";n.r(e);n(24);var time=n(21),r={filters:{formatDate:function(t){return Object(time.b)(t)}},props:{userId:{type:[String,Number],default:""},item:{type:Object,default:function(){}}},data:function(){return{}},methods:{showChatBox:function(){this.$emit("show-chat-box",this.item)}}},o=(n(683),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-container"},[t.item.sender&&+t.item.sender_user_id!=+t.userId?n("div",{staticClass:"avatar"},[n("avatar",{attrs:{user:{id:t.item.sender.id,username:t.item.sender.username,avatarUrl:t.item.sender.avatarUrl,isReal:t.item.sender.isReal},size:50}}),t._v(" "),null===t.item.recipient_read_at?n("div",{staticClass:"red-dot"}):t._e()],1):t._e(),t._v(" "),t.item.recipient&&+t.item.recipient_user_id!=+t.userId?n("div",{staticClass:"avatar"},[n("avatar",{attrs:{user:{id:t.item.recipient.id,username:t.item.recipient.username,avatarUrl:t.item.recipient.avatarUrl,isReal:t.item.recipient.isReal},size:50}}),t._v(" "),null===t.item.sender_read_at?n("div",{staticClass:"red-dot"}):t._e()],1):t._e(),t._v(" "),n("div",{staticClass:"detail"},[n("div",{staticClass:"top"},[+t.item.sender_user_id!=+t.userId?[t.item.sender&&t.item.sender.username?n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+t.item.sender.id}},[t._v(t._s(t.item.sender.username)+"\n          "),t.item.sender.groups&&t.item.sender.groups.length>0&&t.item.sender.groups[0].isDisplay?n("span",{staticClass:"text"},[t._v("("+t._s(t.item.sender.groups[0].name)+")")]):t._e()]):t._e(),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("notice.chat")))])]:t._e(),t._v(" "),+t.item.recipient_user_id!=+t.userId?[t.item.recipient&&t.item.recipient.username?n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+t.item.recipient.id}},[t._v(t._s(t.item.recipient.username)+"\n          "),t.item.recipient.groups&&t.item.recipient.groups.length>0&&t.item.recipient.groups[0].isDisplay?n("span",{staticClass:"text"},[t._v("("+t._s(t.item.recipient.groups[0].name)+")")]):t._e()]):t._e(),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("notice.chat")))])]:t._e(),t._v(" "),n("div",{staticClass:"time"},[t._v("\n        "+t._s(t._f("formatDate")(t.item.dialogMessage?t.item.dialogMessage.created_at:t.item.created_at))+"\n      ")])],2),t._v(" "),n("div",{staticClass:"post-content",domProps:{innerHTML:t._s(t.$xss(t.item.dialogMessage&&t.item.dialogMessage.summary))},on:{click:t.showChatBox}})])])}),[],!1,null,"1aa197da",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),c=n(32),l={mixins:[n.n(c).a,o.a],props:{item:{type:Object,default:function(){}}},data:function(){return{typeMap:{related:this.$t("notice.relatedMe"),replied:this.$t("notice.repliedMe"),liked:this.$t("notice.likedMe"),rewarded:this.$t("notice.rewardedMe"),payMe:this.$t("notice.payMe"),registerScale:this.$t("notice.registerScale"),rewardScale:this.$t("notice.rewardScale"),payScale:this.$t("notice.payScale"),system:this.$t("notice.system"),questions:this.$t("notice.questions"),watchedMe:this.$t("notice.watchedMe"),payedMe:this.$t("notice.payedMe"),answersMe:this.$t("notice.answersMe"),questioned:this.$t("notice.questions")}}},methods:{}},d=(n(684),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notice-item"},[n("div",{staticClass:"avatar"},["system"===t.item.type?n("div",{staticClass:"system-avatar"},[n("svg-icon",{staticClass:"icon",attrs:{type:"system-notice"}})],1):n("avatar",{attrs:{user:{id:t.item.user_id,username:t.item.user_name,avatarUrl:t.item.user_avatar},size:50}})],1),t._v(" "),n("div",{staticClass:"detail"},[n("div",{staticClass:"top"},["system"!==t.item.type?[t.item.user_name?n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+t.item.user_id}},[t._v(t._s(t.item.user_name)+"\n        ")]):t._e(),t._v(" "),n("span",{staticClass:"text"},["questioned"===t.item.type?[0===t.item.is_answer?[t._v("\n              "+t._s(t.$t("notice.questions"))+"\n            ")]:t._e(),t._v(" "),1===t.item.is_answer?[t._v("\n              "+t._s(t.$t("notice.answersMe"))+"\n            ")]:t._e()]:"rewarded"===t.item.type?[t.item.isScale?[t._v("\n              "+t._s(1===t.item.order_type?t.typeMap.registerScale:2===t.item.order_type?t.typeMap.rewardScale:3===t.item.order_type?t.typeMap.payScale:t.typeMap[t.item.type])+"\n            ")]:3===t.item.order_type?[t._v(t._s(t.typeMap.payMe))]:5===t.item.order_type?[t._v(t._s(t.typeMap.questions))]:6===t.item.order_type?[t._v(t._s(t.typeMap.watchedMe))]:[t._v(t._s(t.typeMap[t.item.type]))]]:[t._v(t._s(t.typeMap[t.item.type]))]],2)]:t._e(),t._v(" "),t.item.title&&"system"===t.item.type?n("div",{staticClass:"user-name"},[t._v(t._s(t.item.title))]):t._e(),t._v(" "),n("div",{staticClass:"time"},[t._v(t._s(t.timerDiff(t.item.created_at)+t.$t("topic.before")))])],2),t._v(" "),t.item.post_content?n("nuxt-link",{staticClass:"post-content",attrs:{to:"/thread/comment?threadId="+t.item.thread_id+"&commentId="+(0!==t.item.reply_post_id?t.item.reply_post_id:t.item.post_id)},domProps:{innerHTML:t._s(t.$xss(t.item.post_content))}}):t._e(),t._v(" "),t.item.answer_content?n("nuxt-link",{staticClass:"post-content",attrs:{to:"/thread/"+t.item.thread_id},domProps:{innerHTML:t._s(t.$xss(t.item.answer_content))}}):t._e(),t._v(" "),(t.item.thread_title||t.item.content)&&"system"!==t.item.type?n("nuxt-link",{staticClass:"thread",attrs:{to:"/thread/"+t.item.thread_id,target:"_blank"}},[n("div",{staticClass:"thread-user-name"},[t._v(t._s(t.item.thread_username)+":")]),t._v(" "),n("div",{staticClass:"thread-title"},[t.item.thread_title?n("div",{domProps:{innerHTML:t._s(t.$xss(t.item.thread_title))}}):t.item.content?n("div",{domProps:{innerHTML:t._s(t.$xss(t.item.content))}}):t._e()]),t._v(" "),n("div",{staticClass:"to-detail"},[t._v(t._s(t.$t("notice.toDetail")))])]):t._e(),t._v(" "),"system"===t.item.type?n("div",{staticClass:"post-content",domProps:{innerHTML:t._s(t.$xss(t.item.content))}}):t._e(),t._v(" "),"withdrawal"===t.item.type?n("div",{staticClass:"thread"},[2===t.item.cash_status?[t._v(t._s(t.$t("notice.approved")))]:t._e(),t._v(" "),3===t.item.cash_status?[t._v(t._s(t.$t("notice.unapproved")))]:t._e()],2):t._e(),t._v(" "),"withdrawal"===t.item.type&&t.item.cash_actual_amount?n("div",{staticClass:"amount green"},[t._v("\n      - "+t._s(t.$t("post.yuanItem")+t.item.cash_actual_amount)+"\n    ")]):t._e(),t._v(" "),"rewarded"===t.item.type&&t.item.amount?n("div",{staticClass:"amount"},[t._v("\n      + "+t._s(t.$t("post.yuanItem")+t.item.amount)+"\n    ")]):t._e()],1)])}),[],!1,null,"4535b934",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var r={name:"Popover",props:{visible:{type:Boolean,default:!1}}},o=(n(706),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-popover",{attrs:{placement:"bottom","min-width":"150",value:t.visible,trigger:"manual","popper-class":"popover"},on:{hide:function(e){return t.$emit("hide-pop")}}},[t._t("pop"),t._v(" "),n("template",{slot:"reference"},[t._t("activeNode")],2)],2)],1)}),[],!1,null,null,null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);n(18);var r=n(31),o=n(1),c={name:"ShowAvatar",mixins:[n.n(o).a],props:{userId:{type:String,default:""}},data:function(){return{host:"",header:"",dialogVisible:!0,cropImageFormVisible:!1,previews:{},previewCycle:{},option:{img:"",size:1,full:!1,outputType:"png",canMove:!0,fixedBox:!0,original:!0,canMoveBox:!0,autoCrop:!0,autoCropWidth:150,autoCropHeight:150,centerBox:!1,high:!0,max:99999},show:!0,fixed:!0,fixedNumber:[1,1],downImg:"",loading:!1}},mounted:function(){this.header={authorization:"Bearer ".concat(localStorage.getItem("access_token"))}},methods:{handleClose:function(t){var e=this;this.$confirm("确认关闭？").then((function(){t(),e.$emit("change",e.dialogVisible)})).catch((function(){}))},handleClose2:function(){this.dialogVisible=!1,this.$emit("change",this.dialogVisible)},uploadPhoto:function(){this.$refs.photoFile.click()},selectChange:function(t){var e=t.raw;this.fileChange(e)},fileChange:function(t){var e=t;if(/.(png|jpg|jpeg|JPG|JPEG)$/.test(e.name)){var n=new FileReader;n.readAsDataURL(e);var r=this;n.onload=function(){var t=this.result;r.$nextTick((function(){r.pageImage=t,r.option.img=t,r.cropImageFormVisible=!0}))}}else this.$message({message:"请选择符合格式要求的图片",type:"warning"}),this.$refs.photoFile.value=""},realTime:function(data){this.previews=data,this.previewCycle={width:"".concat(this.previews.w,"px"),height:"".concat(this.previews.h,"px"),overflow:"hidden",margin:"0",zoom:.66666666666}},down:function(){var t=this;this.$refs.cropper.getCropBlob((function(data){t.downImg=data,t.$refs.photoFile.submit(),t.loading=!0}))},httpRequest:function(t){var e=this,n=t.action,data=t.data,o=t.filename,c=new FormData;for(var l in data)c.append(l,data[l]);c.append(o,this.downImg,data.fileName),Object(r.a)({url:n,method:"post",data:c,timeout:2e8}).then((function(t){t&&(e.loading=!1,e.$message.success("图片上传成功"),e.dialogVisible=!1,e.$emit("change",e.dialogVisible))}),(function(t){e.loading=!1,e.handleError(t)}))}}},l=(n(711),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"showAvatar"},[n("el-dialog",{attrs:{title:"头像",visible:t.dialogVisible,width:"620px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticClass:"container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.cropImageFormVisible,expression:"!cropImageFormVisible"}],staticStyle:{top:"40%",display:"inline-block",position:"relative","z-index":"999"}},[n("el-upload",{ref:"photoFile",attrs:{action:t.host+"/users/"+t.userId+"/avatar",headers:t.header,accept:"image/*",data:{type:1,order:1},name:"avatar","show-file-list":!1,"auto-upload":!1,"on-change":t.selectChange,"http-request":t.httpRequest}},[n("el-button",[t._v(t._s(t.$t("profile.showavatar")))])],1),t._v(" "),n("p",{staticClass:"uptext"},[t._v("\n          "+t._s(t.$t("profile.supportupload"))+"\n          "),n("span",[t._v(t._s(t.$t("profile.jpgorpng"))+" ")]),t._v(" "+t._s(t.$t("profile.filemost"))+" "),n("span",[t._v("500kb")])])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.cropImageFormVisible,expression:"cropImageFormVisible"}],staticClass:"imgCrop-content"},[n("div",{staticClass:"cropper-content"},[n("VueCropper",{ref:"cropper",attrs:{img:t.option.img,"output-size":t.option.size,"output-type":t.option.outputType,info:!0,full:t.option.full,fixed:t.fixed,"fixed-number":t.fixedNumber,"can-move":t.option.canMove,"can-move-box":t.option.canMoveBox,"fixed-box":t.option.fixedBox,original:t.option.original,"auto-crop":t.option.autoCrop,"auto-crop-width":t.option.autoCropWidth,"auto-crop-height":t.option.autoCropHeight,"center-box":t.option.centerBox,high:t.option.high,mode:"cover","max-img-size":t.option.max},on:{"real-time":t.realTime}})],1)])]),t._v(" "),n("div",{staticClass:"show-preview",style:{width:t.previews.w+"px",height:t.previews.h+"px",overflow:"hidden",display:"inline-block",position:"absolute","margin-left":"17px","margin-top":"7px"}},[n("div",{staticClass:"preview",style:t.previews.div},[n("img",{style:t.previews.img,attrs:{src:t.previews.url}})])]),t._v(" "),n("div",{staticClass:"show-preview",style:{width:"100px",height:"100px",overflow:"hidden",display:"inline-block",position:"absolute","margin-left":"17px","border-radius":"50%",top:"51%"}},[n("div",{staticClass:"preview",style:t.previewCycle},[n("img",{style:t.previews.img,attrs:{src:t.previews.url}})])]),t._v(" "),n("div",{staticClass:"preview2"},[n("div",{staticClass:"square"},[n("span",{staticClass:"squarep"},[t._v(t._s(t.$t("profile.px1")))])]),t._v(" "),n("div",{staticClass:"circle"},[n("span",{staticClass:"squarep"},[t._v(t._s(t.$t("profile.px2")))])]),t._v(" "),n("div",{staticClass:"pre-button"},[n("el-button",{staticClass:"btnw",attrs:{type:"primary",size:"small"},on:{click:t.down}},[t._v(t._s(t.$t("profile.avataruse")))]),t._v(" "),n("el-button",{staticClass:"btnw",attrs:{size:"small"},on:{click:t.handleClose2}},[t._v(t._s(t.$t("profile.avatarcancel")))])],1)])])],1)}),[],!1,null,"88c32118",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r={name:"VerifyPhone",props:{error:{type:Boolean,default:!1},passwordErrorTip:{type:String,default:""},mobile:{type:String,default:""}},data:function(){return{}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){this.$emit("sendsms")},methods:{empty:function(){this.$refs.walletinput.deleat()},findpaypwd:function(){this.$emit("close"),this.$emit("findpaypwd")}}},o=(n(712),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("modify.authontitle")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s("请收入手机 "+t.mobile+" 的验证码"))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.editphonewordtip")))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("wallet-password-input",{ref:"walletinput",attrs:{error:t.error},on:{password:function(e){return t.$emit("password",e)}}}),t._v(" "),t.error?n("div",{staticClass:"amount"},[t._v(t._s(t.passwordErrorTip?t.passwordErrorTip:t.$t("core.sms_verify_error")))]):t._e()],1)])])}),[],!1,null,"21473e82",null);e.default=component.exports;installComponents(component,{WalletPasswordInput:n(91).default,Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r=n(49),time=n(21),o=n(1),c={filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[n.n(o).a],props:{item:{type:Object,default:function(){}},showShare:{type:Boolean,default:!0}},data:function(){return{loading:!1,showVideoPop:!1,showViewer:!1}},computed:{thread:function(){return this.item&&this.item.lastThread&&this.item.lastThread.length>0&&this.item.lastThread[0]||{}},unpaid:function(){return this.thread&&!(this.thread.paid||0===parseFloat(this.thread.price))}},methods:{toDetail:function(){this.canViewPostsFn()&&this.routerLink()},onClickImage:function(){this.thread&&!this.thread.unpaid||!this.canViewPostsFn()||this.routerLink()},openVideo:function(){this.canViewPostsFn()&&(this.thread&&this.thread.unpaid?this.routerLink():this.showVideoPop=!0)},routerLink:function(){window.open("/thread/".concat(this.thread&&this.thread._jv&&this.thread._jv.id),"_blank")},onClickContent:function(t){var e=t||window.event;"a"!==(e.target||e.srcElement).nodeName.toLocaleLowerCase()&&this.toDetail()},canViewPostsFn:function(){return!(this.thread&&!this.thread.canViewPosts)||(this.$message.error(this.$t("home.noPostingTopic")),!1)},formatTopicHTML:function(html){return r.a.parse(html)}}},l=(n(753),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-container"},[n("div",{staticClass:"main-cont"},[n("div",{staticClass:"top-flex"},[n("div",{staticClass:"topic-title"},[t._v("\n        #"),n("span",{staticClass:"topic-name"},[t._v(t._s(t.item.content))]),t._v("#\n        "),1===t.item.recommended?n("svg-icon",{attrs:{type:"recommend"}}):t._e()],1),t._v(" "),n("div",{staticClass:"view-count"},[t._v(t._s(t.$t("home.topicViewCount",{total:t.item.view_count})))])]),t._v(" "),t.thread&&t.thread.firstPost?[n("div",{staticClass:"first-post",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},[n("div",{on:{click:t.onClickContent}},[n("div",{staticClass:"content"},[n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:parseFloat(t.thread.price)>0,expression:"parseFloat(thread.price) > 0"}],staticClass:"icon-pay-yuan",attrs:{type:"pay-yuan"}}),t._v(" "),n("div",{class:{"content-block":parseFloat(t.thread.price)>0},domProps:{innerHTML:t._s(t.$xss(t.formatTopicHTML(t.thread.firstPost.summary)))}})],1)]),t._v(" "),t.thread?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{ url: 'data-source' }"}],staticClass:"images",on:{click:function(e){return e.target!==e.currentTarget?null:t.toDetail(e)}}},t._l(t.thread.firstPost.images.slice(0,3),(function(image,e){return n("el-image",{key:e,staticClass:"image",attrs:{src:image.thumbUrl,"data-source":t.unpaid?"":image.url,alt:image.filename,fit:"cover",lazy:""},on:{click:function(e){return e.target!==e.currentTarget?null:t.onClickImage(e)}}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e(),t._v(" "),t.thread.firstPost.images&&t.thread.firstPost.images.length>3?n("div",{staticClass:"image-count",on:{click:t.toDetail}},[t._v("\n          "+t._s(t.$t("home.total"))+" "+t._s(t.thread.firstPost.images.length)+"\n          "+t._s(t.$t("home.seeAllImage"))+"\n        ")]):t._e()])]:t._e(),t._v(" "),n("div",{staticClass:"thread-count"},[t._v(t._s(t.$t("home.topicCount",{total:t.item.thread_count})))])],2)])}),[],!1,null,"6e2cb1f4",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={name:"WalletPassword",props:{error:{type:Boolean,default:!1},passwordErrorTip:{type:String,default:""}},data:function(){return{}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},methods:{empty:function(){this.$refs.walletinput.deleat()},findpaypwd:function(){this.$emit("close"),this.$emit("findpaypwd")}}},o=(n(718),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("profile.editpaypassword")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("profile.orignpassword")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.editpasswordtip")))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("wallet-password-input",{ref:"walletinput",attrs:{error:t.error},on:{password:function(e){return t.$emit("password",e)}}}),t._v(" "),t.error?n("div",{staticClass:"amount"},[t._v(t._s(t.passwordErrorTip?t.passwordErrorTip:t.$t("modify.passwordinputerro")))]):t._e()],1),t._v(" "),t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms?n("div",{staticClass:"findpaypwd",on:{click:t.findpaypwd}},[t._v("\n      "+t._s(t.$t("modify.forgetpaypassword"))+"\n    ")]):t._e()])])}),[],!1,null,"4117cfc2",null);e.default=component.exports;installComponents(component,{WalletPasswordInput:n(91).default,Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r={name:"SetNewpasword",props:{error:{type:Boolean,default:!1}},data:function(){return{}}},o=(n(719),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("profile.editpaypassword")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("modify.newPayPwdTitle")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.setpasswordtip")))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("wallet-password-input",{attrs:{error:t.error},on:{password:function(e){return t.$emit("password",e)}}})],1)])])}),[],!1,null,"6ab3500c",null);e.default=component.exports;installComponents(component,{WalletPasswordInput:n(91).default,Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r={name:"Repeatnewpassword",props:{error:{type:Boolean,default:!1}},data:function(){return{}},methods:{empty:function(){this.$refs.walletinput.deleat()}}},o=(n(720),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("profile.editpaypassword")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("modify.enterpaymentagin")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.repeatpasstip")))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("wallet-password-input",{ref:"walletinput",attrs:{error:t.error},on:{password:function(e){return t.$emit("password",e)}}}),t._v(" "),t.error?n("div",{staticClass:"amount"},[t._v(t._s(t.$t("modify.reenter")))]):t._e()],1)])])}),[],!1,null,"b19126fe",null);e.default=component.exports;installComponents(component,{WalletPasswordInput:n(91).default,Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r={name:"WalletPassword",props:{error:{type:Boolean,default:!1}},data:function(){return{}}},o=(n(721),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("profile.setpaypassword")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("profile.setpaypassword")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.setpasswordtip")))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("wallet-password-input",{attrs:{error:t.error},on:{password:function(e){return t.$emit("password",e)}}})],1)])])}),[],!1,null,"1ab54731",null);e.default=component.exports;installComponents(component,{WalletPasswordInput:n(91).default,Message:n(58).default})},function(t,e,n){"use strict";n.r(e);var r={name:"SetNewpasword",props:{error:{type:Boolean,default:!1}},data:function(){return{}},methods:{empty:function(){this.$refs.walletinput.deleat()}}},o=(n(722),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("profile.editpaypassword")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("modify.enterpaymentagin")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.repeatpasstip")))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("wallet-password-input",{ref:"walletinput",attrs:{error:t.error},on:{password:function(e){return t.$emit("password",e)}}}),t._v(" "),t.error?n("div",{staticClass:"amount"},[t._v(t._s(t.$t("modify.masstext")))]):t._e()],1)])])}),[],!1,null,"541f4f0e",null);e.default=component.exports;installComponents(component,{WalletPasswordInput:n(91).default,Message:n(58).default})},function(t,e,n){"use strict";n.r(e);n(28),n(9),n(51);var r=n(13),o=n(21),c=n(1),l={mixins:[n.n(c).a],data:function(){return{loading:!1,hasMore:!1,date:"",value:"",pageSize:10,pageNum:1,filterSelected:"",dataList:[],total:0,sumMoney:0,options:[{value:"",label:this.$t("profile.all")+this.$t("profile.type")},{value:"1",label:this.$t("profile.tobereviewed")},{value:"2",label:this.$t("profile.approved")},{value:"3",label:this.$t("profile.auditfailed")},{value:"4",label:this.$t("profile.paymenttobemade")},{value:"5",label:this.$t("profile.paymentsucceed")},{value:"6",label:this.$t("profile.paymentfailed")}],userId:this.$store.getters["session/get"]("userId"),userInfo:""}},mounted:function(){this.setCurrentTime(),this.getUserInfo(),this.getList()},methods:{setCurrentTime:function(){var t=window.currentTime||new Date,e=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0".concat(n):n,this.date="".concat(e,"-").concat(n)},getUserInfo:function(){this.userInfo=this.$store.state.user.info.attributes},getList:function(t){var e=this;this.loading=!0;var n=this.date.split("-"),o=new Date(n[0],n[1],0).getDate(),c={"filter[user]":this.userId,"page[number]":this.pageNum2,"page[limit]":this.pageSize2,"filter[start_time]":"".concat(this.date,"-01-00-00-00"),"filter[end_time]":"".concat(this.date,"-").concat(o,"-00-00-00")};t&&"filter"===t&&(c.pageNum=1,this.dataList=[]),""!==this.filterSelected&&(c["filter[cash_status]"]=this.filterSelected),r.b.run((function(){return e.$store.dispatch("jv/get",["wallet/cash",{params:c}])})).then((function(t){e.sumMoney=e.handlemoney(t),e.dataList=t,e.total=t._jv.json.meta.total}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},bindDateChange:function(t){this.date=t,null!==this.date&&this.getList("filter")},confirm:function(t){this.filterSelected=t,this.getList("filter")},handleSelectionChange:function(t){this.multipleSelection=t},dateFormat:function(t){return this.timeHandle(t.created_at)},timeHandle:function(time){return Object(o.b)(time)},statusFormat:function(t){switch(t.cash_status){case 1:return'<font style="color:#25A9F6">'.concat(this.$t("profile.tobereviewed"),"</font>");case 2:return'<font style="color:#09BB07">'.concat(this.$t("profile.approved"),"</font>");case 3:return'<font style="color:#FA5151">'.concat(this.$t("profile.auditfailed"),"</font>");case 4:return this.$t("profile.paymenttobemade");case 5:return this.$t("profile.paymentsucceed");case 6:return this.$t("profile.paymentfailed");default:return"未知状态"}},statusFormat2:function(t){switch(t.cash_status){case 1:return this.$t("profile.tobereviewed");case 2:return this.$t("profile.approved");case 3:return this.$t("profile.auditfailed");case 4:return this.$t("profile.paymenttobemade");case 5:return this.$t("profile.paymentsucceed");case 6:return this.$t("profile.paymentfailed");default:return"未知状态"}},handlemoney:function(t){var e=JSON.parse(JSON.stringify(t)),n=0;return e.forEach((function(t,r){e[r]=parseFloat(t.cash_apply_amount.replace(/\+|\-|\*|\?/g,"")),n+=e[r]})),n.toFixed(2)},handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getList()},handleCurrentChange:function(t){this.pageNum=t,this.getList()}}},d=(n(725),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cashDialog"},[n("div",{staticClass:"selector"},[n("el-date-picker",{attrs:{type:"month",placeholder:"选择月","suffix-icon":"el-icon-arrow",format:"yyyy 年 MM 月 ","value-format":"yyyy-MM"},on:{change:t.bindDateChange},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("profile.pleaseselect")},on:{change:t.confirm},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("span",{staticClass:"margleft"},[t._v("\n      "+t._s(t.$t("profile.total"))+t._s(t.total)+t._s(t.$t("profile.records"))+"\n      ")])],1),t._v(" "),t.total>0?n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),n("el-table-column",{attrs:{prop:"id",label:"ID",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"cash_status",label:t.$t("profile.desc"),formatter:t.statusFormat2},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"desc",domProps:{innerHTML:t._s(t.$xss(t.statusFormat2(e.row)))}})]}}],null,!1,5723653)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.time"),width:"140",prop:"created_at",formatter:t.dateFormat}}),t._v(" "),n("el-table-column",{attrs:{prop:"cash_status",label:t.$t("profile.status"),width:"97",formatter:t.statusFormat},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{domProps:{innerHTML:t._s(t.$xss(t.statusFormat(e.row)))}})]}}],null,!1,3765784326)}),t._v(" "),n("el-table-column",{attrs:{prop:"cash_apply_amount",label:t.$t("pay.sumOfMoney"),width:"113",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"font-size":"16px"},domProps:{innerHTML:t._s(t.$xss(e.row.cash_apply_amount))}})]}}],null,!1,4017059246)})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):[t.hasMore?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v(t._s(t.$t("topic.showMore")))]):n("div",{staticClass:"no-more"},[0===t.dataList.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v(t._s(t.dataList.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,"5666eed9",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(9);var r=n(21),o=n(1),c={mixins:[n.n(o).a],data:function(){return{loading:!1,hasMore:!1,value:"",pageSize3:10,pageNum3:1,freeze_amount:"",filterSelected3:"",freezelist:[],total3:0,userId:this.$store.getters["session/get"]("userId"),userInfo:"",walletFreeze:0}},mounted:function(){this.getUserInfo(),this.getFreezelist()},methods:{getUserInfo:function(){this.userInfo=this.$store.state.user.info.attributes,this.walletFreeze=this.userInfo?this.userInfo.walletFreeze:0},confirm3:function(t){this.filterSelected3=t,this.getFreezelist("filter")},amountFormat:function(t){return t.amount>0?'<font color="09BB07">-￥'.concat(t.amount,"</font>"):t>0?'<font color="09BB07">+￥'.concat(t,"</font>"):'<font style="color:#FA5151">-￥'.concat(t.substr(1),"</font>")},getFreezelist:function(){var t=this;this.loading=!0;var e={"filter[user]":this.userId,"filter[change_type]":"10,11,12,81,9,8","page[number]":this.pageNum3,"page[limit]":this.pageSize3};this.$store.dispatch("jv/get",["wallet/log",{params:e}]).then((function(e){t.total3=e._jv.json.meta.total,t.freezelist=e}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},sortAmount:function(t,e){return 1*t.change_available_amount-1*e.change_available_amount},dateFormat:function(t){return this.timeHandle(t.created_at)},timeHandle:function(time){return Object(r.b)(time)},handleSizeChange3:function(t){this.pageNum3=1,this.pageSize3=t,this.getFreezelist()},handleCurrentChange3:function(t){this.pageNum3=t,this.getFreezelist()}}},l=(n(726),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"freezeAmount"},[t.total3>0?n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.freezelist}},[n("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),n("el-table-column",{attrs:{prop:"id",label:"ID",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"change_desc",label:t.$t("profile.desc")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"desc"},[t._v(t._s(e.row.change_desc))])]}}],null,!1,2123072729)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.time"),width:"140",prop:"created_at",formatter:t.dateFormat}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("pay.sumOfMoney"),width:"113",sortable:"","sort-method":t.sortAmount},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"font-size":"16px"},domProps:{innerHTML:t._s(t.$xss(t.amountFormat(e.row.change_freeze_amount)))}})]}}],null,!1,646571392)})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"","pager-count":5,"current-page":t.pageNum3,"page-sizes":[10,20,30,40],"page-size":t.pageSize3,layout:"total, sizes, prev, pager, next, jumper",total:t.total3},on:{"size-change":t.handleSizeChange3,"current-change":t.handleCurrentChange3}})],1):[t.hasMore?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v(t._s(t.$t("topic.showMore")))]):n("div",{staticClass:"no-more"},[0===t.freezelist.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v(t._s(t.freezelist.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,"0394c45c",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(28),n(9),n(51);var r=n(13),o=n(21),c=n(1),l={mixins:[n.n(c).a],data:function(){return{loading:!1,hasMore:!1,value:"",pageSize2:10,pageNum2:1,date2:"",filterSelected2:"",dataList2:[],total2:0,sumMoney2:0,userId:this.$store.getters["session/get"]("userId"),options2:[{value:"",label:this.$t("profile.all")+this.$t("profile.type")},{value:"10",label:this.$t("profile.withdrawalfreeze")},{value:"11",label:this.$t("profile.withdrawalsucceed")},{value:"12",label:this.$t("profile.withdrawalunfreeze")},{value:"30",label:this.$t("profile.registeredincome")},{value:"31",label:this.$t("profile.rewardincome")},{value:"32",label:this.$t("profile.laborincome")},{value:"50",label:this.$t("profile.laborexpenditure")},{value:"60,62,63",label:this.$t("profile.payincome")},{value:"35,36",label:this.$t("profile.answerincome")},{value:"81,82",label:this.$t("profile.answerpay")}]}},mounted:function(){this.setCurrentTime(),this.getList2()},methods:{setCurrentTime:function(){var t=window.currentTime||new Date,e=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0".concat(n):n,this.date2="".concat(e,"-").concat(n)},sortAmount:function(t,e){return 1*t.change_available_amount-1*e.change_available_amount},timeHandle:function(time){return Object(o.b)(time)},statusFormat2:function(t){switch(t.change_type){case 10:return this.$t("profile.withdrawalfreeze");case 11:return this.$t("profile.withdrawalsucceed");case 12:return this.$t("profile.withdrawalunfreeze");case 30:return this.$t("profile.registeredincome");case 31:return this.$t("profile.rewardincome");case 32:return this.$t("profile.laborincome");case 50:return this.$t("profile.laborexpenditure");case 41:return this.$t("profile.givearewardforthetheme");case 60:return this.$t("profile.threadpayincome");case 61:return this.$t("profile.threadpay");case 81:return this.$t("profile.threadanswerpay");case 8:return this.$t("profile.answerfreeze");case 52:return this.$t("profile.filepay");case 35:return this.$t("profile.answersincome");case 36:return this.$t("profile.answersaroundincome");case 82:return this.$t("profile.answersaroundpay");default:return"未知状态"}},amountFormat:function(t){return t.amount>0?'<font color="09BB07">-￥'.concat(t.amount,"</font>"):t>0?'<font color="#FA5151">+￥'.concat(t,"</font>"):'<font style="color:#09BB07">-￥'.concat(t.substr(1),"</font>")},dateFormat:function(t){return this.timeHandle(t.created_at)},bindDateChange2:function(t){this.date2=t,null!==this.date2&&this.getList2("filter")},confirm2:function(t){this.filterSelected2=t,this.getList2("filter")},getList2:function(t){var e=this;this.loading=!0;var n=this.date2.split("-"),o=new Date(n[0],n[1],0).getDate(),c={include:"user,order.user,order.thread,order.thread.firstPost","filter[user]":this.userId,"page[number]":this.pageNum2,"page[limit]":this.pageSize2,"filter[change_type_exclude]":"11,81","filter[start_time]":"".concat(this.date2,"-01-00-00-00"),"filter[end_time]":"".concat(this.date2,"-").concat(o,"-00-00-00")};t&&"filter"===t&&(c.pageNum2=1,this.dataList2=[]),this.filterSelected2&&(c["filter[change_type]"]=this.filterSelected2),r.b.run((function(){return e.$store.dispatch("jv/get",["wallet/log",{params:c}])})).then((function(t){var n=e.handleHandle(t);e.sumMoney2=e.handlemoney2(n),e.dataList2=n,e.total2=t._jv.json.meta.total}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},handlemoney2:function(t){var e=JSON.parse(JSON.stringify(t)),n=0;return e.forEach((function(t,r){e[r]=parseFloat(t.change_available_amount.replace(/\+|\-|\*|\?/g,"")),n+=e[r]})),n.toFixed(2)},handleHandle:function(t){var e=this,n=JSON.parse(JSON.stringify(t));return n.forEach((function(t,r){var desc=e.handleTitle(t);desc.length>42&&(desc="".concat(desc.substr(0,42),"...")),n[r].change_desc=desc})),n},handleTitle:function(t){switch(t.change_type){case 31:var e=t.order.user?t.order.user.username:this.$t("profile.theuserwasdeleted"),n=t.order.thread?t.order.thread.firstPost.summary.replace(/(<([^>]+)>)/gi,""):this.$t("profile.thethemewasdeleted");return"".concat(e," ").concat(this.$t("profile.givearewardforyourtheme")," ").concat(n);case 41:var r=t.order.thread?t.order.thread.firstPost.summary.replace(/(<([^>]+)>)/gi,""):this.$t("profile.thethemewasdeleted");return"".concat(this.$t("profile.givearewardforthetheme")," ").concat(r);case 60:var o=t.order.user?t.order.user.username:this.$t("profile.theuserwasdeleted"),c=t.order.thread?t.order.thread.firstPost.summary.replace(/(<([^>]+)>)/gi,""):this.$t("profile.givearewardforthetheme");return"".concat(o," ").concat(this.$t("profile.paidtoseeyourtheme")," ").concat(c);case 61:var l=t.order.thread?t.order.thread.firstPost.summary.replace(/(<([^>]+)>)/gi,""):this.$t("profile.thethemewasdeleted");return"".concat(this.$t("profile.paidtoview")," ").concat(l);default:return t.change_desc}},handleSizeChange2:function(t){this.pageNum2=1,this.pageSize2=t,this.getList2()},handleCurrentChange2:function(t){this.pageNum2=t,this.getList2()}}},d=(n(727),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"walletDetail"},[n("div",{staticClass:"selector"},[n("el-date-picker",{attrs:{type:"month",placeholder:"选择月","suffix-icon":"el-icon-arrow",format:"yyyy 年 MM 月 ","value-format":"yyyy-MM"},on:{change:t.bindDateChange2},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}}),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("profile.pleaseselect")},on:{change:t.confirm2},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options2,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("span",{staticClass:"margleft"},[t._v("\n      "+t._s(t.$t("profile.total"))+t._s(t.total2)+t._s(t.$t("profile.records"))+"\n      ")])],1),t._v(" "),t.total2>0?n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.dataList2}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"change_desc",label:t.$t("profile.desc")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"desc"},[t._v(t._s(e.row.change_desc))])]}}],null,!1,2123072729)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.time"),width:"140",prop:"created_at",formatter:t.dateFormat}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.status"),width:"105",formatter:t.statusFormat2}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("pay.sumOfMoney"),width:"113",sortable:"","sort-method":t.sortAmount},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"font-size":"16px"},domProps:{innerHTML:t._s(t.$xss(t.amountFormat(e.row.change_available_amount)))}})]}}],null,!1,94768466)})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"","pager-count":5,"current-page":t.pageNum2,"page-sizes":[10,20,30,40],"page-size":t.pageSize2,layout:"total, sizes, prev, pager, next, jumper",total:t.total2},on:{"size-change":t.handleSizeChange2,"current-change":t.handleCurrentChange2}})],1):[t.hasMore?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v(t._s(t.$t("topic.showMore")))]):n("div",{staticClass:"no-more"},[0===t.dataList2.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v(t._s(t.dataList2.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,"ceb6d59a",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r=n(49),o=n(32),c={name:"ReplyList",mixins:[n.n(o).a],props:{replyList:{type:Array,default:function(){return[]}}},methods:{formatHtml:function(html){return html?r.a.parse(html):""}}},l=(n(745),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.replyList,(function(e,r){return n("div",{key:r,staticClass:"reply-list"},[n("div",{staticClass:"title"},[n("avatar-component",{attrs:{author:e.user,size:45}},[t._v("\n        "+t._s(t.timerDiff(e.updatedAt)+t.$t("topic.before"))+"..\n      ")]),t._v(" "),0===e.isApproved?n("div",{staticClass:"checking"},[t._v(t._s(t.$t("topic.inReview")))]):t._e()],1),t._v(" "),n("div",{staticClass:"container-detail"},[n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(t.formatHtml(e.contentHtml)))}}),t._v(" "),e.images&&e.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images"},t._l(e.images,(function(image,t){return n("el-image",{key:t,staticStyle:{width:"100px",height:"100px","border-radius":"5px","margin-right":"10px"},attrs:{src:image.thumbUrl,alt:image.filename,"data-source":image.url,fit:"cover"}})})),1):t._e(),t._v(" "),n("div",{staticClass:"actions"},[n("div",{staticClass:"left"},[e.canLike?n("span",{staticClass:"like",on:{click:function(n){return t.$emit("onLike",{reply:e,index:r})}}},[n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:e.isLiked?"liked":"like"}}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.like"))+" "+t._s(e.likeCount>0?e.likeCount:""))])],1):t._e()]),t._v(" "),e.canHide?n("div",{staticClass:"right",on:{click:function(n){return t.$emit("delete",{id:e._jv.id,type:"reply"})}}},[t._v(t._s(t.$t("topic.delete")))]):t._e()])])])})),0)}),[],!1,null,"ac70a0c6",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(28),n(9),n(51);var r=n(13),o=n(21),c=n(1),l={mixins:[n.n(c).a],data:function(){return{loading:!1,hasMore:!1,value:"",pageSize4:10,pageNum4:1,date4:"",filterSelected4:"",dataList4:[],total4:0,sumMoney4:0,userId:this.$store.getters["session/get"]("userId"),options4:[{value:"",label:this.$t("profile.all")+this.$t("profile.type")},{value:"0",label:this.$t("profile.tobepaid")},{value:"1",label:this.$t("profile.paid")},{value:"2",label:this.$t("profile.cancelorder")},{value:"3",label:this.$t("profile.payfail")},{value:"4",label:this.$t("profile.orderexpired")}]}},mounted:function(){this.setCurrentTime(),this.getList4()},methods:{setCurrentTime:function(){var t=window.currentTime||new Date,e=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0".concat(n):n,this.date4="".concat(e,"-").concat(n)},sortAmount:function(t,e){return 1*t.amount-1*e.amount},timeHandle:function(time){return Object(o.b)(time)},statusFormat4:function(t){switch(t.status){case 0:return this.$t("profile.tobepaid");case 1:return this.$t("profile.paid");case 2:return this.$t("profile.cancelorder");case 3:return this.$t("profile.payfail");case 4:return this.$t("profile.orderexpired");default:return"未知状态"}},dateFormat:function(t){return this.timeHandle(t.created_at)},amountFormat:function(t){return t.amount>0?'<font color="09BB07">-￥'.concat(t.amount,"</font>"):t>0?'<font color="09BB07">+￥'.concat(t,"</font>"):'<font style="color:#FA5151">-￥'.concat(t.substr(1),"</font>")},bindDateChange4:function(t){this.date4=t,null!==this.date4&&this.getList4("filter")},confirm4:function(t){this.filterSelected4=t,this.getList4("filter")},getList4:function(t){var e=this;this.loading=!0;var n=this.date4.split("-"),o=new Date(n[0],n[1],0).getDate(),c={include:"user,thread,thread.firstPost","filter[user]":this.userId,"page[number]":this.pageNum4,"page[limit]":this.pageSize4,"filter[start_time]":"".concat(this.date4,"-01-00-00-00"),"filter[end_time]":"".concat(this.date4,"-").concat(o,"-00-00-00")};t&&"filter"===t&&(c.pageNum4=1,this.dataList4=[]),(this.filterSelected4||0===this.filterSelected4)&&(c["filter[status]"]=this.filterSelected4),r.b.run((function(){return e.$store.dispatch("jv/get",["orders",{params:c}])})).then((function(t){var n=e.handleHandle4(t);e.sumMoney4=e.handlemoney4(n),e.dataList4=n,e.total4=t._jv.json.meta.total}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},handlemoney4:function(t){var e=JSON.parse(JSON.stringify(t)),n=0;return e.forEach((function(t,r){e[r]=parseFloat(t.amount.replace(/\+|\-|\*|\?/g,"")),n+=e[r]})),n.toFixed(2)},handleHandle4:function(t){var e=this,n=JSON.parse(JSON.stringify(t));return n.forEach((function(t,r){var desc=e.handleTitle4(t);desc.length>42&&(desc="".concat(desc.substr(0,42),"...")),n[r].titleType=desc})),n},handleTitle4:function(t){switch(t.type){case 1:return this.$t("profile.register");case 2:var e=t.thread?t.thread.firstPost.summary.replace(/(<([^>]+)>)/gi,""):this.$t("profile.thethemewasdeleted");return"".concat(this.$t("profile.givearewardforthetheme")," ").concat(e);case 3:var n=t.thread?t.thread.firstPost.summary.replace(/(<([^>]+)>)/gi,""):this.$t("profile.thethemewasdeleted");return"".concat(this.$t("profile.paidtoview")," ").concat(n);case 4:return this.$t("profile.paygroup");case 7:var r=t.thread?t.thread.title:this.$t("profile.thethemewasdeleted");return"付费查看了主题的附件 ".concat(r);case 5:var o=t.thread?t.thread.title:this.$t("profile.thethemewasdeleted");return"付费查看了问答 ".concat(o);case 6:var c=t.thread?t.thread.title:this.$t("profile.thethemewasdeleted");return"付费围观了问答 ".concat(c);default:return t.type}},handleSizeChange4:function(t){this.pageNum4=1,this.pageSize4=t,this.getList4()},handleCurrentChange4:function(t){this.pageNum4=t,this.getList4()}}},d=(n(728),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"orderDetail"},[n("div",{staticClass:"selector"},[n("el-date-picker",{attrs:{type:"month",placeholder:"选择月","suffix-icon":"el-icon-arrow",format:"yyyy 年 MM 月 ","value-format":"yyyy-MM"},on:{change:t.bindDateChange4},model:{value:t.date4,callback:function(e){t.date4=e},expression:"date4"}}),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("profile.pleaseselect")},on:{change:t.confirm4},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options4,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("span",{staticClass:"margleft"},[t._v("\n      "+t._s(t.$t("profile.total"))+t._s(t.total4)+t._s(t.$t("profile.records"))+"\n      ")])],1),t._v(" "),t.total4>0?n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.dataList4}},[n("el-table-column",{attrs:{prop:"_jv.id",label:"ID",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"titleType",label:t.$t("profile.desc")},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"desc"},[t._v(t._s(e.row.titleType))])]}}],null,!1,3085332777)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.time"),width:"140",prop:"created_at",formatter:t.dateFormat}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("profile.status"),width:"97",formatter:t.statusFormat4}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("pay.sumOfMoney"),width:"113",sortable:"","sort-method":t.sortAmount},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"font-size":"16px"},domProps:{innerHTML:t._s(t.$xss(t.amountFormat(e.row)))}})]}}],null,!1,1723755631)})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"","pager-count":5,"current-page":t.pageNum4,"page-sizes":[10,20,30,40],"page-size":t.pageSize4,layout:"total, sizes, prev, pager, next, jumper",total:t.total4},on:{"size-change":t.handleSizeChange4,"current-change":t.handleCurrentChange4}})],1):[t.hasMore?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v(t._s(t.$t("topic.showMore")))]):n("div",{staticClass:"no-more"},[0===t.dataList4.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v(t._s(t.dataList4.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,"ee3fc1f6",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(28),n(18),n(24);var r=n(13),o=n(1),c=n.n(o),l=n(82),d=n.n(l),h=n(114),m={name:"Withdrawal",mixins:[c.a,h,d.a],props:{price:{type:[Number,String],default:""},error:{type:Boolean,default:!1}},data:function(){return{userId:this.$store.getters["session/get"]("userId"),userInfo:"",name:"",balance:"",userphon:"",usertestphon:"",canAmount:"",canClick:!0,disabtype:!1,verifycode:"",content:this.$t("modify.sendVerifyCode"),percentage:0,contint:"",procedures:0,cost:0,interval:"",captcha:null,ticket:"",randstr:"",captchaResult:{},forums:"",withdrawlNumber:"",cashtype:0}},mounted:function(){this.setmydata(),this.forumsdata()},methods:{setmydata:function(){this.userInfo=this.$store.state.user.info,this.name=this.userInfo.attributes.username,this.balance=this.userInfo.attributes.walletBalance,this.usertestphon=this.userInfo.attributes.mobile,this.userphon=this.userInfo.attributes.originalMobile,this.withdrawlNumber=this.userphon,this.usertestphon||(this.disabtype=!0)},forumsdata:function(){this.forums=this.$store.state.site.info.attributes,this.cost=this.forums.set_cash.cash_rate,this.percentage=100*this.forums.set_cash.cash_rate,this.cashtype=this.forums.paycenter&&this.forums.paycenter.wxpay_mchpay_close?1:0},settlement:function(){var t=this;setTimeout((function(){if("."===t.canAmount[0]){t.canAmount="0."}if(t.canAmount=t.canAmount.replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,""),Number(t.canAmount)>Number(t.balance)&&(t.canAmount=t.canAmount.slice(0,t.canAmount.length-1),t.$message.warning(t.$t("modify.greaterthan"))),t.canAmount.length>0){t.length=!0;var e=t.canAmount-t.canAmount*t.cost;if(e){t.contint="".concat(e.toFixed(2));var n=t.canAmount*t.cost;t.procedures=n.toFixed(2)}else t.contint="",t.procedures=""}else if(t.canAmount.length<=0){t.contint="";var r=t.canAmount*t.cost;t.procedures=r.toFixed(2)}}),5)},sendsms:function(){this.forums.qcloud.qcloud_captcha?this.tcaptcha():(this.second=60,this.sendVerifyCode())},tcaptcha:function(){var t=this;this.captcha=new TencentCaptcha(this.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret&&(t.ticket=e.ticket,t.randstr=e.randstr,t.sendVerifyCode())})),this.captcha.show()},sendVerifyCode:function(){var t=this,e={_jv:{type:"sms/send"},mobile:this.userphon,type:"verify",captcha_ticket:this.ticket,captcha_rand_str:this.randstr};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e.interval&&t.countDown(e.interval),t.ticket="",t.randstr=""}),(function(e){return t.handleError(e)}))},btncash:function(){this.verifytitle()},verifytitle:function(){var t=this,e={_jv:{type:"sms/verify"},code:this.verifycode,type:"verify"};this.$store.dispatch("jv/post",e).then((function(e){e&&t.cashwithdrawal()}),(function(e){var n=e.response.data.errors;n[0]&&("422"===n[0].status?t.$message.error(n[0].detail[0]):500===n[0].status&&t.$message.error(t.$t("core.".concat(n[0].code))))}))},cashwithdrawal:function(){var t=this,e={_jv:{type:"wallet/cash",include:["user","userWallet"]},cash_apply_amount:this.canAmount,cash_mobile:this.withdrawlNumber,cash_type:this.cashtype};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e&&(t.canAmount="",t.contint="",t.procedures=0,t.$message.success(t.$t("modify.withdrawal")),t.$emit("close"))}),(function(e){var n=e.response.data.errors;n[0]&&("422"===n[0].status?(t.$message.error(n[0].detail[0]),t.canAmount="",t.contint="",t.procedures=0):500===n[0].status&&("unbind_wechat"===n[0].code||"cash_mch_invalid"===n[0].code?t.$message.error(n[0].detail):(t.$message.error(t.$t("core.".concat(n[0].code))),t.canAmount="",t.contint="",t.procedures=0)))}))},tomy:function(){this.$router.push("/my/profile")}}},f=(n(729),n(0)),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("profile.towithdrawal")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("modify.wechatpayee")))]),t._v(" "),n("div",{staticClass:"body reward"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.withdrawlNumber,expression:"withdrawlNumber"}],staticClass:"rinput ript",attrs:{placeholder:t.$t("modify.enterwechat"),type:"text"},domProps:{value:t.withdrawlNumber},on:{input:function(e){e.target.composing||(t.withdrawlNumber=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"cashtext"},[t._v(t._s(t.$t("pay.cashtext")))])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("modify.withdrawable")))]),t._v(" "),n("div",{staticClass:"body product-information"},[n("span",{staticClass:"title2"},[t._v(" ￥ "+t._s(t.balance))])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"head reward"},[t._v(t._s(t.$t("modify.withdratitle")+t.$t("pay.sumOfMoney")))]),t._v(" "),n("div",{staticClass:"body reward"},[n("label",[n("span",[t._v("￥")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.canAmount,expression:"canAmount"}],staticClass:"rinput",attrs:{placeholder:t.$t("modify.enteramount"),type:"text"},domProps:{value:t.canAmount},on:{input:[function(e){e.target.composing||(t.canAmount=e.target.value)},t.settlement]}})])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("modify.actualamout")))]),t._v(" "),n("div",{staticClass:"body product-information"},[n("span",{staticClass:"title3"},[t._v(" ￥ "+t._s(t.contint||0))]),t._v(" "),n("span",{staticClass:"title4"},[t._v("\n          "+t._s(t.$t("modify.servicechaege"))+t._s(t.procedures)+t._s(t.$t("modify.percentage"))+" "+t._s(t.percentage)+"%)")])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"head reward"},[t._v(t._s(t.$t("user.verificationCode2")))]),t._v(" "),n("div",{staticClass:"body reward"},[n("label",[n("span"),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.verifycode,expression:"verifycode"}],attrs:{placeholder:t.$t("modify.placeEnterCode"),type:"text"},domProps:{value:t.verifycode},on:{input:function(e){e.target.composing||(t.verifycode=e.target.value)}}}),t._v(" "),n("el-button",{attrs:{size:"medium",disabled:!t.canClick||!t.usertestphon},on:{click:t.sendsms}},[t._v(t._s(t.content))])],1),t._v(" "),t.usertestphon?n("span",{staticClass:"phone"},[t._v("\n          "+t._s(t.$t("profile.codesend"))+"\n          "),n("span",{staticStyle:{"font-weight":"bold",color:"#000000"}},[t._v(t._s(t.usertestphon))]),t._v(" "+t._s(t.$t("profile.phonesms"))+"\n        ")]):n("span",{staticClass:"phone"},[t._v("\n          "+t._s(t.$t("profile.withoutbind"))+"\n          "),n("span",{staticClass:"phonei",on:{click:t.tomy}},[t._v("\n            "+t._s(t.$t("profile.personalhomepage"))+"\n          ")]),t._v("\n          "+t._s(t.$t("profile.tobindphone"))+"\n        ")])])])]),t._v(" "),n("div",{staticClass:"bottom"},[n("span",{staticStyle:{"font-size":"14px"}},[t._v("\n      ￥"+t._s(t.contint||0)+t._s(t.$t("pay.rmb")+t.$t("profile.withdrawalto")+t.withdrawlNumber||"")+t._s(t.$t("pay.ofAccount"))+"\n    ")]),t._v(" "),n("el-button",{staticClass:"border",attrs:{size:"medium",type:"primary"},on:{click:t.btncash}},[t._v(t._s(t.$t("profile.comfirmwithdrawal")))])],1)])}),[],!1,null,"00f9fdb8",null);e.default=component.exports;installComponents(component,{Message:n(58).default})},function(t,e,n){"use strict";n.r(e);n(9);var r=n(1),o=n.n(r),time=n(21),c={filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[o.a],props:{groupMap:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,selectedStatus:"",handleValue:"",pageNum:1,pageSize:10,searchText:"",sort:"-created_at",inviteTotal:0,totalMoney:0,total:0,inviteList:[]}},computed:{userId:function(){return this.$store.state.user.info.id},forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{userId:function(t){t&&0===this.totalMoney&&this.getIncome()}},mounted:function(){this.getInvite(),this.getIncome(),this.getInviteList()},methods:{getInvite:function(){var t=this;this.$store.dispatch("jv/get",["invite/users",{params:{"page[number]":1,"page[limit]":1}}]).then((function(e){e&&e._jv&&e._jv.json&&e._jv.json.meta&&(t.inviteTotal=e._jv.json.meta.total)}))},getIncome:function(){var t=this;if(this.userId){var e={"filter[user]":this.userId,"filter[change_type]":"33, 62, 34","page[number]":1,"page[limit]":1};this.$store.dispatch("jv/get",["wallet/log",{params:e}]).then((function(e){e&&e._jv&&e._jv.json&&e._jv.json.meta&&(t.totalMoney=e._jv.json.meta.sumChangeAvailableAmount)}))}},getInviteList:function(){var t=this;this.loading=!0;var e={"page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[username]":this.searchText,sort:this.sort};this.$store.dispatch("jv/get",["invite/users",{params:e}]).then((function(e){e&&(t.inviteList=e,e._jv&&e._jv.json&&e._jv.json.meta&&(t.total=e._jv.json.meta.total))}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},createUserInvite:function(){var t=this;if(!(this.forums&&this.forums.other&&this.forums.other.can_invite_user_scale))return this.$message.error(this.$t("core.permission_denied"));this.$store.dispatch("jv/get",{_jv:{type:"userInviteCode"}}).then((function(e){e&&e._jv&&t.copyLink(e._jv.code)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},viewDetail:function(t){this.$emit("view-detail",t)},copyLink:function(code){var t=document.createElement("input");t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/site/partner-invite?code=").concat(code),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success(this.$t("discuzq.msgBox.copySuccess")),setTimeout((function(){t.remove()}),100)},sortChange:function(t){var e=t.order;this.sort="descending"===e?"-created_at":"ascending"===e?"created_at":"",this.getInviteList()},onClickSearch:function(){this.pageNum=1,this.getInviteList()},handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getInviteList()},handleCurrentChange:function(t){this.pageNum=t,this.getInviteList()}}},l=(n(664),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("div",{staticClass:"filter-cont"},[n("div",{staticClass:"content"},[t.loading?t._e():[t._v("\n        "+t._s(t.$t("invite.inviteTotal"))+"\n        "),n("span",{staticClass:"bold"},[t._v(t._s(t.inviteTotal))]),t._v("\n        "+t._s(t.$t("invite.people"))+"\n        "+t._s(t.$t("invite.allIncome"))+"\n        "),n("span",{staticClass:"bold"},[t._v(t._s(t.$t("post.yuanItem")+t.totalMoney))])]],2),t._v(" "),n("el-input",{staticClass:"search",attrs:{placeholder:t.$t("invite.searchPlaceholder"),size:"medium"},on:{input:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),t._v(" "),n("el-button",{staticClass:"create-url",attrs:{type:"primary",size:"medium"},on:{click:t.createUserInvite}},[t._v(t._s(t.$t("manage.generateInvitationUrl")))])],1),t._v(" "),n("div",{staticClass:"main"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:t.inviteList,"default-sort":{prop:"created_at",order:"descending"}},on:{"sort-change":t.sortChange}},[n("el-table-column",{attrs:{label:t.$t("invite.inviteUserName")},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.user?n("div",{staticClass:"flex"},[n("avatar",{attrs:{user:{id:e.row.user.id,username:e.row.user.username,avatarUrl:e.row.user.avatarUrl},size:30,round:!0}}),t._v(" "),n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+e.row.user.id}},[t._v(t._s(e.row.user.username))])],1):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:t.$t("invite.createdAt"),sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("formatDate")(e.row.created_at))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.operate"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return n("div",{staticClass:"last-table"},[n("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:function(n){return t.viewDetail(e.row)}}},[t._v(t._s(t.$t("invite.viewDetail")))])],1)}}])})],1)],1),t._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"","hide-on-single-page":"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])}),[],!1,null,"2f4d033b",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(1),l={name:"Followers",mixins:[n.n(c).a],props:{userId:{type:String,default:""}},data:function(){return{value:"",inputVal:"",loadingType:"",followerList:[],pageSize:10,pageNum:1,currentLoginId:this.$store.getters["session/get"]("userId"),loading:!1,hasMore:!1,sort:"",options:[{label:this.$t("home.noLimit"),value:""},{label:"用户创建时间",value:"users.createdAt"}]}},mounted:function(){this.getFollowerList()},methods:{getFollowerList:function(t){var e=this;this.loading=!0;var n={include:["fromUser","fromUser.groups"],"filter[type]":2,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[user_id]":this.userId,"filter[username]":"".concat(this.inputVal)};o.b.run((function(){return e.$store.dispatch("jv/get",["follow",{params:n}])})).then((function(n){e.loading=!1,e.hasMore=n.length===e.pageSize,e.followerList="change"===t?n:[].concat(Object(r.a)(e.followerList),Object(r.a)(n)),n._jv&&(e.hasMore=e.followerList.length<n._jv.json.meta.total),e.pageNum+=1}),(function(t){e.handleError(t)})).finally((function(){e.loading=!1}))},addFollow:function(t,e){var n=this;if(this.$store.getters["session/get"]("isLogin"))if(0===t.follow){var r={_jv:{type:"follow"},type:"user_follow",to_user_id:t.id};this.$store.dispatch("jv/post",r).then((function(t){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var r=n.followerList[e],o=JSON.parse(JSON.stringify(r));o.fromUser.follow=1===t.is_mutual?2:1,n.$set(n.followerList,e,o)}),(function(t){return n.handleError(t)}))}else this.deleteFollow(t,e)},deleteFollow:function(t,e){var n=this;this.$store.getters["session/get"]("isLogin")&&this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){n.userId===n.currentLoginId&&n.$emit("changeFollow",{userId:n.userId});var t=n.followerList[e],r=JSON.parse(JSON.stringify(t));r.fromUser.follow=0,n.$set(n.followerList,e,r)}))},loadMore:function(){this.hasMore&&this.getFollowerList()},toUser:function(t){this.$router.push("/user/".concat(t))},confirm:function(t){this.sort=t,this.pageNum=1,this.followerList=[],this.getFollowerList("change")},onClickSearch:function(){this.pageNum=1,this.getFollowerList("change")}}},d=(n(787),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"follwers"},[n("div",{staticClass:"ftop"},[n("el-select",{staticClass:"fselect",attrs:{placeholder:"排序",size:"small"},on:{change:t.confirm},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),n("el-input",{staticClass:"h-search",attrs:{size:"small",placeholder:t.$t("manage.pleaseInputUserName")},on:{change:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.onClickSearch},slot:"suffix"})])],1),t._v(" "),t._l(t.followerList,(function(e,r){return n("div",{key:r,staticClass:"user-item-container"},[n("div",{staticClass:"flex user-item",on:{click:function(n){return n.stopPropagation(),t.toUser(e.fromUser.id)}}},[n("avatar",{attrs:{user:e.fromUser,size:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"flex"},[n("span",{staticClass:"name text-hidden"},[t._v(t._s(e.fromUser.username))]),t._v(" "),e.fromUser.groups&&e.fromUser.groups[0]&&e.fromUser.groups[0].isDisplay?n("span",{staticClass:"role"},[t._v(t._s(e.fromUser&&e.fromUser.groups&&e.fromUser.groups[0]?e.fromUser.groups[0].name:""))]):t._e()]),t._v(" "),n("div",{staticClass:"flex count"},[n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.topic"))+" "+t._s(e.fromUser.threadCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.following"))+" "+t._s(e.fromUser.followCount||0))]),t._v(" "),n("div",{staticClass:"count-item"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(e.fromUser.fansCount||0))])])])],1),t._v(" "),(e.fromUser&&e.fromUser.id)!=t.currentLoginId?n("el-button",{staticClass:"follow",attrs:{type:"text"},on:{click:function(n){return t.addFollow(e.fromUser,r)}}},[2===e.fromUser.follow?n("svg-icon",{staticClass:"follow-icon",attrs:{type:"follow-heart"}}):t._e(),t._v("\n      "+t._s(0==(e.fromUser&&e.fromUser.follow)?t.$t("profile.following"):1==(e.fromUser&&e.fromUser.follow)?t.$t("profile.followed"):t.$t("profile.mutualfollow"))+"\n    ")],1):t._e()],1)})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.followerList.length},on:{loadMore:t.loadMore}})],2)}),[],!1,null,"03306388",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,SvgIcon:n(11).default,ListLoadMore:n(40).default})},function(t,e,n){"use strict";n.r(e);n(9);var r=n(1),o=n.n(r),time=n(21),c={filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[o.a],props:{groupMap:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,pageNum:1,pageSize:10,searchText:"",sort:"-created_at",total:0,incomeList:[],totalMoney:0}},computed:{userId:function(){return this.$store.state.user.info.id},forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{userId:function(t){t&&0===this.incomeList.length&&this.getIncomeList()}},mounted:function(){this.getIncomeList()},methods:{getIncomeList:function(){var t=this;if(this.userId){this.loading=!0;var e={include:"sourceUser","filter[user]":this.userId,"filter[change_type]":"33, 62, 34","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[source_username]":this.searchText,sort:this.sort};this.$store.dispatch("jv/get",["wallet/log",{params:e}]).then((function(e){e&&e._jv&&e._jv.json&&e._jv.json.meta&&(t.totalMoney=e._jv.json.meta.sumChangeAvailableAmount,t.total=e._jv.json.meta.total),t.incomeList=e}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))}},createUserInvite:function(){var t=this;if(!(this.forums&&this.forums.other&&this.forums.other.can_invite_user_scale))return this.$message.error(this.$t("core.permission_denied"));this.$store.dispatch("jv/get",{_jv:{type:"userInviteCode"}}).then((function(e){e&&e._jv&&t.copyLink(e._jv.code)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},copyLink:function(code){var t=document.createElement("input");t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/site/partner-invite?code=").concat(code),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success(this.$t("discuzq.msgBox.copySuccess")),setTimeout((function(){t.remove()}),100)},sortChange:function(t){var e=t.order;this.sort="descending"===e?"-created_at":"ascending"===e?"created_at":"",this.getIncomeList()},onClickSearch:function(){this.pageNum=1,this.getIncomeList()},handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getIncomeList()},handleCurrentChange:function(t){this.pageNum=t,this.getIncomeList()}}},l=(n(665),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("div",{staticClass:"filter-cont"},[n("div",{staticClass:"content"},[t.loading?t._e():[t._v("\n        "+t._s(t.$t("invite.incomeTotal"))+"\n        "),n("span",{staticClass:"bold"},[t._v(t._s(t.$t("post.yuanItem")+t.totalMoney))])]],2),t._v(" "),n("el-input",{staticClass:"search",attrs:{placeholder:t.$t("invite.searchPlaceholder"),size:"medium"},on:{input:t.onClickSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),t._v(" "),n("el-button",{staticClass:"create-url",attrs:{type:"primary",size:"medium"},on:{click:t.createUserInvite}},[t._v(t._s(t.$t("manage.generateInvitationUrl")))])],1),t._v(" "),n("div",{staticClass:"main"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:t.incomeList,"default-sort":{prop:"created_at",order:"descending"}},on:{"sort-change":t.sortChange}},[n("el-table-column",{attrs:{label:t.$t("invite.inviteUserName")},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.sourceUser&&e.row.sourceUser.username?n("div",{staticClass:"flex"},[n("avatar",{attrs:{user:{id:e.row.sourceUser.id,username:e.row.sourceUser.username,avatarUrl:e.row.sourceUser.avatarUrl},size:30,round:!0}}),t._v(" "),n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+e.row.sourceUser.id}},[t._v(t._s(e.row.sourceUser.username))])],1):[t._v(t._s(t.$t("core.userDeleted")))]]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:t.$t("invite.incomeAt"),sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("formatDate")(e.row.created_at))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("invite.income"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return n("div",{staticClass:"last-table"},[t._v("\n          "+t._s(t.$t("post.yuanItem")+e.row.change_available_amount)+"\n        ")])}}])})],1)],1),t._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"","hide-on-single-page":"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])}),[],!1,null,"4e9fe3f0",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(65)),c=n.n(o),l=n(84),d=n.n(l),h=n(1),m=n.n(h),f=n(32),v=n.n(f),_=n(45),y=n.n(_),w="user,replyUser,images,thread,user.groups,thread.category,thread.firstPost,lastThreeComments,lastThreeComments.user,lastThreeComments.replyUser,deletedUser,lastDeletedLog,lastThreeComments.images",C={name:"Comment",mixins:[m.a,c.a,d.a,y.a,v.a],props:{threadId:{type:String,default:"0"}},data:function(){return{commentList:[],postCount:0,pageLimit:5,pageNumber:1,isPositiveSort:!0,onCommentPublish:!1,onEditCommentPublish:!1,comment:{text:"",imageList:[],attachedList:[]},editResourceShow:{showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1},editCommentPost:{text:"",imageList:[],attachedList:[]},editComment:{},commentType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的评论 ..."},commitLoading:!1,scrollLoading:!1,afterPushComment:!0}},created:function(){this.getComment("scroll")},methods:{getComment:function(t){var e=this;this.commitLoading||("commit"===t?this.commitLoading=!0:this.scrollLoading=!0,this.$store.dispatch("jv/get",["posts",{params:{"filter[thread]":this.threadId,"filter[isDeleted]":"no","filter[isComment]":"no","page[number]":this.pageNumber,"page[limit]":this.pageLimit,sort:this.isPositiveSort?"createdAt":"-createdAt",include:w}}]).then((function(data){var t;e.pageNumber+=1,(t=e.commentList).push.apply(t,Object(r.a)(data)),e.postCount=data.length>0?data[0].thread.postCount-1:0}),(function(t){return e.handleError(t)})).finally((function(){e.commitLoading=e.scrollLoading=!1})))},updateSingleComment:function(t){var e=this;if(!0!==this.commitLoading)return this.commitLoading=!0,this.$store.dispatch("jv/get",["posts/".concat(t),{params:{include:"user,likedUsers,commentPosts,commentPosts.user,commentPosts.user.groups,commentPosts.replyUser,commentPosts.replyUser.groups,commentPosts.mentionUsers,commentPosts.images,images,attachments"}}]).then((function(n){n.lastThreeComments=n.commentPosts.reverse().filter((function(t){return!t.isDeleted})).slice(0,3),e.$set(e.commentList,e.getCommentIndexFromId(t),n),e.commitLoading=!1}),(function(t){return e.handleError(t)})).finally((function(){e.commitLoading=!1}))},changeSort:function(t){this.scrollLoading=!0,this.pageNumber=1,this.commentList=[],this.isPositiveSort=t,this.getComment("commit")},onLike:function(t){var e=this,n=t.comment,r=t.index,o={_jv:{type:"posts",id:n._jv.id},isLiked:!n.isLiked,include:w};return this.$store.dispatch("jv/patch",o).then((function(data){e.$set(e.commentList,r,data)}),(function(t){return e.handleError(t)}))},deleteComment:function(t){var e=this,n={_jv:{type:"posts",id:t},isDeleted:!0};this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$store.dispatch("jv/patch",n).then((function(){e.postCount-=1,e.commentList.splice(e.getCommentIndexFromId(t),1),e.$message.success(e.$t("topic.deleteSuccess"))}),(function(t){return e.handleError(t)}))}),(function(){}))},deleteReply:function(t){var e=this,n=t.replyId,r=t.commentId,o={_jv:{type:"posts",id:n},isDeleted:!0};this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$store.dispatch("jv/patch",o).then((function(){e.updateSingleComment(r),e.$message.success(e.$t("topic.deleteSuccess"))}),(function(t){return e.handleError(t)}))}),(function(){}))},onEditComment:function(t){this.editComment=t,this.editCommentPost.text=t.content,this.$nextTick((function(){var textarea=document.querySelector(".edit-comment-editor #textarea");textarea.style.height=textarea.scrollHeight+"px"})),t.images.length>0&&(this.initThreadResource(this.editCommentPost.imageList,t.images),this.editResourceShow.showUploadImg=!0)},postEditCommentPublish:function(){var t=this;if(this.isLogin()&&!this.onEditCommentPublish){if(!this.editCommentPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.editCommentPost.text.length>this.commentType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onEditCommentPublish=!0;var e={_jv:{type:"posts",relationships:{}},content:this.editCommentPost.text};this.threadId&&(e._jv.id=this.threadId),e=this.publishPostResource(e,this.editCommentPost),this.deleteAttachmentsAfterEdit(this.editComment.images,this.editCommentPost.imageList),this.$store.dispatch("jv/patch",[e,{url:"/posts/".concat(this.editComment._jv.id)}]).then((function(e){t.updateSingleComment(t.editComment._jv.id),t.postLegalityCheck(e,t.$t("topic.commentPublishSuccess")),t.closeEditPop()}),(function(e){return t.handleError(e)})).finally((function(){t.onEditCommentPublish=!1}))}},closeEditPop:function(){this.editComment={},this.editCommentPost.text="",this.editCommentPost.imageList=[],this.editResourceShow.showUploadImg=!1},initThreadResource:function(t,e){e.forEach((function(e){var n={name:e.fileName,url:e.thumbUrl,id:e._jv.id,deleted:!1};t.push(n)}))},postCommentPublish:function(){var t=this;if(this.isLogin()&&!this.onCommentPublish){if(!this.comment.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.comment.text.length>this.commentType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onCommentPublish=!0;var e={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:this.threadId}}}},content:this.comment.text};return this.publishPostResource(e,this.comment),this.$store.dispatch("jv/post",e).then((function(e){t.comment.text="",t.comment.imageList=[],t.afterPushComment=!1,t.$nextTick((function(){t.afterPushComment=!0})),t.postLegalityCheck(e,t.$t("topic.commentPublishSuccess")),t.isPositiveSort?t.commentList.length===t.postCount&&t.commentList.push(e):t.commentList.unshift(e),t.postCount+=1}),(function(e){return t.handleError(e)})).finally((function(){t.onCommentPublish=!1}))}},getCommentIndexFromId:function(t){var e=this.commentList.filter((function(e){return e._jv.id===t}))[0];return this.commentList.indexOf(e)}}},$=(n(778),n(779),n(0)),component=Object($.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.postCount>0?n("comment-header",{attrs:{"comment-count":t.postCount,"is-positive-sort":t.isPositiveSort},on:{changeSort:t.changeSort}}):n("div",{staticClass:"without-comment"},[t._v(t._s(t.$t("topic.noComment")))]),t._v(" "),t.afterPushComment?n("editor",{staticClass:"comment-editor",attrs:{"editor-style":"comment",selector:"comment-editor","type-information":t.commentType,post:t.comment,"on-publish":t.onCommentPublish},on:{"update:post":function(e){t.comment=e},publish:t.postCommentPublish}}):t._e(),t._v(" "),t.postCount>0?[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.commitLoading,expression:"commitLoading"}],staticStyle:{"min-height":"100px"}},[n("comment-list",{attrs:{"thread-id":t.threadId,"comment-list":t.commentList},on:{replyPublish:t.updateSingleComment,deleteComment:t.deleteComment,deleteReply:t.deleteReply,editComment:t.onEditComment,like:t.onLike}})],1),t._v(" "),n("list-load-more",{attrs:{loading:t.scrollLoading,length:t.commentList.length,"has-more":t.postCount>t.commentList.length,"page-num":t.pageNumber},on:{loadMore:function(e){return t.getComment("scroll")}}})]:t._e(),t._v(" "),n("el-dialog",{attrs:{title:t.$t("topic.editComment"),visible:Object.keys(t.editComment).length>0,width:"820px","destroy-on-close":""},on:{close:t.closeEditPop}},[n("avatar-component",{attrs:{author:t.editComment.user||{},size:50}},[t._v("\n      "+t._s(t.$t("topic.publishAt")+" "+t.timerDiff(t.editComment.updatedAt)+t.$t("topic.before"))+"..\n    ")]),t._v(" "),n("editor",{staticClass:"edit-comment-editor",staticStyle:{"margin-top":"20px"},attrs:{"editor-style":"comment",selector:"edit-comment-editor","edit-resource-show":t.editResourceShow,"on-publish":t.onEditCommentPublish,"type-information":t.commentType,post:t.editCommentPost,"is-edit":!0},on:{"update:post":function(e){t.editCommentPost=e},publish:t.postEditCommentPublish}})],1)],2)}),[],!1,null,"414cff72",null);e.default=component.exports;installComponents(component,{CommentHeader:n(371).default,Editor:n(88).default,CommentList:n(831).default,ListLoadMore:n(40).default,AvatarComponent:n(72).default})},function(t,e,n){"use strict";n.r(e);var r=n(32),o={name:"EditorQa",mixins:[n.n(r).a],props:{question:{type:Object,default:function(){}}},data:function(){return{beAskedUser:{},showQACaller:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},canSetOnlooker:function(){return!!(this.forums&&this.forums.other&&this.forums.other.can_be_onlooker)&&this.forums.other.can_be_onlooker},siteOnlookerPrice:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_onlooker_price:""},siteMasterScale:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_master_scale/10:""},siteUserScale:function(){return this.siteMasterScale?1-this.siteMasterScale:""}},watch:{question:{handler:function(t){t.beUser&&(this.beAskedUser=t.beUser)},deep:!0,immediate:!0}},mounted:function(){this.question.beUser&&(this.beAskedUser=this.question.beUser)},methods:{selectedQaCaller:function(t){this.beAskedUser=t,this.showQACaller=!1,this.$emit("beUserChange",t)}}},c=(n(687),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qa"},[n("div",{staticClass:"qa-payment block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.questionMode"))+":")]),t._v(" "),n("el-radio",{attrs:{value:t.question.paymentType,label:"free"},on:{input:function(e){return t.$emit("paymentTypeChange",e)}}},[t._v(t._s(t.$t("post.freeWatch")))]),t._v(" "),n("el-radio",{attrs:{value:t.question.paymentType,label:"paid"},on:{input:function(e){return t.$emit("paymentTypeChange",e)}}},[t._v(t._s(t.$t("post.paidWatch")))])],1),t._v(" "),n("div",{staticClass:"qa-anonymous block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.anonymous"))+":")]),t._v(" "),n("el-switch",{attrs:{value:t.question.isAnonymous,"active-color":"#1878F3"},on:{input:function(e){return t.$emit("isAnonymousChange",e)}}})],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.canSetOnlooker,expression:"canSetOnlooker"}],staticClass:"qa-onlooker block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.onLooker"))+":")]),t._v(" "),n("el-switch",{attrs:{value:t.question.isOnlooker,"active-color":"#1878F3"},on:{input:function(e){return t.$emit("isOnlookerChange",e)}}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.siteOnlookerPrice&&t.siteMasterScale&&t.siteUserScale,expression:"siteOnlookerPrice && siteMasterScale && siteUserScale"}],staticClass:"tip"},[n("span",[t._v(t._s("他人围观需付费 "+t.siteOnlookerPrice+" 元"))]),t._v(" "),n("span",[t._v(t._s("（你得 "+(t.siteOnlookerPrice*t.siteUserScale/2).toFixed(2)+" 元，回答者得 "+(t.siteOnlookerPrice*t.siteUserScale/2).toFixed(2)+" 元，平台得 "+(t.siteOnlookerPrice*t.siteMasterScale).toFixed(2)+" 元）"))])])],1),t._v(" "),n("div",{staticClass:"qa-answerer block"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("post.questionHim"))+":")]),t._v(" "),n("span",{staticClass:"select-answerer",on:{click:function(e){t.showQACaller=!0}}},[t._v("\n        "+t._s(Object.keys(t.beAskedUser).length>0?t.$t("post.changeBeAskedUser"):t.$t("post.addBeAskedUser"))+"\n      ")])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.beAskedUser).length>0,expression:"Object.keys(beAskedUser).length > 0"}],staticClass:"be-asked-user"},[n("avatar-component",{attrs:{author:t.beAskedUser,size:50,round:""}},[t._v("\n        "+t._s(t.$t("topic.activeAt"))+" "+t._s(t.timerDiff(t.beAskedUser.updatedAt))+t._s(t.$t("topic.before"))+"\n      ")])],1)]),t._v(" "),t.showQACaller?n("qa-caller",{on:{close:function(e){t.showQACaller=!1},selectedQaCaller:t.selectedQaCaller}}):t._e()],1)}),[],!1,null,"1935ce69",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,QaCaller:n(790).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(19),n(9),n(25);var r=n(12),o=n(32);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var l={name:"EditorProduct",mixins:[n.n(o).a],props:{product:{type:Object,default:function(){}}},data:function(){return{addedProduct:{},showProductDialog:!1,typeList:{1:"product-tmall",2:"product-jd",3:"product-pinduoduo",5:"product-taobao",7:"product-youzan"}}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{product:{handler:function(t){this.addedProduct=t},deep:!0}},mounted:function(){this.addedProduct=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},this.product)},methods:{inputedLink:function(t){this.addedProduct=t,this.showProductDialog=!1,this.$emit("productChange",t)},remove:function(){this.addedProduct={},this.$emit("productChange",this.addedProduct)}}},d=(n(691),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"product-container"},[n("div",{staticClass:"block"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("permission.createThreadGoods"))+":")]),t._v(" "),n("span",{staticClass:"select-product",on:{click:function(e){t.showProductDialog=!0}}},[t._v("\n        "+t._s(Object.keys(t.addedProduct).length>0?"":"+"+t.$t("post.addProduct"))+"\n      ")])]),t._v(" "),Object.keys(t.addedProduct).length>0?n("div",{staticClass:"product-info"},[n("el-image",{staticClass:"image",attrs:{src:t.addedProduct.image_path}}),t._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"title"},[t.typeList[t.addedProduct.type]&&t.addedProduct.title?n("svg-icon",{staticClass:"icon",attrs:{type:t.typeList[t.addedProduct.type]}}):t._e(),t._v("\n          "+t._s(t.addedProduct.title)+"\n        ")],1),t._v(" "),n("div",{staticClass:"bottom"},[n("span",{staticClass:"price"},[t._v(t._s(t.addedProduct.price>0?t.$t("post.yuanItem")+t.addedProduct.price+t.$t("post.yuan"):""))]),t._v(" "),n("svg-icon",{staticClass:"icon",attrs:{type:"delete"},on:{click:t.remove}})],1)])],1):t._e()]),t._v(" "),t.showProductDialog?n("product-dialog",{on:{close:function(e){t.showProductDialog=!1},inputedLink:t.inputedLink}}):t._e()],1)}),[],!1,null,"c13597fe",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,ProductDialog:n(791).default})},function(t,e,n){"use strict";n.r(e);n(24);var r=n(115),o={name:"EditorPayment",props:{payment:{type:Object,default:function(){}},type:{type:Number,default:0},canUploadAttachments:{type:Boolean,default:!1}},data:function(){return{freeWords:0,price:0,attachmentPrice:0,options:[{value:"free",label:this.$t("post.freeWatch")},{value:"paid",label:this.$t("post.paidWatch")}],freeWordsOptions:[{value:0,label:"0%"},{value:.1,label:"10%"},{value:.3,label:"30%"},{value:.5,label:"50%"},{value:.7,label:"70%"},{value:1,label:"100%"}]}},watch:{payment:{handler:function(t){this.freeWords=t.freeWords||0,this.price=t.price||0,this.attachmentPrice=t.attachmentPrice||0},immediate:!0,deep:!0},type:{handler:function(t){1===t&&this.canUploadAttachments&&this.options.push({value:"attachmentPaid",label:this.$t("post.postFreeAttachmentPaid")})},immediate:!0}},methods:{onPriceInput:function(t){this.price=Object(r.a)(t)},onAttachmentPriceInput:function(t){this.attachmentPrice=Object(r.a)(t)}}},c=(n(695),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("div",{staticClass:"block"},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.isPay"))+":")]),t._v(" "),n("el-select",{attrs:{size:"medium",value:t.payment.paidType,placeholder:"请选择"},on:{change:function(e){return t.$emit("paymentChange",{key:"paidType",value:e})}}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("div",{staticClass:"block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"paid"===t.payment.paidType,expression:"payment.paidType === 'paid'"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.paymentAmount"))+":")]),t._v(" "),n("el-input",{attrs:{size:"medium",placeholder:"0",maxlength:"7"},on:{change:function(e){t.$emit("paymentChange",{key:"price",value:parseFloat(t.price)})},input:t.onPriceInput},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}},[n("span",{staticClass:"prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"attachmentPaid"===t.payment.paidType&&1===t.type,expression:"payment.paidType === 'attachmentPaid' && type === 1"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.paymentAmount"))+":")]),t._v(" "),n("el-input",{attrs:{size:"medium",placeholder:"0",maxlength:"7"},on:{change:function(e){t.$emit("paymentChange",{key:"attachmentPrice",value:parseFloat(t.attachmentPrice)})},input:t.onAttachmentPriceInput},model:{value:t.attachmentPrice,callback:function(e){t.attachmentPrice=e},expression:"attachmentPrice"}},[n("span",{staticClass:"prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1)]),t._v(" "),n("div",{staticClass:"block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"paid"===t.payment.paidType&&1===t.type,expression:"payment.paidType === 'paid' && type === 1"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.freeWord"))+":")]),t._v(" "),n("el-select",{attrs:{size:"medium",value:t.freeWords},on:{change:function(e){return t.$emit("paymentChange",{key:"freeWords",value:e})}}},t._l(t.freeWordsOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])])}),[],!1,null,"68ed2d49",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);n(51),n(24);var r=n(1),o=n.n(r),c=n(271),l=n.n(c),d=n(95),h=n(272),m=n.n(h),f=n(31),v={name:"AttachmentUpload",mixins:[o.a,l.a,m.a],props:{action:{type:String,default:"",required:!0},fileList:{type:Array,default:function(){return[]},required:!0},accept:{type:String,default:""},limit:{type:Number,default:9999},sizeLimit:{type:Number,default:1e17},onUpload:{type:Boolean,default:!1},type:{type:Number,default:0}},data:function(){return{previewFiles:[]}},computed:{input:function(){return document.getElementById("upload")},service:function(){return f.a}},methods:{extensionValidate:function(t){var e=t.split(".")[t.split(".").length-1];return d.extensionList.indexOf(e.toUpperCase())>0?e.toUpperCase():"UNKNOWN"}}},_=(n(700),n(0)),component=Object(_.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"container-upload"},[n("div",{staticClass:"upload"},[n("span",{staticClass:"attachment-list"},[t._v(t._s(t.$t("post.attachmentList")))]),t._v(" "),n("span",{staticClass:"add-attachment",on:{click:t.onClick}},[t._v(t._s(t.$t("post.addAttachment")))]),t._v(" "),n("input",{attrs:{id:"upload",accept:t.accept,type:"file",multiple:""},on:{input:t.onInput}})]),t._v(" "),t._l(t.previewFiles,(function(e,r){return n("div",{key:r,class:{"preview-item":!0,deleted:e.deleted}},[n("div",{staticClass:"container-item"},[n("div",{staticClass:"info"},[n("svg-icon",{staticStyle:{"font-size":"18px","vertical-align":"middle"},attrs:{type:t.extensionValidate(e.name)}}),t._v(" "),n("span",{class:{"file-name":!0,uploading:e.progress<100}},[t._v(t._s(e.name))])],1),t._v(" "),n("span",{staticClass:"size"},[t._v(t._s(parseInt((e.size/1024).toString()).toLocaleString())+" KB")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.progress<100,expression:"file.progress < 100"}],staticClass:"progress",style:{width:e.progress+"%"}})]),t._v(" "),n("div",{staticClass:"remove"},[n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.progress&&100===e.progress,expression:"file.progress && file.progress === 100"}],staticClass:"remove-icon",attrs:{type:"delete"},on:{click:function(e){return t.removeItem(r)}}})],1)])}))],2)}),[],!1,null,"10e67521",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(19),n(48),n(9),n(24);var r=n(116),o=n(31),c=n(1),l=n.n(c),d=n(419),h={name:"Vditor",mixins:[l.a],props:{showCaller:{type:Boolean,default:!1},showTopic:{type:Boolean,default:!1},showEmoji:{type:Boolean,default:!1},text:{type:String,default:""},textLimit:{type:[Number,String],default:49999},textLength:{type:[Number,String],default:0},isEdit:{type:Boolean,default:!1},attachmentSizeLimit:{type:Number,default:1e21},imageAccept:{type:String,default:""},onUploadImage:{type:Boolean,default:!1},placeholder:{type:String,default:""},onPublish:{type:Boolean,default:!1}},data:function(){return{vditor:{},input:{},range:[]}},watch:{isEdit:{handler:function(t){t&&this.text&&this.vditor&&this.vditor.setValue(this.text,!1)},immediate:!0}},mounted:function(){d&&this.initVditor()},methods:{initVditor:function(){var t=this;this.vditor=new d("vditor",{minHeight:450,placeholder:this.placeholder,mode:"wysiwyg",tab:"    ",input:function(e){t.$emit("textChange",e)},toolbar:[{hotkey:"",name:"@",tipPosition:"ne",tip:"@ 好友",className:"right",icon:r.a,click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showCaller")}},{hotkey:"",name:"#",tipPosition:"ne",tip:"新增话题",className:"right",icon:r.d,click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showTopic")}},{hotkey:"",name:"my-emoji",tipPosition:"ne",tip:"插入表情",className:"right",icon:r.b,click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showEmoji")}},"headings","bold","italic","strike","link","list","ordered-list","check","outdent","indent","quote",{hotkey:"",name:"picture",tipPosition:"ne",tip:"插入图片",className:"right",icon:r.c,click:function(){t.uploader()}},"line","code","inline-code","table","both","br","undo","redo"],toolbarConfig:{pin:!0},cache:{enable:!1}})},uploader:function(){var t=this;if(this.onUploadImage)return this.$message.warning("请等待上传中的图片完成上传");this.input=document.createElement("input"),this.input.type="file",this.input.multiple=!0,this.input.accept=this.imageAccept,this.input.dispatchEvent(new MouseEvent("click")),this.input.oninput=function(e){var n=e.target.files,r=[];if(t.checkSizeLimit(n)){for(var i=0;i<n.length;i++)r.push(n[i]);var o=r.reduce((function(e,n){return e.push(t.uploadFile(n)),e}),[]);t.uploadFiles(o)}}},uploadFile:function(t){var e=new FormData;return e.append("type",1),e.append("file",t),o.a.post("/attachments",e)},uploadFiles:function(t){var e=this;this.$emit("update:onUploadImage",!0),Promise.all(t).then((function(t){t.map((function(t){return t.data.data})).forEach((function(t){var html='<img src="'.concat(t.attributes.url,'" alt="').concat(t.attributes.fileName,'" title="').concat(t.id,'">'),n=e.vditor.html2md(html);e.vditor.insertValue(n.substr(0,n.length-1))})),e.input.value=""}),(function(t){e.input.value="",e.handleError(t).then((function(){}))})).finally((function(){e.$emit("update:onUploadImage",!1)}))},selectActions:function(code){var t=window.getSelection();t.removeAllRanges(),t.addRange(this.range),this.vditor.insertValue(code),this.$emit("hideActions")},checkSizeLimit:function(t){for(var e=!0,i=0;i<t.length;i++)t[i].size>this.attachmentSizeLimit&&(e=!1);return e||this.$message.error("图片大小不可超过 ".concat(this.attachmentSizeLimit/1024/1024," MB")),e},publish:function(){var t=this.vditor.getValue();this.$emit("textChange",t),this.$emit("publish")}}},m=(n(701),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.onUploadImage,expression:"onUploadImage"}],staticClass:"vditor-container",attrs:{"element-loading-background":"hsla(0,0%,100%,0.6)"}},[n("div",{staticClass:"sticky-box"},[n("topic-list",{directives:[{name:"show",rawName:"v-show",value:t.showTopic,expression:"showTopic"}],staticClass:"action-vditor",on:{selectedTopic:t.selectActions}}),t._v(" "),n("emoji-list",{directives:[{name:"show",rawName:"v-show",value:t.showEmoji,expression:"showEmoji"}],staticClass:"action-vditor",on:{selectEmoji:t.selectActions}})],1),t._v(" "),n("div",{attrs:{id:"vditor"}}),t._v(" "),t.textLimit?n("span",{staticClass:"tip"},[t._v(t._s(t.textLimit>=t.textLength?t.$t("post.note",{num:t.textLimit-t.textLength}):t.$t("post.exceed",{num:t.textLength-t.typeInformation.textLimit})))]):t._e(),t._v(" "),t.showCaller?n("caller",{on:{close:function(e){return t.$emit("close")},selectedCaller:t.selectActions}}):t._e(),t._v(" "),n("el-button",{staticClass:"button-publish",attrs:{loading:t.onPublish,type:"primary",size:"small"},on:{click:t.publish}},[t._v(t._s(t.$t("post.post")))])],1)}),[],!1,null,"1ca883d4",null);e.default=component.exports;installComponents(component,{TopicList:n(366).default,EmojiList:n(367).default,Caller:n(373).default})},function(t,e,n){"use strict";n.r(e);n(24);var r={name:"EditorToolBar",props:{actions:{type:Array,default:function(){return[]}},showEmoji:{type:Boolean,default:!1},showTopic:{type:Boolean,default:!1},resources:{type:Array,default:function(){return[]}},textLimit:{type:[Number,String],default:450},textLength:{type:[Number,String],default:0},onPublish:{type:Boolean,default:!1},editorStyle:{type:String,default:"post"}}},o=(n(705),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["editor-bar",t.editorStyle]},[n("div",{staticClass:"block"},[t._l(t.actions,(function(e,r){return[e.show&&"emoji"===e.icon?n("popover",{key:r,staticClass:"svg",attrs:{visible:t.showEmoji},on:{hidePop:function(e){return t.$emit("hidePop",e)}},scopedSlots:t._u([{key:"pop",fn:function(){return[n("emoji-list",{on:{selectEmoji:function(e){return t.$emit("selectActions",e)}}})]},proxy:!0},{key:"activeNode",fn:function(){return[n("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}})]},proxy:!0}],null,!0)}):t._e(),t._v(" "),e.show&&"topic"===e.icon?n("popover",{key:r,staticClass:"svg",attrs:{visible:t.showTopic},on:{hidePop:function(e){return t.$emit("hidePop",e)}},scopedSlots:t._u([{key:"pop",fn:function(){return[n("topic-list",{on:{selectedTopic:function(e){return t.$emit("selectActions",e)}}})]},proxy:!0},{key:"activeNode",fn:function(){return[n("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}})]},proxy:!0}],null,!0)}):e.show&&"call"===e.icon?n("svg-icon",{key:r,staticClass:"svg",staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}}):t._e()]}))],2),t._v(" "),n("div",{staticClass:"block"},[t._l(t.resources,(function(e,r){return[e.show?n("svg-icon",{key:r,staticClass:"svg",staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("addResource",e.toggle)}}}):t._e()]}))],2),t._v(" "),n("div",{staticClass:"publish-container"},[t.textLimit?n("span",{staticClass:"tip"},[t._v(t._s(t.textLimit>=t.textLength?t.$t("post.note",{num:t.textLimit-t.textLength}):t.$t("post.exceed",{num:t.textLength-t.textLimit})))]):t._e(),t._v(" "),n("el-button",{staticClass:"button-publish",attrs:{loading:t.onPublish,type:"primary",size:"small"},on:{click:function(e){return t.$emit("publish")}}},[t._v(t._s(t.$t("post.post")))])],1)])}),[],!1,null,"7783e7e6",null);e.default=component.exports;installComponents(component,{EmojiList:n(367).default,SvgIcon:n(11).default,Popover:n(804).default,TopicList:n(366).default})},function(t,e,n){"use strict";n.r(e);n(24);var r=n(1),o=n.n(r),c=n(271),l=n.n(c),d=n(272),h=n.n(d),m=n(31),f={name:"ImageUpload",mixins:[o.a,l.a,h.a],props:{action:{type:String,default:"",required:!0},fileList:{type:Array,default:function(){return[]},required:!0},accept:{type:String,default:""},limit:{type:Number,default:9999},sizeLimit:{type:Number,default:1e17},onUpload:{type:Boolean,default:!1},type:{type:Number,default:0}},data:function(){return{previewFiles:[]}},computed:{input:function(){return document.getElementById("upload")},service:function(){return m.a}}},v=(n(707),n(0)),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"container-upload"},[t._l(t.previewFiles,(function(image,e){return n("div",{key:e,class:{"preview-item":!0,deleted:image.deleted}},[n("img",{attrs:{src:image.url,alt:""}}),t._v(" "),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:image.progress<100,expression:"image.progress < 100"}],staticClass:"progress",attrs:{percentage:image.progress,color:"#25A9F6","show-text":!1}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:image.progress<100,expression:"image.progress < 100"}],staticClass:"cover"},[t._v("图片上传中...")]),t._v(" "),n("div",{class:{"upload-delete":!0,"show-delete":100===image.progress},on:{click:function(n){return t.removeItem(e)}}},[n("svg-icon",{staticStyle:{"font-size":"14px",fill:"white"},attrs:{type:"delete"}})],1)],1)})),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.previewFiles.length<t.limit,expression:"previewFiles.length < limit"}],staticClass:"upload",on:{click:t.onClick}},[n("input",{attrs:{id:"upload",accept:t.accept,type:"file",multiple:""},on:{input:t.onInput}}),t._v(" "),n("svg-icon",{staticClass:"upload-icon",staticStyle:{fill:"#1878F3"},attrs:{type:"add"}})],1)],2)}),[],!1,null,"1dc1de81",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(9),n(18);var r=n(7),o=(n(51),n(841)),c={name:"VideoUpload",props:{videoList:{type:Array,default:function(){return[]}},onUploadVideo:{type:Boolean,default:!1}},data:function(){return{showVideoPop:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},sizeLimit:function(){return this.forums&&this.forums.qcloud?this.forums.qcloud.qcloud_vod_size:""},typesLimit:function(){return this.forums&&this.forums.qcloud?this.forums.qcloud.qcloud_vod_ext.split(",").map((function(t){return"."+t})).join(","):""}},methods:{handleVideoRemove:function(){var t=this;return this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),type:this.$t("discuzq.msgBox.cancel"),typeInformation:"warning"}).then((function(){t.$refs.upload.clearFiles(),setTimeout((function(){t.$emit("videoChange",{key:"videoList",value:[]})}),1e3)}),(function(){}))},addVideo:function(t){var e=this;if(!this.onUploadVideo){if(this.sizeLimit&&t.raw.size>1024*this.sizeLimit*1024)return this.$message.error(this.$t("profile.filesizecannotexceed")+this.sizeLimit+"MB"),void this.$refs.upload.clearFiles();if(!this.videoTypeCheck(t))return this.$message.error("暂不支持此类型的视频"),void this.$refs.upload.clearFiles();this.$emit("update:onUploadVideo",!0);var n=Object(r.a)(this.videoList);n.push({name:t.name,url:t.url,videoPercent:0}),this.$emit("videoChange",{key:"videoList",value:n}),this.getSignature((function(r){new o.default({getSignature:r}).upload({mediaFile:t.raw}).on("media_progress",(function(t){n[0].videoPercent=t.percent,e.$emit("videoChange",{key:"videoList",value:n})})).done().then((function(t){e.postVideo(t.fileId)}))}))}},videoTypeCheck:function(t){var e=t.name.split(".")[t.name.split(".").length-1].toLowerCase();return!("m3u8"===e||this.typesLimit.indexOf(e.toLowerCase())<0)},getSignature:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$store.dispatch("jv/get",["signature",{}]).then((function(e){t((function(){return e.signature}))}))},postVideo:function(t){var e=this,n={_jv:{type:"thread/video"},file_id:t};this.$store.dispatch("jv/post",n).then((function(data){var t=Object(r.a)(e.videoList);t[0].id=data.file_id,e.$emit("videoChange",{key:"videoList",value:t})}),(function(t){return e.handleError(t)})).finally((function(){e.$emit("update:onUploadVideo",!1)}))},handleError:function(){this.$emit("update:onUploadVideo",!1),this.$message.error(this.$t("post.videoUploadFail"))}}},l=(n(708),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.videoList[0]?n("div",{staticClass:"video-upload"},[n("video",{ref:"video",staticClass:"video",attrs:{src:t.videoList[0].url,controls:!1}}),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{url:t.videoList[0].url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e(),t._v(" "),n("svg-icon",{staticClass:"icon-play",staticStyle:{"font-size":"30px"},attrs:{type:"video-play"},on:{click:function(e){t.showVideoPop=!0}}}),t._v(" "),n("svg-icon",{staticClass:"icon-delete",staticStyle:{"font-size":"22px"},attrs:{type:"delete-red"},on:{click:t.handleVideoRemove}}),t._v(" "),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.videoList[0].videoPercent<1,expression:"videoList[0].videoPercent < 1"}],staticClass:"progress",attrs:{percentage:100*t.videoList[0].videoPercent,color:"#25A9F6","show-text":!1}})],1):t._e(),t._v(" "),n("el-upload",{directives:[{name:"show",rawName:"v-show",value:!t.videoList[0],expression:"!videoList[0]"}],ref:"upload",staticClass:"image-upload",attrs:{"list-type":"picture-card",accept:t.typesLimit,action:"","auto-upload":!1,limit:1,disabled:t.videoList.length>0,"on-change":t.addVideo,"on-error":t.handleError}},[n("i",{staticClass:"el-icon-plus"})])],1)}),[],!1,null,"3be5bd55",null);e.default=component.exports;installComponents(component,{VideoPop:n(305).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(9);var r=n(1),o=n.n(r),c=n(45),l=n.n(c),d=n(65),h=n.n(d),m=n(84),f=n.n(m),v=n(32),_=n.n(v),y=n(49),w=n(273),C=n.n(w),$={name:"CommentList",mixins:[o.a,_.a,h.a,f.a,l.a],props:{commentList:{type:Array,default:function(){return[]}},threadId:{type:String,default:""}},data:function(){return{replyList:[],onReplyPublish:!1,showReplyEditorForIndex:-1,replyPost:{text:"",imageList:[],attachedList:[]},replyType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的评论 ..."},showAllReply:!1,replyLoading:!1,isShield:!1,commentId:""}},watch:{commentList:{handler:function(t){this.showAllReply||(this.replyList=t.map((function(t){return t.lastThreeComments})))},deep:!0,immediate:!0}},methods:{formatDate:function(t){return C()(t).format("YYYY-MM-DD HH:mm")},formatSummary:function(t){var html;return html=t.content!==t.summaryText?t.summary+'<button class="showAllComment">'.concat(this.$t("topic.all"),"</button>"):t.contentHtml,y.a.parse(html)},showAll:function(t,e){t.target.matches(".showAllComment")&&this.$router.push("/thread/comment?threadId=".concat(this.threadId,"&commentId=").concat(e._jv.id))},replyPublish:function(t){var e=this;if(this.isLogin()){if(!this.replyPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.replyPost.text.length>this.replyType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onReplyPublish=!0;var n={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:this.threadId}}}},isComment:!0,replyId:t,content:this.replyPost.text};return this.publishPostResource(n,this.replyPost),this.$store.dispatch("jv/post",n).then((function(n){e.replyPost.text="",e.replyPost.imageList=[],e.showReplyEditorForIndex=-1,e.postLegalityCheck(n,e.$t("topic.replyPublishSuccess")),e.$emit("replyPublish",t)}),(function(t){return e.handleError(t)})).finally((function(){e.onReplyPublish=!1}))}},toShield:function(t){this.isShield=!0,this.commentId=t}}},k=(n(780),n(0)),component=Object(k.a)($,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.commentList,(function(e,r){return n("div",{key:r,staticClass:"comment"},[n("div",{staticClass:"title"},[n("avatar-component",{attrs:{author:e.user,size:45}},[t._v("\n        "+t._s(t.timerDiff(e.updatedAt)+t.$t("topic.before"))+"..\n      ")]),t._v(" "),n("div",{staticClass:"management"},[e.canEdit?n("div",{staticClass:"manage-button",on:{click:function(n){return t.$emit("editComment",e)}}},[t._v(t._s(t.$t("topic.edit")))]):t._e(),t._v(" "),e.canHide?n("div",{staticClass:"manage-button",on:{click:function(n){return t.$emit("deleteComment",e._jv.id)}}},[t._v(t._s(t.$t("topic.delete")))]):t._e(),t._v(" "),0===e.isApproved?n("div",{staticClass:"checking"},[t._v(t._s(t.$t("topic.inReview")))]):t._e()])],1),t._v(" "),n("div",{staticClass:"container-detail"},[n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(t.formatSummary(e)))},on:{click:function(n){return t.showAll(n,e)}}}),t._v(" "),e.images&&e.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images"},t._l(e.images,(function(image,t){return n("el-image",{key:t,staticStyle:{width:"100px",height:"100px","border-radius":"5px","margin-right":"10px"},attrs:{src:image.thumbUrl,alt:image.filename,"data-source":image.url,fit:"cover"}})})),1):t._e(),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.isApproved,expression:"comment.isApproved === 1"}],staticClass:"actions"},[n("div",{staticClass:"left"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.canLike,expression:"comment.canLike"}],on:{click:function(n){return t.$emit("like",{comment:e,index:r})}}},[n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:e.isLiked?"liked":"like"}}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.like"))+" "+t._s(e.likeCount>0?e.likeCount:""))])],1),t._v(" "),n("span",{on:{click:function(e){t.showReplyEditorForIndex=t.showReplyEditorForIndex===r?-1:r}}},[n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"comment"}}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.replyTa")))])],1),t._v(" "),n("span",[e.replyCount>0?n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.replyAlready")+" "+e.replyCount))]):t._e()])]),t._v(" "),n("div",{staticClass:"report",on:{click:function(n){return t.toShield(e._jv.id)}}},[t._v(t._s(t.$t("report.reportTitle")))])])]),t._v(" "),t.showReplyEditorForIndex===r?n("editor",{staticClass:"reply-editor",staticStyle:{"margin-top":"0","margin-bottom":"20px"},attrs:{"editor-style":"reply",selector:"reply-editor","type-information":t.replyType,post:t.replyPost,"on-publish":t.onReplyPublish},on:{"update:post":function(e){t.replyPost=e},publish:function(n){return t.replyPublish(e._jv.id)}}}):t._e(),t._v(" "),n("div",{staticClass:"reply-list",on:{click:function(n){return t.$router.push("/thread/comment?threadId="+t.threadId+"&commentId="+e._jv.id+"#reply")}}},[t._l(t.replyList[r],(function(r,o){return n("div",{key:o,staticClass:"reply"},[n("div",{staticClass:"title"},[n("Avatar",{attrs:{user:r.user||{},size:"30"}}),t._v(" "),n("div",{staticClass:"title-info"},[n("span",{staticClass:"author-name"},[t._v(t._s(r.user?r.user.username:""))]),t._v(" "),n("span",{staticClass:"text reply"},[t._v(t._s(t.$t("topic.reply")))]),t._v(" "),n("span",{staticClass:"text comment-author"},[t._v(t._s(e.user?e.user.username:"")+"   ")]),t._v(" "),n("span",{staticClass:"timer"},[t._v(t._s(t.formatDate(r.updatedAt)))]),t._v(" "),r.canHide?n("span",{staticClass:"delete-reply",on:{click:function(n){return n.stopPropagation(),t.$emit("deleteReply",{replyId:r._jv.id,commentId:e._jv.id})}}},[t._v(t._s(t.$t("topic.delete")))]):t._e()])],1),t._v(" "),n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(r.summary))},on:{click:function(e){return t.showAll(e,o,t.replyList)}}}),t._v(" "),r.images&&r.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images",on:{click:function(t){t.stopPropagation()}}},t._l(r.images,(function(image,t){return n("el-image",{key:t,staticStyle:{width:"100px",height:"100px","border-radius":"5px","margin-right":"10px","margin-bottom":"10px"},attrs:{src:image.thumbUrl,alt:image.filename,"data-source":image.url,fit:"cover"}})})),1):t._e(),t._v(" "),n("div",{staticClass:"line"})])})),t._v(" "),e.replyCount>3?n("div",[e.replyCount!==(t.replyList[r]||[]).length?n("div",{staticClass:"show-all-reply"},[t._v("\n          "+t._s(t.$t("topic.showOther"))+" "+t._s(e.replyCount-3)+" "+t._s(t.$t("topic.item")+t.$t("topic.reply"))+"\n        ")]):t._e()]):t._e()],2)],1)})),t._v(" "),t.isShield?n("topic-report",{attrs:{"thread-id":t.threadId,type:2,"comment-id":t.commentId},on:{close:function(e){t.isShield=!1}}}):t._e()],2)}),[],!1,null,"372a3b20",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,SvgIcon:n(11).default,Editor:n(88).default,Avatar:n(20).default,TopicReport:n(376).default})},function(t,e,n){"use strict";n.r(e);n(24);var r=n(31),o=n(1),c=n.n(o),l=n(95),d=["DOC","DOCX","PDF","PPT","TXT","XLS","XLSX"],h={name:"AttachmentList",mixins:[c.a],props:{file:{type:Object,default:function(){}},isPaid:{type:Boolean,default:!1},price:{type:[Number,String],default:0},isPaidAttachment:{type:Boolean,default:!1},attachmentPrice:{type:[Number,String],default:0}},data:function(){return{dialogVisible:!1,previewData:{},previewUrl:"",previewPage:1,previewTotal:1,loading:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},unpaid:function(){return parseFloat(this.price)>0&&!this.isPaid||parseFloat(this.attachmentPrice)>0&&!this.isPaidAttachment},canReview:function(){return this.forums&&this.forums.qcloud&&this.forums.qcloud.qcloud_cos&&this.forums.qcloud.qcloud_cos_doc_preview&&this.isPreviewType(this.file.extension)&&(0===parseFloat(this.price)&&parseFloat(this.attachmentPrice)>0&&this.isPaidAttachment||parseFloat(this.price)>0&&this.isPaid)&&this.file.isRemote}},methods:{downloadAttachment:function(t){this.unpaid||window.open(t,"_self")},extensionValidate:function(t){return l.extensionList.indexOf(t.toUpperCase())>0?t.toUpperCase():"UNKNOWN"},isPreviewType:function(t){return-1!==d.indexOf(this.extensionValidate(t))},preview:function(t){this.previewUrl=t,this.getPreviewData()},getPreviewData:function(){var t=this;this.dialogVisible=!0,this.loading=!0,Object(r.a)({url:"".concat(this.previewUrl,"&page=").concat(this.previewPage),method:"get"}).then((function(e){t.loading=!1,200===e.status&&e.data&&e.data.data&&+e.data.data["X-Total-Page"]>0?(t.previewData=e.data.data,t.previewTotal=e.data.data["X-Total-Page"]):t.dialogVisible=!1}),(function(e){t.dialogVisible=!1,t.loading=!1,t.handleError(e)}))},prev:function(){this.previewPage-=1,this.getPreviewData()},next:function(){this.previewPage+=1,this.getPreviewData()}}},m=(n(743),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"attachment-item",on:{click:function(e){return e.target!==e.currentTarget?null:t.downloadAttachment(t.file.url,t.file.fileName)}}},[n("div",{staticClass:"info"},[n("div",[n("svg-icon",{staticStyle:{"font-size":"18px","vertical-align":"middle"},attrs:{type:t.extensionValidate(t.file.extension)}}),t._v(" "),n("span",{staticClass:"file-name"},[t._v(t._s(t.file.fileName))])],1),t._v(" "),n("span",{staticClass:"size"},[t._v(t._s(parseInt((t.file.fileSize/1024).toString()).toLocaleString())+" KB")])]),t._v(" "),n("div",{staticClass:"action"},[t.unpaid?n("span",[t._v(t._s(t.$t("post.paidAfterDownload")))]):n("div",[t.canReview?n("span",{staticClass:"download",on:{click:function(e){return e.target!==e.currentTarget?null:t.preview(t.file.url)}}},[t._v(t._s(t.$t("post.preview")))]):t._e(),t._v(" "),n("span",{staticClass:"download",on:{click:function(e){return e.target!==e.currentTarget?null:t.downloadAttachment(t.file.url,t.file.fileName)}}},[t._v(t._s(t.$t("post.download")))])])]),t._v(" "),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.dialogVisible,"show-close":!1,top:"5vh",width:"800px","element-loading-background":"transparent"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticClass:"dialog-cont"},[n("img",{staticClass:"img",attrs:{src:t.previewData.image,alt:""}})]),t._v(" "),n("div",{staticClass:"pagination",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{class:{hidden:1===t.previewPage},attrs:{type:"primary",size:"medium"},on:{click:t.prev}},[t._v(t._s(t.$t("post.prev")))]),t._v(" "),n("div",{staticClass:"pages"},[t._v(t._s(t.previewPage)+" / "+t._s(t.previewTotal))]),t._v(" "),n("el-button",{class:{hidden:parseInt(t.previewPage)>=parseInt(t.previewTotal)},attrs:{size:"medium",type:"primary"},on:{click:t.next}},[t._v(t._s(t.$t("post.next")))])],1)])],1)}),[],!1,null,"2b2f5713",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={name:"PasswordInput",props:{error:{type:Boolean,default:!1}},data:function(){return{password:""}},watch:{error:function(t){t&&(this.password="")}},mounted:function(){document.addEventListener("keyup",this.onInput)},methods:{onInput:function(t){if(["0","1","2","3","4","5","6","7","8","9"].indexOf(t.key)>=0&&(this.password+=t.key,this.$emit("type")),6===this.password.length)return this.$emit("password",this.password);this.password.length>6&&(this.password=this.password.substring(0,6)),"Backspace"===t.key&&(this.password=this.password.substr(0,this.password.length-1))}}},o=(n(751),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"code"},t._l(6,(function(e,r){return n("span",{key:r,class:{"code-item":!0,filled:t.password[r],error:t.error}},[t._v(t._s(t.password[r]?"*":" "))])})),0)}),[],!1,null,"b0d1d7ca",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);n(18),n(24);var r=n(32),o=n.n(r),c=n(1),l={name:"AsideHeader",mixins:[n.n(c).a,o.a],props:{author:{type:Object,default:function(){}},billboard:{type:Array,default:function(){return[]}},followStatus:{type:Number,default:0},canOpera:{type:Boolean,default:!1},followLoading:{type:Boolean,default:!1}},data:function(){return{dialog:{id:"",name:""},chatting:!1}},watch:{author:{handler:function(){this.getAuthorInfo()}},deep:!0},mounted:function(){this.getAuthorInfo()},methods:{getAuthorInfo:function(){var t=this;if(this.author.id&&(!this.author.id||-1!==this.author.id))return this.$store.dispatch("jv/get",["users/".concat(this.author._jv.id),{params:{include:"groups,dialog"}}]).then((function(e){e.dialog&&(t.dialog.id=e.dialog._jv.id),t.dialog.name=t.author.username}),(function(e){return t.handleError(e)}))},openChatBox:function(){this.chatting=!0},toprofile:function(t){this.$router.push("/user/".concat(this.author._jv.id,"?current=").concat(t+1))}}},d=(n(747),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"author"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("topic.aboutAuthor")))]),t._v(" "),n("avatar-component",{staticClass:"author-info",attrs:{author:t.author}},[t._v("\n    "+t._s(t.$t("topic.activeAt"))+" "+t._s(t.timerDiff(t.author.updatedAt))+t._s(t.$t("topic.before"))+"\n  ")]),t._v(" "),n("div",{staticClass:"signature"},[t._v(t._s(t.author.signature))]),t._v(" "),n("div",{staticClass:"container-billBoard"},t._l(t.billboard,(function(e,r){return n("div",{key:r,staticClass:"billBoard-item",on:{click:function(e){return t.toprofile(r)}}},[n("div",{staticClass:"text"},[t._v(t._s(e.text))]),t._v(" "),n("div",{staticClass:"count"},[t._v(t._s(e.count))])])})),0),t._v(" "),t.canOpera?n("div",{staticClass:"buttons"},[n("el-button",{attrs:{type:"primary",loading:t.followLoading},on:{click:function(e){0===t.followStatus?t.$emit("follow"):t.$emit("unFollow")}}},[t._v("\n      "+t._s(0===t.followStatus?"+ "+t.$t("profile.following"):1===t.followStatus?t.$t("profile.followed"):t.$t("profile.mutualfollow"))+"\n    ")]),t._v(" "),n("el-button",{on:{click:t.openChatBox}},[t._v(t._s(t.$t("topic.sendMessage")))])],1):t._e(),t._v(" "),t.chatting?n("chat-box",{attrs:{dialog:t.dialog||{}},on:{close:function(e){t.chatting=!1}}}):t._e()],1)}),[],!1,null,"622ccbec",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,ChatBox:n(300).default})},,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);n(9),n(16);var r=n(8),o=n(1),c=n.n(o),head=n(10),l=n.n(head),time=n(21),d={layout:"center_layout",name:"SiteInfo",mixins:[c.a,l.a],data:function(){return{title:this.$t("manage.circleinfo"),userId:this.$store.state.user.info.id,groupsId:"",inputInfo:"",isModify:!1,loading:!1,permissionList:[]}},computed:{forums:function(){var t=this.$store.state.site.info.attributes;return t},userInfo:function(){return this.$store.state.user.info.attributes||{}}},mounted:function(){this.inputInfo=this.forums&&this.forums.set_site&&this.forums.set_site.site_introduction,this.groupsId=this.forums&&this.forums.user&&this.forums.user.groups&&this.forums.user.groups.length>0&&this.forums.user.groups[0].id,this.getPermissions(),this.reloadForums()},methods:{reloadForums:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("site/getSiteInfo");case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))()},handleModify:function(){this.isModify=!this.isModify,this.isModify&&(this.inputInfo=this.forums&&this.forums.set_site&&this.forums.set_site.site_introduction)},confirmModify:function(){var t=this;if(!this.loading){var e={data:[{attributes:{key:"site_introduction",value:this.inputInfo,tag:"default"}}]};this.loading=!0,this.$store.dispatch("jv/post",[{_jv:{type:"settings"}},{data:e}]).then(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("site/getSiteInfo");case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:t.isModify=!1,t.$message.success(t.$t("discuzq.msgBox.modifySuccess"));case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).catch((function(e){t.handleError(e)})).finally((function(){t.loading=!1}))}},getPermissions:function(){var t=this;this.$store.dispatch("jv/get",["groups",{params:{"filter[type]":"invite",include:["permission"]}}]).then((function(e){var n=t.forums&&t.forums.user&&t.forums.user.groups&&t.forums.user.groups.length>0&&t.forums.user.groups[0].id,r=[];e.forEach((function(t){+t._jv.id==+n&&(r=(r=t.permission).filter((function(t){return"createThread"!==t.permission})))})),t.permissionList=r.filter((function(t){return"user.edit"!==t.permission}))}))},handleExpiredAt:function(t){return t?t.substr(0,10):this.$t("site.permanent")},handleDays:function(t){var e=Math.round(new Date(t)/1e3);return Object(time.c)(e)}}},h=(n(669),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"site-info-container"},[t.forums?r("div",[r("img",{staticClass:"logo",attrs:{src:t.forums.set_site&&t.forums.set_site.site_logo?t.forums.set_site.site_logo:n(290),alt:"logo"}}),t._v(" "),r("div",{staticClass:"site-info"},[r("div",{staticClass:"avatar"},[t.forums.set_site&&t.forums.set_site.site_author?r("avatar",{attrs:{user:{id:t.forums.set_site.site_author.id,username:t.forums.set_site.site_author.username,avatarUrl:t.forums.set_site.site_author.avatar},size:40,round:!0}}):r("avatar",{attrs:{user:{id:0,username:"无",avatarUrl:""},"prevent-jump":!0,size:40,round:!0}}),t._v(" "),t.forums.set_site&&t.forums.set_site.site_author?r("div",{staticClass:"right"},[r("div",{staticClass:"label"},[t._v(t._s(t.$t("site.circlemaster")))]),t._v(" "),r("div",{staticClass:"value name text-hidden"},[t._v(t._s(t.forums.set_site&&t.forums.set_site.site_author.username))])]):t._e()],1),t._v(" "),r("div",{staticClass:"member"},[r("div",{staticClass:"label"},[t._v(t._s(t.$t("home.theme")))]),t._v(" "),r("div",{staticClass:"value"},[t._v(t._s(t.forums.other&&t.forums.other.count_users))])]),t._v(" "),r("div",{staticClass:"threads"},[r("div",{staticClass:"label"},[t._v(t._s(t.$t("manage.contents")))]),t._v(" "),r("div",{staticClass:"value"},[t._v(t._s(t.forums.other&&t.forums.other.count_threads))])]),t._v(" "),r("div",{staticClass:"create-time"},[r("div",{staticClass:"label"},[t._v(t._s(t.$t("manage.creationtime")))]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_install?r("div",{staticClass:"value"},[t._v("\n          "+t._s((t.forums.set_site&&t.forums.set_site.site_install).substr(0,10))+"\n        ")]):t._e()])]),t._v(" "),r("div",{staticClass:"site-detail"},[r("div",{staticClass:"header"},[r("div",{staticClass:"title base-font-size"},[t._v(t._s(t.$t("manage.siteintroduction")))]),t._v(" "),1==+t.groupsId?r("div",{staticClass:"modify",on:{click:t.handleModify}},[t._v("\n          "+t._s(t.$t("profile.modify"))+"\n        ")]):t._e()]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_introduction?r("div",{staticClass:"content base-font-size"},[t._v("\n        "+t._s(t.forums.set_site.site_introduction)+"\n      ")]):r("div",{staticClass:"content base-font-size grey-color"},[t._v(t._s(t.$t("modify.noSiteInfo")))]),t._v(" "),r("el-dialog",{attrs:{title:t.$t("modify.modifySiteInfo"),visible:t.isModify,width:"620px","custom-class":"custom-dialog","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){t.isModify=e}}},[r("div",{staticClass:"dialog-main"},[r("el-input",{staticClass:"custom-input",attrs:{type:"textarea",rows:5,placeholder:t.$t("modify.siteInfoPlaceholder")},model:{value:t.inputInfo,callback:function(e){t.inputInfo=e},expression:"inputInfo"}})],1),t._v(" "),r("div",{staticClass:"dialog-footer"},[r("el-button",{attrs:{type:"primary",size:"medium",loading:t.loading},on:{click:t.confirmModify}},[t._v("\n            "+t._s(t.$t("discuzq.ok"))+"\n          ")]),t._v(" "),r("el-button",{attrs:{size:"medium"},on:{click:function(e){t.isModify=!1}}},[t._v("\n            "+t._s(t.$t("discuzq.msgBox.cancel"))+"\n          ")])],1)])],1),t._v(" "),t.forums&&t.forums.set_site?r("div",{staticClass:"circlemode"},[r("div",{staticClass:"title base-font-size"},[t._v(t._s(t.$t("site.circlemode"))+" \\ "+t._s(t.$t("site.price")))]),t._v(" "),t.forums.set_site&&"public"===t.forums.set_site.site_mode?r("div",{staticClass:"content base-font-size grey-color"},[t._v("\n        "+t._s(t.$t("site.publicmode"))+" \\ "+t._s(t.$t("post.free"))+"\n      ")]):r("div",{staticClass:"content base-font-size grey-color"},[t._v("\n        "+t._s(t.$t("site.paymentmode"))+" \\ "+t._s(t.$t("post.yuanItem"))+t._s(t.forums.set_site.site_price)+"\n        （"+t._s(t.forums.set_site.site_expire?t.$t("site.periodvalidity")+t.forums.set_site.site_expire+t.$t("site.day"):t.$t("site.permanent"))+"）\n      ")])]):t._e(),t._v(" "),r("div",{staticClass:"permission"},[r("div",{staticClass:"title base-font-size"},[t._v(t._s(t.$t("manage.myRole"))+" \\ "+t._s(t.$t("site.permission")))]),t._v(" "),t.userInfo?r("div",{staticClass:"user-detail"},[r("div",{staticClass:"avatar"},[r("avatar",{attrs:{user:{id:t.userInfo.id,username:t.userInfo.username,avatarUrl:t.userInfo.avatarUrl},"prevent-jump":!0,size:50,round:!0}})],1),t._v(" "),r("div",{staticClass:"user-info"},[r("div",{staticClass:"name base-font-size"},[t._v(t._s(t.userInfo.username))]),t._v(" "),r("div",{staticClass:"role"},[t._v("\n            "+t._s(t.$t("site.role"))+"\n            "+t._s(t.forums.user&&t.forums.user.groups&&t.forums.user.groups.length>0&&t.forums.user.groups[0].name||"")+"\n          ")]),t._v(" "),t.userInfo.joinedAt?r("div",{staticClass:"join-time"},[t._v("\n            "+t._s(t.$t("manage.joinedTime"))+" "+t._s(t.userInfo.joinedAt.substr(0,10))+"\n            "),t.forums&&"pay"===t.forums.set_site.site_mode?[t._v("\n              ,"+t._s(t.$t("site.periodvalidity")+t.$t("site.to")+t.handleExpiredAt(t.userInfo.expiredAt))+"\n              ")]:t._e()],2):t._e(),t._v(" "),r("div",{staticClass:"permission-list"},t._l(t.permissionList,(function(e,n){return r("div",{key:n,staticClass:"item"},[t._v("\n              "+t._s(t.$t("permission."+e.permission))+"\n            ")])})),0)])]):t._e()])]):t._e()])}),[],!1,null,"5a0b12ba",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22);var r=n(7),o=(n(19),n(9),n(25),n(12)),c=(n(16),n(8)),l=n(49),d=n(1),h=n.n(d),m=n(27);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",y={layout:"custom_layout",name:"Index",mixins:[h.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,h,f,y,w,C,$,k,x,j;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,t.query,m.a.isSpider||e(null,{}),o={"filter[isSticky]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no","page[number]":1,include:"firstPost"},c={include:_,"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","page[number]":1,"page[limit]":10},l={include:"groups",limit:4},n.prev=5,d={},n.next=9,r.dispatch("site/getSiteInfo");case 9:return h=n.sent,n.next=12,r.dispatch("jv/get",["threads",{params:o}]);case 12:return f=n.sent,n.next=15,r.dispatch("jv/get",["threads",{params:c}]);case 15:return y=n.sent,n.next=18,r.dispatch("jv/get",["categories",{}]);case 18:return w=n.sent,n.next=21,r.dispatch("jv/get",["users/recommended",{params:l}]);case 21:C=n.sent,h&&h.attributes&&h.attributes.set_site&&(d.headTitle=h.attributes.set_site.site_title||h.attributes.set_site.site_name||"Discuz! Q",d.headKeywords=h.attributes.set_site.site_keywords,d.headDesc=h.attributes.set_site.site_introduction),Array.isArray(f)?d.threadsStickyData=f:f&&f._jv&&f._jv.json&&(($=f._jv.json.data||[]).forEach((function(t,e){$[e]=v(v(v({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,jv:{id:t.id}})})),d.threadsStickyData=$),Array.isArray(y)?d.threadsData=y:y&&y._jv&&y._jv.json&&((k=y._jv.json.data||[]).forEach((function(t,e){k[e]=v(v(v({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),d.threadsData=k),Array.isArray(w)?d.categoryData=w:w&&w._jv&&w._jv.json&&((x=w._jv.json.data||[]).forEach((function(t,e){x[e]=v(v(v({},t),t.attributes),{},{_jv:{id:t.id}})})),d.categoryData=x),Array.isArray(C)?d.recommendUserData=C:C&&C._jv&&C._jv.json&&((j=C._jv.json.data||[]).forEach((function(t,e){j[e]=v(v({},t),t.attributes)})),d.recommendUserData=j),e(null,d),n.next=33;break;case 30:n.prev=30,n.t0=n.catch(5),e(null,{_error__abc:{error_keys:Object.keys(n.t0),error:String(n.t0),errno:n.t0.errno,code:n.t0.code,syscall:n.t0.syscall,address:n.t0.address,port:n.t0.port,config:n.t0.config,request_domain:(n.t0.request||{}).domain,request_keys:Object.keys(n.t0.request||{}),response_keys:Object.keys(n.t0.response||{})}});case 33:case"end":return n.stop()}}),n,null,[[5,30]])})))()},data:function(){return{loading:!1,threadsStickyData:[],threadsData:[],categoryData:[],recommendUserData:[],pageNum:1,pageSize:10,threadType:"",sort:"",threadEssence:"",fromUserId:"",hasMore:!1,timer:null,threadCount:0,total:0,headTitle:"‎",headKeywords:"",headDesc:"",currentAudioId:""}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")},forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{forums:{handler:function(t){t&&t.set_site&&(this.headTitle=t.set_site.site_title||t.set_site.site_name||"Discuz! Q",this.headKeywords=t.set_site.site_keywords,this.headDesc=t.set_site.site_introduction)},deep:!0}},mounted:function(){var t=this;this.forums&&this.forums.set_site&&(this.headTitle=this.forums.set_site.site_title||this.forums.set_site.site_name||"Discuz! Q",this.headKeywords=this.forums.set_site.site_keywords,this.headDesc=this.forums.set_site.site_introduction),0===this.threadsStickyData.length&&this.getThreadsSticky(),0===this.threadsData.length?this.getThreadsList():(this.threadsData.length===this.pageSize&&(this.hasMore=!0),this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t.autoLoadThreads()}),3e4))},destroyed:function(){clearInterval(this.timer)},methods:{getThreadsSticky:function(){var t=this;this.threadsStickyData=[];this.$store.dispatch("jv/get",["threads",{params:{"filter[isSticky]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no",include:["firstPost"]}}]).then((function(data){t.threadsStickyData=Object(r.a)(data)}))},getThreadsList:function(){var t=this;this.loading=!0;var e={include:_,"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[fromUserId]":this.fromUserId,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize};null!==this.threadType&&(e["filter[type]"]=this.threadType),this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){t.hasMore=data.length===t.pageSize;var e=data&&data._jv&&data._jv.json&&data._jv.json.meta&&data._jv.json.meta.threadCount||0;1===t.pageNum?(t.threadsData=data,t.threadCount=e):t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(data)),data&&data._jv&&(t.hasMore=t.threadsData.length<e),t.pageNum+=1,t.timer&&clearInterval(t.timer),t.timer=setInterval((function(){t.autoLoadThreads()}),3e4)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getThreadsList()},autoLoadThreads:function(){var t=this,e={"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[fromUserId]":this.fromUserId,"page[limit]":1};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){if(data&&data._jv){var e=data._jv.json&&data._jv.json.meta&&data._jv.json.meta.threadCount||0;t.threadCount>0&&(t.total=e-t.threadCount>0?e-t.threadCount:0)}}))},reloadThreadsList:function(){this.pageNum=1,this.total=0,this.threadsData=[],this.getThreadsList()},onChangeCategory:function(t){0!==t&&this.$router.push("/category/".concat(t))},onChangeFilter:function(t){this.threadEssence="",this.fromUserId="","isEssence"===t?this.threadEssence="yes":"followed"===t&&(this.fromUserId=this.userId),this.reloadThreadsList()},onChangeType:function(t){this.threadType=t,this.reloadThreadsList()},onChangeSort:function(t){this.sort=t,this.reloadThreadsList()},formatRichText:function(html){return l.a.parse(html)},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}},head:function(){return{title:this.headTitle,meta:[{hid:"keywords",name:"keywords",content:this.headKeywords},{hid:"description",name:"description",content:this.headDesc}]}}},w=(n(788),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("index-filter",{on:{onChangeFilter:t.onChangeFilter,onChangeType:t.onChangeType,onChangeSort:t.onChangeSort}}),t._v(" "),t.threadsStickyData.length>0?n("div",t._l(t.threadsStickyData,(function(e,r){return n("div",{key:r,staticClass:"list-top-item"},[n("div",{staticClass:"top-label"},[t._v(t._s(t.$t("home.sticky")))]),t._v(" "),n("nuxt-link",{staticClass:"top-title",attrs:{to:"/thread/"+(e._jv&&e._jv.id),target:"_blank"}},[1===e.type?[t._v("\n            "+t._s(e.title)+"\n          ")]:n("span",{domProps:{innerHTML:t._s(t.$xss(t.formatRichText(e.firstPost&&e.firstPost.summary)))}})],2)],1)})),0):t._e(),t._v(" "),t.total>0?n("div",{staticClass:"new-post"},[n("div",{staticClass:"new-post-cont"},[t._v("\n        "+t._s(t.$t("home.hasNewContent",{total:t.total}))+"\n        "),n("span",{staticClass:"refresh",on:{click:t.reloadThreadsList}},[t._v(t._s(t.$t("home.clickRefresh")))])])]):t._e(),t._v(" "),t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})],2),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"category background-color"},[n("category",{attrs:{list:t.categoryData},on:{onChange:t.onChangeCategory}})],1),t._v(" "),n("div",{staticClass:"background-color"},[n("advertising")],1),t._v(" "),n("div",{staticClass:"background-color"},[n("recommend-user",{attrs:{list:t.recommendUserData}})],1),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])}),[],!1,null,"7a81dccb",null);e.default=component.exports;installComponents(component,{IndexFilter:n(365).default,PostItem:n(57).default,ListLoadMore:n(40).default,Category:n(136).default,Advertising:n(62).default,RecommendUser:n(89).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);var r={layout:"error_layout"},o=(n(789),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("svg-icon",{staticStyle:{"font-size":"100px"},attrs:{type:"alert"}}),t._v(" "),n("h1",{staticClass:"tip"},[t._v(t._s(t.$t("core.page_not_found")))]),t._v(" "),n("span",{staticClass:"detail"},[t._v(t._s(t.$t("core.page_not_found_detail")))]),t._v(" "),n("NuxtLink",{attrs:{to:"/"}},[n("button",[t._v("\n      "+t._s(t.$t("core.back_home"))+"\n    ")])])],1)}),[],!1,null,"0d985e31",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r=n(419),o={data:function(){return{info:"",imageList:[]}},mounted:function(){var t=this;r&&(this.contentEditor=new r("vditor",{icon:"material",mode:"wysiwyg",toolbarConfig:{pin:!0},cache:{enable:!1},after:function(){t.contentEditor.setValue("hello, Vditor + Vue!")}}));this.$store.dispatch("jv/get",{_jv:{type:"users?page[limit]=4"},include:"groups"}).then((function(data){}))},destroyed:function(){this.contentEditor&&this.contentEditor.destroy()},methods:{onSuccess:function(t){this.imageList=t},onRemove:function(t){this.imageList=t},getData:function(){var t=this;this.$store.dispatch("jv/get",{_jv:{type:"forum"}}).then((function(data){t.info=data}))},storeCommit:function(){this.$store.commit("demo/increment")}}},c=(n(662),n(0)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-button",[t._v("默认按钮")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.getData}},[t._v("获取数据")]),t._v(" "),n("el-button",{attrs:{type:"success"}},[t._v("成功按钮")]),t._v(" "),n("el-button",{attrs:{type:"info"}},[t._v("信息按钮")]),t._v(" "),n("el-button",{attrs:{type:"warning"}},[t._v("警告按钮")]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:t.storeCommit}},[t._v("store commit")]),t._v(" "),n("div",{attrs:{id:"vditor"}}),t._v(" "),n("p",[t._v("svg")]),t._v(" "),n("div",[n("svg-icon",{staticStyle:{"font-size":"100px"},attrs:{type:"alipay"}})],1),t._v(" "),n("p",[t._v("store commit")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.storeCommit}},[t._v("store commit")]),t._v(" "),n("div",{staticStyle:{"margin-top":"100px"}},[n("my-upload",{attrs:{accept:"image/*",action:"/attachments","file-list":t.imageList,"size-limit":1048576,limit:9},on:{success:t.onSuccess,remove:t.onRemove}})],1)],1)}),[],!1,null,"c724a6fe",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(9);var time=n(21),head=n(10),r={layout:"center_layout",name:"InviteExtension",filters:{formatDate:function(t){return Object(time.b)(t)}},mixins:[n.n(head).a],data:function(){return{title:this.$t("invite.invite"),loading:!1,activeName:"invited",isShowDetail:!1,detail:{},pageNum:1,pageSize:10,total:0,detailTotalMoney:0,detailUserId:"",incomeDetailList:[]}},computed:{userId:function(){return this.$store.state.user.info.id}},mounted:function(){},methods:{viewDetail:function(t){this.detail=t,this.isShowDetail=!0,this.detailUserId=t.user_id,this.getIncomeDetailList()},getIncomeDetailList:function(){var t=this;if(this.userId){this.loading=!0;var e={include:"sourceUser","filter[user]":this.userId,"filter[change_type]":"33, 62, 34","page[number]":this.pageNum,"page[limit]":this.pageSize,sort:this.sort,"filter[source_user_id]":this.detailUserId};this.$store.dispatch("jv/get",["wallet/log",{params:e}]).then((function(e){e&&e._jv&&e._jv.json&&e._jv.json.meta&&(t.detailTotalMoney=e._jv.json.meta.sumChangeAvailableAmount,t.total=e._jv.json.meta.total),t.incomeDetailList=e}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))}},sortChange:function(t){var e=t.order;this.sort="descending"===e?"-created_at":"ascending"===e?"created_at":"",this.getIncomeDetailList()},handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getIncomeDetailList()},handleCurrentChange:function(t){this.pageNum=t,this.getIncomeDetailList()}}},o=(n(663),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"invite-container"},[t.isShowDetail?[t.detail&&t.detail.user?n("header",{staticClass:"detail-header"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("invite.userDetail")))]),t._v(" "),n("div",{staticClass:"user"},[n("avatar",{attrs:{user:{id:t.detail.user.id,username:t.detail.user.username,avatarUrl:t.detail.user.avatarUrl},size:50}}),t._v(" "),n("div",{staticClass:"user-info"},[n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+t.detail.user.id}},[t._v("\n            "+t._s(t.detail.user.username)+"\n          ")]),t._v(" "),n("div",{staticClass:"create-at"},[t._v("\n            "+t._s(t.$t("invite.createdAt")+t.$t("discuzq.symbol.colon"))+" "+t._s(t._f("formatDate")(t.detail.created_at))+"\n          ")])],1),t._v(" "),n("div",{staticClass:"total-money"},[n("div",{staticClass:"label"},[t._v(t._s(t.$t("invite.allIncome")))]),t._v(" "),n("div",{staticClass:"value"},[t._v(t._s(t.$t("post.yuanItem")+t.detailTotalMoney))])])],1)]):t._e(),t._v(" "),n("main",[n("div",{staticClass:"main"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.incomeDetailList,"default-sort":{prop:"created_at",order:"descending"}},on:{"sort-change":t.sortChange}},[n("el-table-column",{attrs:{label:t.$t("invite.inviteUserName")},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.sourceUser?n("div",{staticClass:"flex"},[n("avatar",{attrs:{user:{id:e.row.sourceUser.id,username:e.row.sourceUser.username,avatarUrl:e.row.sourceUser.avatarUrl},size:30,round:!0}}),t._v(" "),n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+e.row.sourceUser.id}},[t._v("\n                  "+t._s(e.row.sourceUser.username))])],1):t._e()]}}],null,!1,2955613281)}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:t.$t("invite.incomeAt"),sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("formatDate")(e.row.created_at))+"\n            ")]}}],null,!1,419549433)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("invite.income"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return n("div",{staticClass:"last-table"},[t._v("\n              "+t._s(t.$t("post.yuanItem")+e.row.change_available_amount)+"\n            ")])}}],null,!1,3286361409)})],1)],1),t._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"","hide-on-single-page":"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]:n("div",{staticClass:"invite-cont"},[n("main",[n("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("invite.invitedUser"),name:"invited"}},[n("invited",{on:{"view-detail":t.viewDetail}})],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("invite.incomeDetail"),name:"income"}},[n("income")],1)],1)],1)])],2)}),[],!1,null,"701a46f4",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,Header:n(107).default,Invited:n(819).default,Income:n(821).default})},function(t,e,n){"use strict";n.r(e);n(18);var head=n(10),r={layout:"center_layout",name:"UserManage",mixins:[n.n(head).a],data:function(){return{title:this.$t("manage.siteManagement"),loading:!1,activeName:"manage",groupMap:{},groupInviteList:[]}},computed:{forums:function(){return this.$store.state.site.info.attributes}},watch:{forums:{handler:function(){this.forums&&this.forums.other&&(this.forums.other.can_edit_user_group||this.forums.other.can_edit_user_status||(this.activeName="invite"))},deep:!0}},mounted:function(){this.getGroupList(),this.forums&&this.forums.other&&(this.forums.other.can_edit_user_group||this.forums.other.can_edit_user_status||(this.activeName="invite"))},methods:{getGroupList:function(){var t=this;this.$store.dispatch("jv/get",["groups",{params:{"filter[type]":"invite"}}]).then((function(e){if(e&&e.length>0){var n={};t.groupInviteList=[],e.forEach((function(e){n[e._jv.id]=e.name,t.groupInviteList.push({label:e.name,value:e._jv.id})})),t.groupMap=n}}),(function(e){t.handleError(e)}))}}},o=(n(666),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage-container"},[n("main",[t.forums&&t.forums.other?n("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.forums.other.can_edit_user_group||t.forums.other.can_edit_user_status?n("el-tab-pane",{attrs:{label:t.$t("manage.manageMembers"),name:"manage"}},[n("users-manage",{attrs:{"group-invite-list":t.groupInviteList}})],1):t._e(),t._v(" "),t.forums.other.can_create_invite?n("el-tab-pane",{attrs:{label:t.$t("manage.inviteMembers"),name:"invite"}},["invite"===t.activeName?n("invite-user",{attrs:{"group-map":t.groupMap}}):t._e()],1):t._e()],1):t._e()],1)])}),[],!1,null,"709cb874",null);e.default=component.exports;installComponents(component,{UsersManage:n(792).default,InviteUser:n(794).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(28),n(13)),head=n(10),c=n.n(head),l=n(1),d=n.n(l),h=n(55),m=n.n(h),f={name:"Findpwd",mixins:[c.a,m.a,d.a],data:function(){return{title:"".concat(this.$t("modify.forgetPassword"),"  ").concat(this.$t("modify.retrievePassword")),phoneNumber:"",isVerifyDisabled:!0,canCountDown:!1,countDownSecond:60,loading:!1,verifyCode:"",newPassword:"",newPasswordRepeat:"",username:"",validate:!1,code:"",site_mode:"",isPaid:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,e=t.validate,n=t.register,code=t.code;e&&(this.validate=JSON.parse(e)),n&&(this.register=JSON.parse(n)),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&(this.validate=this.forums.set_reg.register_validate)},methods:{onInput:function(t){this.phoneNumber=t.target.value.replace(/[^\d]/g,""),this.isVerifyDisabled=11!==this.phoneNumber.length},countDown:function(t){var e=this;this.canCountDown=!0,this.countDownSecond=t;var n=setInterval((function(){e.countDownSecond-=1,0===e.countDownSecond&&(e.canCountDown=!1,clearInterval(n))}),1e3)},sendVerifyCode:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={_jv:{type:"sms/send"},mobile:t.phoneNumber,type:"reset_pwd"},e.next=3,t.checkCaptcha(n);case 3:n=e.sent,o.b.run((function(){return t.$store.dispatch("jv/post",n)})).then((function(e){e.interval&&t.countDown(e.interval)}),(function(e){var n=e.response.data.errors;if(n[0])return t.$message.error(n[0].detail[0])}));case 5:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;if(""===this.verifyCode)this.$message.error("验证码不能为空");else if(""===this.newPassword)this.$message.error("新密码不能为空");else if(""===this.newPasswordRepeat)this.$message.error("重复密码不能为空");else if(this.newPassword!==this.newPasswordRepeat)this.$message.error("二次密码输入不一致");else{var e={_jv:{type:"sms/verify"},mobile:this.phoneNumber,code:this.verifyCode,password:this.newPassword,type:"reset_pwd"};o.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){window.localStorage.setItem("username",e.username),t.$router.push("/modify/resetpwdsuccess")}),(function(e){return t.handleError(e)}))}}}},v=(n(670),n(0)),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-find-pwd"},[n("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("modify.forgetPassword"))+"\\"+t._s(t.$t("modify.retrievePassword")))]),t._v(" "),n("div",{staticClass:"describe"},[t._v(" "+t._s(t.$t("modify.retrievePasswordByPhone")))]),t._v(" "),n("div",{staticClass:"retrieve-inputs"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],attrs:{maxlength:"11",type:"text",placeholder:t.$t("modify.placeEnterRegisteredPhone")},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=e.target.value)}}}),t._v(" "),t.canCountDown?n("button",{class:{disabled:t.canCountDown},attrs:{disabled:t.canCountDown}},[t._v(t._s(t.countDownSecond+t.$t("modify.retransmission")))]):n("button",{on:{click:t.sendVerifyCode}},[t._v("\n        "+t._s(t.$t("modify.sendVerifyCode"))+"\n      ")])]),t._v(" "),n("el-input",{attrs:{maxlength:"6",placeholder:t.$t("modify.placeEnterCode")},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),t._v(" "),n("el-input",{attrs:{placeholder:t.$t("modify.enterNew"),"show-password":""},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),t._v(" "),n("el-input",{attrs:{placeholder:t.$t("modify.resetrepeatpass"),"show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.newPasswordRepeat,callback:function(e){t.newPasswordRepeat=e},expression:"newPasswordRepeat"}})],1),t._v(" "),n("button",{staticClass:"submit",on:{click:t.submit}},[t._v(t._s(t.$t("modify.submit")))])])}),[],!1,null,"63ee3a98",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var head=n(10),r={name:"ResetPwdSuccess",mixins:[n.n(head).a],data:function(){return{title:this.$t("modify.resetPasswordSuccess")}},computed:{username:function(){return window.localStorage.getItem("username")||""}}},o=(n(671),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-findpwd"},[n("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("modify.resetPasswordSuccess")))]),t._v(" "),n("div",{staticClass:"describe"},[t._v("\n    "+t._s(t.$t("modify.user")+" “"+t.username+"” "+t.$t("modify.resetPasswordSuccessRepeat"))+" !")]),t._v(" "),n("div",{staticClass:"detail"},[t._v(" "+t._s(t.$t("modify.resetPasswordLoginTip")))]),t._v(" "),n("nuxt-link",{staticClass:"login",attrs:{to:"/user/login"}},[n("el-button",{staticClass:"btn",attrs:{type:"primary"}},[t._v("\n      "+t._s(t.$t("user.login"))+"\n    ")])],1)],1)}),[],!1,null,"4a428a42",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r=n(7),head=(n(9),n(10)),o=n.n(head),c=n(1),l=n.n(c),d={layout:"center_layout",mixins:[o.a,l.a],data:function(){return{title:this.$t("profile.myfavorite"),activeName:"all",favoriteList:[],total:0,pageNum:1,pageSize:10,loading:!1,hasMore:!1,currentAudioId:""}},mounted:function(){this.getFavoriteList()},methods:{getFavoriteList:function(){var t=this;this.loading=!0;var e={include:"user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio","page[number]":this.pageNum,"page[limit]":this.pageSize};this.$store.dispatch("jv/get",["favorites",{params:e}]).then((function(data){t.total=data._jv.json.meta.threadCount,t.hasMore=data.length===t.pageSize,1===t.pageNum?t.favoriteList=data:t.favoriteList=[].concat(Object(r.a)(t.favoriteList),Object(r.a)(data)),t.pageNum+=1,data._jv&&(t.hasMore=t.favoriteList.length<data._jv.json.meta.threadCount)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getFavoriteList()},handleFavorite:function(t,e){var n=this;this.loading||this.$confirm(this.$t("topic.confirmCancelCollection"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel")}).then((function(){t.canFavorite||n.$message.error(n.$t("topic.deleteFail")),n.loading=!0;var r={_jv:{type:"threads",id:t&&t._jv&&t._jv.id},isFavorite:!1};return n.$store.dispatch("jv/patch",r).then((function(){n.$message.success(n.$t("topic.cancelCollectionSuccess")),n.favoriteList.splice(e,1),n.total-=1}),(function(t){n.handleError(t)})).finally((function(){n.loading=!1}))})).catch((function(){}))},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},h=(n(672),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"favorite-container"},[n("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("topic.allPost",{total:t.total}),name:"all"}})],1),t._v(" "),n("div",{staticClass:"post-list"},[t._l(t.favoriteList,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,"show-share":!1},on:{audioPlay:t.audioPlay}},[n("div",{staticClass:"delete-container",attrs:{slot:"bottom-right"},slot:"bottom-right"},[n("span",{staticClass:"delete",on:{click:function(n){return t.handleFavorite(e,r)}}},[n("svg-icon",{attrs:{type:"delete"}}),t._v(t._s(t.$t("topic.delete")))],1)])]):n("post-item",{key:r,attrs:{item:e,"show-share":!1}},[n("div",{staticClass:"delete-container",attrs:{slot:"bottom-right"},slot:"bottom-right"},[n("span",{staticClass:"delete",on:{click:function(n){return t.handleFavorite(e,r)}}},[n("svg-icon",{attrs:{type:"delete"}}),t._v(t._s(t.$t("topic.delete")))],1)])])]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.favoriteList.length},on:{loadMore:t.loadMore}})],2)],1)}),[],!1,null,"918b1894",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,PostItem:n(57).default,ListLoadMore:n(40).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(24),n(37),n(18);var r=n(12),o=(n(19),n(9),n(25),n(16),n(8)),c=n(13),l=n(1),d=n.n(l),h=n(27);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",_={layout:"custom_layout",mixins:[d.a],asyncData:function(t,e){return Object(o.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,m,_,y,w,C,$,k,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,o=t.params,h.a.isSpider||e(null,{}),c={"filter[isDeleted]":"no",sort:"-createdAt",include:v,"page[number]":1,"page[limit]":10,"filter[isApproved]":1,"filter[userId]":o.id},l={include:v,"page[number]":1,"page[limit]":10,"filter[isApproved]":1,"filter[user_id]":o.id},d={include:v,"page[number]":1,"page[limit]":20,"filter[isApproved]":1,"filter[userId]":o.id,"filter[type]":5,"filter[answer]":"yes"},n.prev=5,m={},n.next=9,r.dispatch("jv/get",["threads",{params:c}]);case 9:return _=n.sent,n.next=12,r.dispatch("jv/get",["threads/likes",{params:l}]);case 12:return y=n.sent,n.next=15,r.dispatch("jv/get",["threads",{params:d}]);case 15:return w=n.sent,n.next=18,r.dispatch("jv/get",["users/".concat(o.id),{}]);case 18:C=n.sent,Object.keys(C).length>0&&(m.profilename=C.username),Array.isArray(_)?m.threadsData=_:_&&_._jv&&_._jv.json&&(($=_._jv.json.data||[]).forEach((function(t,e){$[e]=f(f(f({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),m.threadsData=$),Array.isArray(y)?m.likethreadsData=y:y&&y._jv&&y._jv.json&&((k=y._jv.json.data||[]).forEach((function(t,e){k[e]=f(f(f({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),m.likethreadsData=k),Array.isArray(w)?m.askthreadData=w:w&&w._jv&&w._jv.json&&((x=w._jv.json.data||[]).forEach((function(t,e){x[e]=f(f(f({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),m.askthreadData=x),e(null,m),n.next=29;break;case 26:n.prev=26,n.t0=n.catch(5),e(null,{_error__abc:{error_keys:Object.keys(n.t0),error:String(n.t0),errno:n.t0.errno,code:n.t0.code,syscall:n.t0.syscall,address:n.t0.address,port:n.t0.port,config:n.t0.config,request_domain:(n.t0.request||{}).domain,request_keys:Object.keys(n.t0.request||{}),response_keys:Object.keys(n.t0.response||{})}});case 29:case"end":return n.stop()}}),n,null,[[5,26]])})))()},data:function(){return{userId:"",userInfo:"",current:"",activeName:"1",profilename:"‎",can_create_dialog:!1,can_create_thread_question:!1,canBeAsked:!1,headFixed:!1,loading:!1,dialog:{id:"",name:""},chatting:!1,offsetTop:0,isShield:!1,site_name:"",threadsData:[],likethreadsData:[],askthreadData:[],unbundlingArry:[],unbundUserData:[]}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},currentLoginId:function(){return this.$store.getters["session/get"]("userId")}},watch:{$route:function(){this.$router.go(0)},forums:{handler:function(t){t.other&&t.other.can_create_dialog&&(this.can_create_dialog=!0),t.set_site&&t.set_site.site_name&&(this.site_name=t.set_site.site_name),t.other&&t.other.can_create_thread_question&&(this.can_create_thread_question=!0)},deep:!0,immediate:!0}},created:function(){var t=this.$route.query.current;this.userId=this.$route.params.id||"",this.current=t,this.activeName=this.current?this.current:this.activeName},mounted:function(){this.getAuth(),this.getUserInfo(this.userId),window.addEventListener("scroll",this.handleScroll),this.currentLoginId&&this.getShieldData()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)},methods:{ask:function(){this.$router.push("/thread/post?type=5&beaskId=".concat(this.userId))},handleScroll:function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;this.headFixed=t>220},changeactive:function(){},getAuth:function(){this.forums.other&&this.forums.other.can_create_dialog?this.can_create_dialog=!0:this.can_create_dialog=!1},getUserInfo:function(t){var e=this;this.loading=!0;var n={include:"groups,dialog"};c.b.run((function(){return e.$store.dispatch("jv/get",["users/".concat(t),{params:n}]).then((function(t){t.isDeleted?e.$message.error("用户不存在"):(e.loading=!1,e.dialog.id=t.dialog?t.dialog._jv.id:0,e.dialog.name=t.username,e.profilename="".concat(e.dialog.name+e.$t("profile.myperson")," - ").concat(e.site_name),e.userInfo=t,e.userInfo.groupsName=e.userInfo.groups?e.userInfo.groups[0].name:"",e.canBeAsked=t.canBeAsked)}))})).catch((function(t){e.loading=!1,e.handleError(t)}))},addFollow:function(t){var e=this;if(localStorage.getItem("access_token"))if(this.isShield2)this.$message.error("你已被屏蔽");else{var n={_jv:{type:"follow"},type:"user_follow",to_user_id:t.id.toString()};this.$store.dispatch("jv/post",n).then((function(){e.getUserInfo(e.userId),e.$refs.followers&&e.$refs.followers.getFollowerList("change")}),(function(t){return e.handleError(t)}))}},deleteFollow:function(t){var e=this;localStorage.getItem("access_token")&&this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){e.getUserInfo(e.userId),e.$refs.followers&&e.$refs.followers.getFollowerList("change")}))},changeFollow:function(t){this.getUserInfo(t.userId)},changeLike:function(t){this.changeFollow(t)},chat:function(){localStorage.getItem("access_token")&&(this.chatting=!0)},getShieldData:function(){var t=this;this.loading=!0,this.$store.dispatch("jv/get","users/".concat(this.currentLoginId,"/deny")).then((function(e){t.unbundUserData=[],t.unbundUserData.push(Number(t.currentLoginId));var n=JSON.parse(JSON.stringify(e));n.forEach((function(e,i){t.unbundUserData.push(n[i].id)}));var data=n.filter((function(e){return e.id.toString()===t.userId}));t.isShield=data.length>0}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))},handleShield:function(){var t=this;if(localStorage.getItem("access_token")){var e={_jv:{type:"users/".concat(this.userId,"/deny")}};this.$store.dispatch("jv/post",e).then((function(){t.getShieldData()}))}},unbundlingUser:function(){var t=this;localStorage.getItem("access_token")&&this.$store.dispatch("jv/delete","users/".concat(this.userId,"/deny")).then((function(){t.$t("profile.unboundsucceed"),t.getShieldData()}))}},head:function(){return{title:this.profilename}}},y=(n(782),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"profile"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.headFixed,expression:"headFixed"}],staticClass:"isFixed"},[n("div",{staticClass:"headcon"},[n("div",{staticClass:"hinfo"},[n("Avatar",{staticClass:"avatar",attrs:{user:t.userInfo,size:40}}),t._v(" "),n("div",{staticClass:"profile-info"},[n("span",{staticClass:"info-name"},[t._v(t._s(t.userInfo.username||""))]),t._v(" "),n("span",{staticClass:"info-actor"},[t._v("\n            "+t._s(t.userInfo.groups&&t.userInfo.groups[0]&&t.userInfo.groups[0].isDisplay?t.userInfo.groupsName:"")+"\n          ")])])],1),t._v(" "),n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},on:{"tab-click":t.changeactive},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("profile.topic")+" ("+(t.userInfo.threadCount||0)+")",name:"1"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.question")+" ("+(t.userInfo.questionCount||0)+")",name:"2"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.likes")+" ("+(t.userInfo.likedCount||0)+")",name:"3"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.following")+" ("+(t.userInfo.followCount||0)+")",name:"4"}}),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.followers")+" ("+(t.userInfo.fansCount||0)+")",name:"5"}})],1),t._v(" "),t.userId!==t.currentLoginId?n("div",{staticClass:"profile-btn2"},[n("el-button",{staticClass:"h-button2",attrs:{type:"primary",plain:"",size:"small",disabled:!t.currentLoginId},on:{click:function(e){0==t.userInfo.follow?t.addFollow(t.userInfo):t.deleteFollow(t.userInfo)}}},[t._v(" "+t._s(0==t.userInfo.follow?"+ "+t.$t("profile.following"):1==t.userInfo.follow?t.$t("profile.followed"):t.$t("profile.mutualfollow")))]),t._v(" "),t.can_create_dialog?n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.chat}},[t._v(t._s(t.$t("profile.privateMessage")))]):t._e()],1):t._e()],1)]),t._v(" "),t.userInfo&&t.forums?n("div",{staticClass:"profile-h"},[n("Avatar",{staticClass:"avatar",attrs:{user:t.userInfo,size:100}}),t._v(" "),n("div",{staticClass:"profile-info"},[n("span",{staticClass:"info-name"},[t._v("\n        "+t._s(t.userInfo.username||"")+"\n      ")]),t._v(" "),n("span",{staticClass:"info-actor"},[t.userInfo&&t.userInfo.isReal?n("svg-icon",{staticClass:"auth-icon",attrs:{type:"auth"}}):t._e(),t._v(" "),n("span",{staticClass:"groupname"},[t._v("\n          "+t._s(t.userInfo.groups&&t.userInfo.groups[0]&&t.userInfo.groups[0].isDisplay?t.userInfo.groupsName:"")+"\n        ")])],1),t._v(" "),t.userInfo.signature?n("p",{staticClass:"info-content"},[t._v(t._s(t.userInfo.signature))]):t._e()]),t._v(" "),t.userId!=t.currentLoginId?n("div",{staticClass:"profile-btn"},[t.isShield?n("div",{staticClass:"shield",on:{click:t.unbundlingUser}},[n("svg-icon",{staticClass:"unshield-icon",attrs:{type:"unshield"}}),t._v(t._s(t.$t("profile.deleteshield"))+"\n      ")],1):n("div",{staticClass:"shield",on:{click:t.handleShield}},[n("svg-icon",{staticClass:"canshield-icon",attrs:{type:"canshield"}}),t._v(t._s(t.$t("profile.shield"))+"\n      ")],1),t._v(" "),t.userInfo?n("el-button",{staticClass:"h-button2",attrs:{type:"primary",plain:"",size:"small",disabled:!t.currentLoginId},on:{click:function(e){0==t.userInfo.follow?t.addFollow(t.userInfo):t.deleteFollow(t.userInfo)}}},[t._v(" "+t._s(0==t.userInfo.follow?"+ "+t.$t("profile.following"):1==t.userInfo.follow?t.$t("profile.followed"):t.$t("profile.mutualfollow")||""))]):t._e(),t._v(" "),t.can_create_dialog?n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.chat}},[t._v(t._s(t.$t("profile.privateMessage")))]):t._e(),t._v(" "),t.can_create_thread_question&&t.canBeAsked?n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.ask}},[t._v("向Ta提问")]):t._e()],1):t._e(),t._v(" "),t.chatting?n("chat-box",{attrs:{dialog:t.dialog||{}},on:{close:function(e){t.chatting=!1}}}):t._e()],1):t._e(),t._v(" "),t.userInfo&&t.forums?n("div",{staticClass:"profile-c"},[n("div",{staticClass:"profile-cc"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},on:{"tab-click":t.changeactive},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("profile.topic")+" ("+(t.userInfo.threadCount||0)+")",name:"1"}},["1"===t.activeName?n("topic",{ref:"topic",attrs:{"user-id":t.userId,"thread-data":t.threadsData},on:{changeLike:t.changeLike}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.question")+" ("+(t.userInfo.questionCount||0)+")",name:"2"}},["2"===t.activeName?n("question",{ref:"question",attrs:{"user-id":t.userId},on:{changeLike:t.changeLike}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.likes")+" ("+(t.userInfo.likedCount||0)+")",name:"3"}},["3"===t.activeName?n("like",{ref:"like",attrs:{"user-id":t.userId,"likethreads-data":t.likethreadsData},on:{changeFollow:t.changeFollow}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.following")+" ("+(t.userInfo.followCount||0)+")",name:"4"}},["4"===t.activeName?n("following",{ref:"following",attrs:{"user-id":t.userId},on:{changeFollow:t.changeFollow}}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.followers")+" ("+(t.userInfo.fansCount||0)+")",name:"5"}},["5"===t.activeName?n("follwers",{ref:"followers",attrs:{"user-id":t.userId},on:{changeFollow:t.changeFollow}}):t._e()],1)],1)],1),t._v(" "),n("div",{staticClass:"profileside"},[n("advertising"),t._v(" "),n("recommend-user",{staticClass:"recomusr"}),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)]):t._e()])}),[],!1,null,"53449c08",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,SvgIcon:n(11).default,ChatBox:n(300).default,Topic:n(797).default,Question:n(796).default,Like:n(795).default,Following:n(793).default,Follwers:n(820).default,Advertising:n(62).default,RecommendUser:n(89).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(19),n(25);var r=n(7),o=(n(9),n(12)),c=(n(16),n(8)),l=n(1),d=n.n(l),h=n(27);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",_={layout:"custom_layout",name:"TopicContent",mixins:[d.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,m,_,y,w,C;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,o=t.params,h.a.isSpider||e(null,{}),c={include:v,"filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","page[limit]":10,"filter[topicId]":o.id},l={include:"groups",limit:4},n.prev=4,d={},n.next=8,r.dispatch("jv/get",["topics/".concat(o.id),{}]);case 8:return m=n.sent,n.next=11,r.dispatch("jv/get",["threads",{params:c}]);case 11:return _=n.sent,n.next=14,r.dispatch("jv/get",["users/recommended",{params:l}]);case 14:y=n.sent,d.topic=f({},m),Array.isArray(_)?d.threadsData=_.slice(0,10):_&&_._jv&&_._jv.json&&((w=_._jv.json.data||[]).forEach((function(t,e){w[e]=f(f(f({},t),t.attributes),{},{firstPost:t.relationships&&t.relationships.firstPost&&t.relationships.firstPost.data,user:t.relationships&&t.relationships.user&&t.relationships.user.data,groups:t.relationships&&t.relationships.groups&&t.relationships.groups.data,_jv:{id:t.id}})})),d.threadsData=w),Array.isArray(y)?d.recommendUserData=y:y&&y._jv&&y._jv.json&&((C=y._jv.json.data||[]).forEach((function(t,e){C[e]=f(f({},t),t.attributes)})),d.recommendUserData=C),e(null,d),n.next=24;break;case 21:n.prev=21,n.t0=n.catch(4),e(null,{});case 24:case"end":return n.stop()}}),n,null,[[4,21]])})))()},data:function(){return{loading:!1,threadsData:[],total:0,recommendUserData:[],pageNum:1,pageSize:10,hasMore:!1,topicId:"",topic:{},currentAudioId:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{$route:"init"},mounted:function(){this.init()},methods:{init:function(){this.threadsData=[],this.$route.params&&this.$route.params.id&&(this.topicId=this.$route.params.id,this.getTopicDetail(this.$route.params.id),this.getThreadsList())},getTopicDetail:function(t){var e=this;this.$store.dispatch("jv/get",["topics/".concat(t),{}]).then((function(t){t&&(e.topic=t)}))},getThreadsList:function(){var t=this;this.loading=!0;var e={include:v,"filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[topicId]":"".concat(this.topicId)};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(e){t.hasMore=e.length===t.pageSize,t.total=e._jv.json.meta.threadCount,1===t.pageNum?(t.threadsData=e,!t.address&&e.length>0&&(t.address=e[0].address),!t.location&&e.length>0&&(t.location=e[0].location)):t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(e)),t.pageNum+=1,e._jv&&(t.hasMore=t.threadsData.length<e._jv.json.meta.threadCount)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getThreadsList()},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}},head:function(){return{title:this.forums&&this.forums.set_site&&this.forums.set_site.site_name?this.topic.content+" - "+this.forums.set_site.site_name:this.topic.content,meta:[{hid:"description",name:"description",content:this.topic.content||""}]}}},y=(n(781),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-content-container"},[n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("div",{staticClass:"topic-detail"},[n("div",{staticClass:"title"},[t._v("\n          #"),n("span",{staticClass:"topic-name"},[t._v(t._s(t.topic.content))]),t._v("#\n          "),1===t.topic.recommended?n("svg-icon",{attrs:{type:"recommend"}}):t._e()],1),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"item"},[t._v(t._s(t.$t("home.topicCount",{total:t.topic.thread_count})))]),t._v(" "),n("div",{staticClass:"item"},[t._v(t._s(t.$t("home.topicViewCount",{total:t.topic.view_count})))]),t._v(" "),n("share-popover",{attrs:{type:"topic"}},[n("div",{staticClass:"item hover"},[n("svg-icon",{staticClass:"icon",attrs:{type:"link"}}),t._v("\n              "+t._s(t.$t("topic.share"))+"\n            ")],1)]),t._v(" "),n("nuxt-link",{staticClass:"item hover",attrs:{to:"/topic/list"}},[t._v(t._s(t.$t("topic.allTopics")))])],1)]),t._v(" "),n("div",{staticClass:"thread-list"},[t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})],2)]),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"background-color"},[n("advertising")],1),t._v(" "),n("div",{staticClass:"recommend-user background-color"},[n("recommend-user",{attrs:{list:t.recommendUserData}})],1),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])])}),[],!1,null,"64bc707e",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,SharePopover:n(299).default,PostItem:n(57).default,ListLoadMore:n(40).default,Advertising:n(62).default,RecommendUser:n(89).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);n(18);var r=n(7),o=(n(16),n(8)),head=(n(9),n(10)),c=n.n(head),l=n(1),d=n.n(l),h={layout:"center_layout",mixins:[c.a,d.a],data:function(){return{title:this.$t("profile.notice"),activeName:"chat",noticeTypeList:[{label:this.$t("notice.message"),value:"chat"},{label:this.$t("notice.relate"),value:"related"},{label:this.$t("notice.reply"),value:"replied"},{label:this.$t("notice.like"),value:"liked"},{label:this.$t("notice.reward"),value:"rewarded"},{label:this.$t("notice.questionsAnswers"),value:"questioned"},{label:this.$t("notice.system"),value:"system"}],noticeList:[],pageNum:1,pageSize:10,loading:!1,hasMore:!1,surplus:0,dialog:{pageNum:1,pageSize:10,list:[],hasMore:!1,loading:!1},chatting:!1,dialogData:{id:"",name:""}}},computed:{userInfo:function(){return this.$store.state.user.info.attributes||{}},userId:function(){return this.$store.getters["session/get"]("userId")}},mounted:function(){this.getDialogList()},methods:{getDialogList:function(){var t=this;this.dialog.loading=!0;var e={include:"dialogMessage,sender,recipient,sender.groups,recipient.groups",sort:"-dialogMessageId","page[number]":this.dialog.pageNum,"page[limit]":this.dialog.pageSize};this.$store.dispatch("jv/get",["dialog",{params:e}]).then(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.dialog.hasMore=data.length===t.dialog.pageSize,1===t.dialog.pageNum?t.dialog.list=data:t.dialog.list=[].concat(Object(r.a)(t.dialog.list),Object(r.a)(data)),t.dialog.pageNum+=1,data._jv&&data._jv.json&&data._jv.json.meta&&(t.dialog.hasMore=t.dialog.list.length<data._jv.json.meta.total&&t.dialog.list.length>=t.dialog.pageSize,t.surplus=data._jv.json.meta.total-t.dialog.list.length);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){t.handleError(e)})).finally((function(){t.dialog.loading=!1}))},getNoticeList:function(){var t=this;this.loading=!0;var e={"filter[type]":this.activeName,"page[number]":this.pageNum,"page[limit]":this.pageSize};"rewarded"===this.activeName&&(e["filter[type]"]="rewarded,withdrawal"),this.$store.dispatch("jv/get",["notification",{params:e}]).then(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.hasMore=data.length===t.pageSize,1===t.pageNum?t.noticeList=data:t.noticeList=[].concat(Object(r.a)(t.noticeList),Object(r.a)(data)),data._jv&&data._jv.json&&data._jv.json.meta&&(t.hasMore=t.noticeList.length<data._jv.json.meta.total&&t.noticeList.length>=t.pageSize,t.surplus=data._jv.json.meta.total-t.noticeList.length),t.pageNum+=1,e.prev=4,e.next=7,t.$store.dispatch("user/getUserInfo",t.userInfo.id);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getNoticeList()},loadMoreDialog:function(){this.getDialogList()},handleDelete:function(t,e,n){var r=this;this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel")}).then((function(){"chat"===n?r.$store.dispatch("jv/delete","dialog/".concat(t)).then((function(t){t&&(r.$message.success(r.$t("topic.deleteSuccess")),r.dialog.list.splice(e,1))})):r.$store.dispatch("jv/delete","notification/".concat(t)).then((function(t){t&&(r.$message.success(r.$t("topic.deleteSuccess")),r.noticeList.splice(e,1))}))})).catch((function(){}))},handleClick:function(t){"chat"!==t.name?(this.pageNum=1,this.noticeList=[],this.getNoticeList()):(this.dialog.pageNum=1,this.dialog.list=[],this.getDialogList())},showChatBox:function(t){t&&(this.dialogData.id=t._jv?t._jv.id:"",1*this.userId!==t.sender_user_id?this.dialogData.name=t.sender?t.sender.username:"":this.dialogData.name=t.recipient?t.recipient.username:"",this.chatting=!0)},closeChatBox:function(){this.chatting=!1,this.dialog.pageNum=1,this.getDialogList()}}},m=(n(682),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notice-container"},[n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.noticeTypeList,(function(e,r){return n("el-tab-pane",{key:r,attrs:{name:e.value}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("el-badge",{staticClass:"badge-item",attrs:{"is-dot":!("chat"===e.value||!t.userInfo.typeUnreadNotifications||!t.userInfo.typeUnreadNotifications[e.value])}},[t._v(t._s(e.label))])],1)])})),1),t._v(" "),n("div",{staticClass:"notice-list"},["chat"===t.activeName?[t._l(t.dialog.list,(function(e,r){return n("div",{key:r,staticClass:"notice-item"},[n("chat-item",{attrs:{"user-id":t.userInfo.id,item:e},on:{"show-chat-box":t.showChatBox}}),t._v(" "),n("div",{staticClass:"delete",on:{click:function(n){return t.handleDelete(e._jv&&e._jv.id,r,"chat")}}},[n("svg-icon",{attrs:{type:"close"}})],1)],1)})),t._v(" "),n("list-load-more",{attrs:{loading:t.dialog.loading,"has-more":t.dialog.hasMore,"page-num":t.dialog.pageNum,surplus:t.surplus,length:t.dialog.list.length},on:{loadMore:t.loadMoreDialog}})]:[t._l(t.noticeList,(function(e,r){return n("div",{key:r,staticClass:"notice-item"},[n("notice-item",{attrs:{item:e}}),t._v(" "),n("div",{staticClass:"delete",on:{click:function(n){return t.handleDelete(e.id,r,"notice")}}},[n("svg-icon",{attrs:{type:"close"}})],1)],1)})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,surplus:t.surplus,length:t.noticeList.length},on:{loadMore:t.loadMore}})]],2),t._v(" "),t.chatting?n("chat-box",{attrs:{dialog:t.dialogData||{}},on:{close:t.closeChatBox}}):t._e()],1)}),[],!1,null,"3e096b82",null);e.default=component.exports;installComponents(component,{ChatItem:n(802).default,SvgIcon:n(11).default,ListLoadMore:n(40).default,NoticeItem:n(803).default,ChatBox:n(300).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22);var r=n(12),o=(n(18),n(28),n(19),n(9),n(25),n(16),n(8)),c=n(1),l=n.n(c),d=n(45),h=n.n(d),m=n(298),f=n.n(m),v=n(27);function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var w="posts.replyUser,threadAudio,user.groups,user,user.groups.permissionWithoutCategories,posts,posts.user,posts.likedUsers,posts.images,firstPost,firstPost.likedUsers,firstPost.images,firstPost.attachments,rewardedUsers,category,threadVideo,paidUsers,question,question.beUser,question.images,onlookers",C={name:"Topic",layout:"custom_layout",mixins:[l.a,h.a,f.a],asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.params,r=t.store,v.a.isSpider){e.next=3;break}return e.abrupt("return",{});case 3:return e.prev=3,e.next=6,r.dispatch("jv/get",["threads/".concat(n.id),{params:{include:w}}]);case 6:return o=e.sent,e.abrupt("return",{thread:o,article:o.firstPost,postId:o.firstPost._jv.id});case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",{articleLoading:!0});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})))()},data:function(){return{thread:{},article:{},question:{},postId:0,actions:[{text:this.$t("topic.read"),count:0,command:"",canOpera:!1,icon:"book"},{text:this.$t("topic.getLike"),count:0,command:"isLiked",canOpera:!1,isStatus:!1,icon:"like"},{text:this.$t("topic.collection"),command:"isFavorite",canOpera:!1,isStatus:!1,icon:"favor"},{text:this.$t("topic.share"),command:"showLink",canOpera:!0,icon:"link"}],paidInformation:{price:"0",paid:!1,paidUsers:[],paidCount:0,isPaidAttachment:!1,attachmentPrice:"0"},payment:{wechat_qrcode:"",rewardAmount:""},location:{location:"",latitude:"",longitude:""},managementList:[{name:"canEdit",command:"toEdit",isStatus:!1,canOpera:!1,text:this.$t("topic.edit"),type:"0"},{name:"canEssence",command:"isEssence",isStatus:!1,canOpera:!1,text:this.$t("topic.essence"),type:"1"},{name:"canSticky",command:"isSticky",isStatus:!1,canOpera:!1,text:this.$t("topic.sticky"),type:"2"},{name:"canHide",command:"isDeleted",isStatus:!1,canOpera:!1,text:this.$t("topic.delete"),type:"3"}],showCheckoutCounter:!1,showPasswordInput:!1,showWxPay:!1,defaultLoading:!1,articleLoading:!1,passwordError:!1,passwordErrorTip:"",findPassword:!1}},computed:{threadId:function(){return this.$route.params.id},currentUser:function(){return this.$store.state.user.info.attributes||{}},forums:function(){return this.$store.state.site.info.attributes||{}},rewardOrPay:function(){var t=parseFloat(this.paidInformation.price),e=parseFloat(this.paidInformation.attachmentPrice),n=Object.keys(this.question).length>0?parseFloat(this.question.onlooker_unit_price):0;return t>0||e>0||n>0?"pay":"reward"},payOrRewardAmount:function(){var t=parseFloat(this.paidInformation.price||"0"),e=parseFloat(this.paidInformation.attachmentPrice||"0"),n=Object.keys(this.question).length>0?parseFloat(this.question.onlooker_unit_price):0;return t||e||n||this.payment.rewardAmount},payOrderType:function(){var t=parseFloat(this.paidInformation.price||"0"),e=parseFloat(this.paidInformation.attachmentPrice||"0"),n=Object.keys(this.question).length>0?parseFloat(this.question.onlooker_unit_price):0;return t>0?3:e>0?7:n>0?6:2}},mounted:function(){0===Object.keys(this.thread).length?this.getThread():this.initData()},methods:{getThread:function(){var t=this;return this.$store.dispatch("jv/get",["threads/".concat(this.threadId),{params:{include:w}}]).then((function(data){if(data.isDeleted)return t.$router.replace("/error");t.articleLoading=!1,t.thread=data,t.article=data.firstPost,t.postId=t.article._jv.id,t.initData()}),(function(e){return t.handleError(e,"thread")}))},initData:function(){this.initManagementList(this.thread),this.initPaidInformation(this.thread),this.initActions(this.thread,this.article),this.initLocation(this.thread),this.initQuestion(this.thread),this.filterImages()},filterImages:function(){var t=this;this.article.contentAttachIds&&this.article.contentAttachIds.length>0&&this.article.images&&this.article.images.length>0&&(this.article.images=this.article.images.filter((function(image){return t.article.contentAttachIds.indexOf(image._jv.id)<0})))},initQuestion:function(data){data.question&&(this.question=data.question,this.question.onlookerState=data.onlookerState)},initLocation:function(data){for(var t in this.location)this.location[t]=data[t]},initPaidInformation:function(data){for(var t in this.paidInformation)this.paidInformation[t]=data[t]},initManagementList:function(data){var t=this;this.managementList.forEach((function(e){e.canOpera=data[e.name],"canEssence"===e.name?(e.isStatus=data.isEssence,e.text=e.isStatus?t.$t("topic.cancelEssence"):t.$t("topic.essence")):"canSticky"===e.name&&(e.isStatus=data.isSticky,e.text=e.isStatus?t.$t("topic.cancelSticky"):t.$t("topic.sticky"))})),(4===this.thread.type||5===this.thread.type)&&this.managementList.filter((function(t){return"canEdit"===t.name})).length>0&&(this.managementList.filter((function(t){return"canEdit"===t.name}))[0].canOpera=!1),this.thread.isEssence=data.isEssence,this.managementList=this.managementList.filter((function(t){return t.canOpera}))},initActions:function(data,t){var e=y({},this.actions[0]),n=y({},this.actions[2]),r=y({},this.actions[1]);data&&(e.count=data.viewCount,n.isStatus=data.isFavorite,n.text=n.isStatus?this.$t("topic.collectionAlready"):this.$t("topic.collection"),n.icon=n.isStatus?"favored":"favor",n.canOpera=data.canFavorite),t&&(r.count=t.likeCount,r.isStatus=t.isLiked,r.canOpera=t.canLike,r.text=r.isStatus?this.$t("topic.liked"):this.$t("topic.getLike"),r.icon=r.isStatus?"liked":"like"),this.$set(this.actions,0,e),this.$set(this.actions,1,r),this.$set(this.actions,2,n)},paying:function(t){var e=this,n=t.payWay,r=t.hideAvatar,o=t.rewardAmount;if("reward"===this.rewardOrPay&&(!o||0===parseFloat(o)))return this.$message.error(this.$t("pay.AmountCannotBeLessThan0"));if(this.payment.rewardAmount=o,this.showCheckoutCounter=!1,"walletPay"===n)this.showPasswordInput=!0,this.createOrder(r,this.payOrRewardAmount,this.payOrderType,20).finally((function(){e.defaultLoading=!1}));else if("wxPay"===n){if(!this.forums.paycenter.wxpay_close)return this.$message.warning(this.$t("pay.wxPayClose"));this.createOrder(r,this.payOrRewardAmount,this.payOrderType,10).then((function(){e.payOrder().then((function(t){e.payment.wechat_qrcode=t,e.wxPayActive().then((function(){e.getThread()}),(function(){}))}),(function(){}))})).finally((function(){e.defaultLoading=!1}))}},onPasswordInputCompleted:function(t){var e=this;this.payOrder(t).then((function(){e.getThread()}),(function(){}))},postCommand:function(t){var e=this;if(!this.defaultLoading&&this.isLogin()){this.defaultLoading=!0;var n="isLiked"===t.command?{_jv:{type:"posts",id:this.postId}}:{_jv:{type:"threads",id:this.threadId}};return n[t.command]=!t.isStatus,this.$store.dispatch("jv/patch",n).then((function(data){return data.firstPost&&e.initManagementList(data),data.firstPost&&e.initActions(data),"isSticky"===t.command?t.isStatus?e.$message.success(e.$t("topic.stickySuccess")):e.$message.success(e.$t("topic.cancelStickySuccess")):"isLiked"===t.command?e.setLikeUser(!t.isStatus,data):"isDeleted"===t.command?e.afterDeleted():void 0}),(function(t){return e.handleError(t)})).finally((function(){e.defaultLoading=!1}))}},setLikeUser:function(t,data){var e=this;this.initActions(null,data),t?this.article.likedUsers.unshift(this.currentUser):this.article.likedUsers.forEach((function(t,n,r){t.id===e.currentUser.id&&r.splice(n,1)}))},afterDeleted:function(){var t=this;this.$message({typeInformation:"success",message:this.$t("topic.deleteSuccessAndJumpToBack")}),setTimeout((function(){t.$router.push("/")}),1e3)}},head:function(){return{title:(this.thread&&this.thread.title||this.thread&&this.thread.firstPost&&this.thread.firstPost.summaryText.slice(0,15)||"主题详情页")+(this.forums&&this.forums.set_site&&this.forums.set_site.site_name?" - "+this.forums.set_site.site_name:"‎"),meta:[{hid:"keywords",name:"keywords",content:this.thread.category&&this.thread.category.name||""},{hid:"description",name:"description",content:this.thread.firstPost&&this.thread.firstPost.summaryText.slice(0,80)||""},{name:"og:video",content:this.thread.threadVideo&&this.thread.threadVideo.media_url||""}]}}},$=(n(771),n(0)),component=Object($.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.defaultLoading,expression:"defaultLoading",modifiers:{fullscreen:!0}}],staticClass:"page-post",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[n("main",{directives:[{name:"loading",rawName:"v-loading",value:t.articleLoading,expression:"articleLoading"}]},[n("div",{staticClass:"container-post"},[0===t.thread.isApproved?n("div",{staticClass:"checking"},[t._v("\n        "+t._s(t.thread.threadVideo&&0===t.thread.threadVideo.status?t.$t("topic.VideoTranscoding"):t.$t("topic.examineTip"))+"\n      ")]):t._e(),t._v(" "),n("topic-header",{attrs:{author:t.thread.user||{},thread:t.thread,"management-list":t.managementList,"be-asked-user":t.question&&t.question.beUser?t.question.beUser:{}},on:{managementSelected:t.postCommand}}),t._v(" "),n("topic-content",{attrs:{article:t.article,title:t.thread.title||"",video:t.thread.threadVideo||{},audio:t.thread.threadAudio||{},"paid-information":t.paidInformation,"thread-type":t.thread.type||0,category:t.thread.category||{},location:t.location},on:{payForThread:function(e){t.showCheckoutCounter=!0}}}),t._v(" "),5===t.thread.type?n("qa-actions",{attrs:{question:t.question||{},"current-user-id":t.currentUser&&t.currentUser.id?t.currentUser.id:"","question-user-id":t.thread.user&&t.thread.user.id?t.thread.user.id:""},on:{answerPublished:function(e){return t.getThread()},payForAnswer:function(e){t.showCheckoutCounter=!0}}}):t._e(),t._v(" "),n("topic-reward-list",{attrs:{author:t.thread.user||{},"paid-information":t.paidInformation,"can-paid":t.forums&&t.forums.paycenter&&t.forums.paycenter.wxpay_close,"can-reward":t.forums&&t.forums.paycenter&&t.forums.paycenter.wxpay_close&&t.thread.canBeReward,"thread-type":t.thread.type||0,"user-lists":[t.thread.paidUsers||[],t.thread.rewardedUsers||[],t.article.likedUsers||[],[]]},on:{payOrReward:function(e){t.showCheckoutCounter=!0}}}),t._v(" "),n("topic-actions",{attrs:{"thread-id":t.threadId,actions:t.actions||[]},on:{clickAction:t.postCommand}}),t._v(" "),t.showCheckoutCounter?n("topic-checkout-counter",{attrs:{"thread-type":t.thread.type||0,user:t.thread.user||{},amount:t.payOrRewardAmount,content:t.article.summaryText||"","reward-or-pay":t.rewardOrPay,"be-asked-user":t.question.beUser||{},"ask-or-watch-answer":"watchAnswer"},on:{close:function(e){t.showCheckoutCounter=!1},paying:t.paying}}):t._e(),t._v(" "),t.showPasswordInput?n("topic-password",{attrs:{price:t.payOrRewardAmount,"password-error":t.passwordError,"password-error-tip":t.passwordErrorTip},on:{"update:passwordError":function(e){t.passwordError=e},"update:password-error":function(e){t.passwordError=e},close:function(e){t.showPasswordInput=t.passwordError=!1},password:t.onPasswordInputCompleted,findPassword:t.onFindPassword}}):t._e(),t._v(" "),t.showWxPay?n("topic-wx-pay",{attrs:{"qr-code":t.payment.wechat_qrcode},on:{close:function(e){t.showWxPay=!1}}}):t._e(),t._v(" "),t.findPassword&&t.currentUser.originalMobile?n("find-paypwd",{attrs:{mobile:t.currentUser.mobile,phonenum:t.currentUser.originalMobile},on:{close:function(e){t.findPassword=!1}}}):t._e(),t._v(" "),t.findPassword&&!t.currentUser.originalMobile?n("without-phone",{on:{close:function(e){t.findPassword=!1}}}):t._e(),t._v(" "),n("comment",{attrs:{"thread-id":t.threadId}})],1)]),t._v(" "),n("topic-aside",{attrs:{author:t.thread.user||{}}})],1)}),[],!1,null,"9562ef2c",null);e.default=component.exports;installComponents(component,{TopicHeader:n(801).default,TopicContent:n(362).default,QaActions:n(800).default,TopicRewardList:n(799).default,TopicActions:n(798).default,TopicCheckoutCounter:n(369).default,TopicPassword:n(368).default,TopicWxPay:n(303).default,FindPaypwd:n(301).default,WithoutPhone:n(302).default,Comment:n(822).default,TopicAside:n(370).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22);var r=n(7),o=(n(19),n(9),n(25),n(18),n(78),n(12)),c=(n(16),n(8)),l=n(49),head=n(10),d=n.n(head),h=n(1),m=n.n(h),f=n(27);function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function _(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var y="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",w={layout:"custom_layout",name:"Index",mixins:[d.a,m.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,h,m,v,w,C,$,k,x,j,I;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,o=t.params,f.a.isSpider||e(null,{}),c={"filter[isSticky]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":o.id,"page[number]":1,include:"firstPost"},l={include:y,"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[categoryId]":o.id,"page[number]":1,"page[limit]":10},d={include:"groups",limit:4},n.prev=5,h={},n.next=9,r.dispatch("jv/get",["threads",{params:c}]);case 9:return m=n.sent,n.next=12,r.dispatch("jv/get",["threads",{params:l}]);case 12:return v=n.sent,n.next=15,r.dispatch("jv/get",["categories",{}]);case 15:return w=n.sent,n.next=18,r.dispatch("jv/get",["users/recommended",{params:d}]);case 18:C=n.sent,Array.isArray(m)?h.threadsStickyData=m:m&&m._jv&&m._jv.json&&(($=m._jv.json.data||[]).forEach((function(t,e){$[e]=_(_(_({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,jv:{id:t.id}})})),h.threadsStickyData=$),Array.isArray(v)?h.threadsData=v:v&&v._jv&&v._jv.json&&((k=v._jv.json.data||[]).forEach((function(t,e){k[e]=_(_(_({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,_jv:{id:t.id}})})),h.threadsData=k),Array.isArray(w)?(h.categoryData=w,(x=w.find((function(t){return t._jv&&t._jv.id===o.id})))&&(h.title=x.name||"分类")):w&&w._jv&&w._jv.json&&((j=w._jv.json.data||[]).forEach((function(t,e){j[e]=_(_(_({},t),t.attributes),{},{_jv:{id:t.id}}),t.id===o.id&&(h.title=t.attributes.name||"分类")})),h.categoryData=j),Array.isArray(C)?h.recommendUserData=C:C&&C._jv&&C._jv.json&&((I=C._jv.json.data||[]).forEach((function(t,e){I[e]=_(_({},t),t.attributes)})),h.recommendUserData=I),e(null,h),n.next=29;break;case 26:n.prev=26,n.t0=n.catch(5),e(null,{_error__abc:{error_keys:Object.keys(n.t0),error:String(n.t0),errno:n.t0.errno,code:n.t0.code,syscall:n.t0.syscall,address:n.t0.address,port:n.t0.port,config:n.t0.config,request_domain:(n.t0.request||{}).domain,request_keys:Object.keys(n.t0.request||{}),response_keys:Object.keys(n.t0.response||{})}});case 29:case"end":return n.stop()}}),n,null,[[5,26]])})))()},data:function(){return{loading:!1,threadsStickyData:[],threadsData:[],categoryData:[],recommendUserData:[],pageNum:1,pageSize:10,categoryId:0,threadType:"",sort:"",threadEssence:"",fromUserId:"",hasMore:!1,timer:null,threadCount:0,total:0,currentAudioId:""}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")},forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this;this.$route.params.id&&(this.categoryId=this.$route.params.id,this.getCategoryList()),0===this.threadsStickyData.length&&this.getThreadsSticky(),0===this.threadsData.length?this.getThreadsList():(this.threadsData.length===this.pageSize&&(this.hasMore=!0),this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t.autoLoadThreads()}),3e4))},destroyed:function(){clearInterval(this.timer)},methods:{getThreadsSticky:function(){var t=this;this.threadsStickyData=[];var e={"filter[isSticky]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":this.categoryId,include:["firstPost"]};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){t.threadsStickyData=Object(r.a)(data)}))},getThreadsList:function(){var t=this;this.loading=!0;var e={include:y,"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[categoryId]":this.categoryId,"filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[fromUserId]":this.fromUserId,sort:this.sort,"page[number]":this.pageNum,"page[limit]":this.pageSize};null!==this.threadType&&(e["filter[type]"]=this.threadType),this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){t.hasMore=data.length===t.pageSize;var e=data&&data._jv&&data._jv.json&&data._jv.json.meta&&data._jv.json.meta.threadCount||0;1===t.pageNum?(t.threadsData=data,t.threadCount=e):t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(data)),data&&data._jv&&(t.hasMore=t.threadsData.length<e),t.pageNum+=1,t.timer&&clearInterval(t.timer),t.timer=setInterval((function(){t.autoLoadThreads()}),3e4)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},getCategoryList:function(){var t=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(e){var n=Object(r.a)(e)||[];t.categoryData=n;var o=n.find((function(e){return e._jv&&+e._jv.id==+t.categoryId}));o&&(t.title=o.name)}),(function(e){t.handleError(e)}))},loadMore:function(){this.getThreadsList()},autoLoadThreads:function(){var t=this,e={"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","filter[categoryId]":this.categoryId,"filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[fromUserId]":this.fromUserId,"page[limit]":1};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(data){if(data&&data._jv){var e=data._jv.json&&data._jv.json.meta&&data._jv.json.meta.threadCount||0;t.threadCount>0&&(t.total=e-t.threadCount>0?e-t.threadCount:0)}}))},reloadThreadsList:function(){this.pageNum=1,this.total=0,this.threadsData=[],this.getThreadsList()},onChangeCategory:function(t){0!==t?this.$router.push("/category/".concat(t)):this.$router.push("/")},onChangeFilter:function(t){this.threadEssence="",this.fromUserId="","isEssence"===t?this.threadEssence="yes":"followed"===t&&(this.fromUserId=this.userId),this.reloadThreadsList()},onChangeType:function(t){this.threadType=t,this.reloadThreadsList()},onChangeSort:function(t){this.sort=t,this.reloadThreadsList()},formatRichText:function(html){return l.a.parse(html)},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},C=(n(769),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("index-filter",{on:{onChangeFilter:t.onChangeFilter,onChangeType:t.onChangeType,onChangeSort:t.onChangeSort}}),t._v(" "),t.threadsStickyData.length>0?n("div",{staticClass:"list-top"},t._l(t.threadsStickyData,(function(e,r){return n("div",{key:r,staticClass:"list-top-item"},[n("div",{staticClass:"top-label"},[t._v(t._s(t.$t("home.sticky")))]),t._v(" "),n("nuxt-link",{staticClass:"top-title",attrs:{to:"/thread/"+(e._jv&&e._jv.id),target:"_blank"}},[1===e.type?[t._v("\n            "+t._s(e.title)+"\n          ")]:n("div",{domProps:{innerHTML:t._s(t.$xss(t.formatRichText(e.firstPost&&e.firstPost.summary)))}})],2)],1)})),0):t._e(),t._v(" "),t.total>0?n("div",{staticClass:"new-post"},[n("div",{staticClass:"new-post-cont"},[t._v("\n        "+t._s(t.$t("home.hasNewContent",{total:t.total}))+"\n        "),n("span",{staticClass:"refresh",on:{click:t.reloadThreadsList}},[t._v(t._s(t.$t("home.clickRefresh")))])])]):t._e(),t._v(" "),n("div",{staticClass:"post-list"},[t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})],2)],1),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"category background-color"},[n("category",{attrs:{list:t.categoryData},on:{onChange:t.onChangeCategory}})],1),t._v(" "),n("div",{staticClass:"background-color"},[n("advertising")],1),t._v(" "),n("div",{staticClass:"recommend-user background-color"},[n("recommend-user",{attrs:{list:t.recommendUserData}})],1),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])}),[],!1,null,"2627bf9f",null);e.default=component.exports;installComponents(component,{IndexFilter:n(365).default,PostItem:n(57).default,ListLoadMore:n(40).default,Category:n(136).default,Advertising:n(62).default,RecommendUser:n(89).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(28),n(13)),head=n(10),c=n.n(head),l=n(1),d=n.n(l),h=n(55),m=n.n(h),f=n(82),v=n.n(f),_=n(23),y=n.n(_),w={mixins:[c.a,d.a,m.a,v.a,y.a],data:function(){return{title:"登录/注册并绑定手机号",phoneNumber:"",content:this.$t("modify.sendVerifyCode"),activeName:"0",verifyCode:"",code:"",site_mode:"",isPaid:!1,canClick:!0,ischeck:!0,loading:!1,nickname:"",headimgurl:"",token:"",preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userInfo:function(){return this.$store.state.user.info.attributes||{}}},mounted:function(){var t=this.$route.query,code=t.code,e=t.nickname,n=t.headimgurl,r=t.preurl;r&&(this.preurl=r),this.token=localStorage.getItem("wechat"),e&&(this.nickname=e),n&&(this.headimgurl=n),"undefined"!==code&&(this.code=code)},methods:{check:function(t){this.ischeck=t},changeinput:function(){var t=this;setTimeout((function(){t.phoneNumber=t.phoneNumber.replace(/[^\d]/g,"")}),30),11===this.phoneNumber.length?this.canClick=!0:this.canClick=!1},sendVerifyCode:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={_jv:{type:"sms/send"},mobile:t.phoneNumber,type:"login"},e.next=3,t.checkCaptcha(n);case 3:n=e.sent,o.b.run((function(){return t.$store.dispatch("jv/post",n)})).then((function(e){e.interval&&t.countDown(e.interval)}),(function(e){return t.handleError(e)}));case 5:case"end":return e.stop()}}),e)})))()},PhoneLogin:function(){var t=this;if(this.loading=!0,""===this.phoneNumber)this.$message.error("手机号不能为空"),this.loading=!1;else if(""===this.verifyCode)this.$message.error("验证码不能为空"),this.loading=!1;else{var e={data:{attributes:{mobile:this.phoneNumber,code:this.verifyCode,type:"login",register:1,token:this.token}}};this.code&&"undefined"!==this.code&&(e.data.attributes.inviteCode=this.code),this.$store.dispatch("session/verificationCodeh5Login",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.$message.success(t.$t("user.loginSuccess"))),e&&e.data&&e.data.errors&&"no_bind_user"===e.data.errors[0].code){var n=e.data.errors[0].token;return localStorage.setItem("mobileToken",n),t.logind(),void t.$message.success(t.$t("user.loginSuccess"))}if(e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code)t.$router.push("/user/warning?username=".concat(t.phoneNumber));else if(e&&e.data&&e.data.errors&&e.data.errors[0]){var r=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,o=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(r));t.$message.error(o)}})).catch((function(e){t.loading=!1,t.handleError(e)}))}}}},C=(n(768),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"登录/注册并绑定手机号",name:"0"}},[n("form",[n("div",{staticClass:"bindtext"},[n("div",[t._v(t._s(t.$t("user.dear"))+"\n            "),n("avatar",{staticStyle:{display:"inline-block","vertical-align":"text-top"},attrs:{user:{username:t.nickname,avatarUrl:t.headimgurl},size:20,round:!0}}),t._v(" "),n("b",[t._v(t._s(t.nickname||""))]),t._v(" "+t._s(t.$t("user.user")))],1),t._v(" "),n("div",[t._v(t._s(t.$t("user.yourWechat"))),n("b",[t._v(t._s(t.$t("user.withoutBind")))]),t._v("，"),n("b",[t._v(t._s(t.$t("user.register"))+"/"+t._s(t.$t("user.login")))]),t._v(t._s(t.$t("user.readyBInd")))])]),t._v(" "),n("span",{staticClass:"title2"},[t._v(t._s(t.$t("profile.mobile")))]),t._v(" "),n("el-input",{staticClass:"phone-input",attrs:{placeholder:t.$t("user.phoneNumber"),maxlength:"11"},model:{value:t.phoneNumber,callback:function(e){t.phoneNumber=e},expression:"phoneNumber"}}),t._v(" "),n("el-button",{staticClass:"count-b",class:{disabled:!t.canClick},attrs:{size:"middle"},on:{click:t.sendVerifyCode}},[t._v(t._s(t.content))]),t._v(" "),n("span",{staticClass:"title3"},[t._v(t._s(t.$t("user.verification")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.verificationCode")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.PhoneLogin(e)}},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),t._v(" "),n("div",{staticClass:"agreement"},[n("reg-agreement",{on:{check:t.check}})],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.PhoneLogin}},[t._v("注册/登录，并绑定")])],1)])],1)],1):t._e()}),[],!1,null,"81f3dea0",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,RegAgreement:n(83).default})},function(t,e,n){"use strict";n.r(e);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l=n(23),d=n.n(l),h={mixins:[r.a,c.a,d.a],data:function(){return{title:this.$t("user.quicklogin"),code:"",wechatLogin:{},wechatLoginTimer:null,activeName:"0",ischeck:!0,preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,code=t.code,e=t.preurl;e&&(this.preurl=e),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.createQRcode()},destroyed:function(){window.clearInterval(this.wechatLoginTimer)},methods:{check:function(t){this.ischeck=t},createQRcode:function(){var t=this;this.$store.dispatch("jv/get","/oauth/wechat/pc/qrcode").then((function(e){if(e){t.wechatLogin=e;var n=t;t.wechatLoginTimer=setInterval(n.getLoginStatus,3e3)}}),(function(e){return t.handleError(e)}))},getLoginStatus:function(){var t=this;this.wechatLogin&&!this.wechatLogin.session_token||this.$store.dispatch("jv/get","/oauth/wechat/pc/login/".concat(this.wechatLogin.session_token)).then((function(e){if(e){clearInterval(t.wechatLoginTimer),t.$store.commit("session/SET_USER_ID",e._jv.id),t.$store.commit("session/CHECK_SESSION",!0),t.$store.commit("session/SET_ACCESS_TOKEN",e.access_token);var n=t.$store.getters["session/get"]("userId");t.$store.dispatch("jv/get",["users/".concat(n),{params:{include:"groups,wechat"}}]).then((function(e){e.username&&(t.$message.success(t.$t("user.loginSuccess")),t.logind())}))}}),(function(e){var n=e.response.data.errors;if(Array.isArray(n)&&n.length>0){var r=n[0].detail&&n[0].detail.length>0?n[0].detail[0]:n[0].code,o=n[0].detail&&n[0].detail.length>0?n[0].detail[0]:t.$t("core.".concat(r));if("pc_qrcode_scanning_code"===r)return;if("no_bind_user"===r){var c=n[0].user.nickname,l=n[0].user.headimgurl,d=n[0].token;localStorage.setItem("wechat",d),t.forums&&t.forums.set_reg&&0===t.forums.set_reg.register_type&&t.$router.push("/user/register-bind?nickname=".concat(c,"&headimgurl=").concat(l)),t.forums&&t.forums.set_reg&&1===t.forums.set_reg.register_type&&t.$router.push("/user/wechat-bind-phone?nickname=".concat(c,"&headimgurl=").concat(l))}else clearInterval(t.wechatLoginTimer),t.$message.error(o),t.createQRcode()}}))},toUserlogin:function(){this.$router.push("/user/login?code=".concat(this.code,"&preurl=").concat(this.preurl))},toPhonelogin:function(){this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type?this.$router.push("/user/phone-login-register?code=".concat(this.code,"&preurl=").concat(this.preurl)):this.$router.push("/user/phone-login?code=".concat(this.code,"&preurl=").concat(this.preurl))}}},m=(n(767),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.forums?r("div",{staticClass:"register"},[r("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.forums&&t.forums.passport&&t.forums.passport.oplatform_close?r("el-tab-pane",{attrs:{label:t.forums&&t.forums.set_reg&&2!==t.forums.set_reg.register_type?t.$t("user.quicklogin"):t.$t("user.quicklogin")+"/注册",name:"0"}},[r("div",{staticClass:"quick"},[r("div",{staticClass:"quick-container"},[r("div",{staticClass:"qrcode"},[r("img",{attrs:{src:t.wechatLogin.base64_img}})]),t._v(" "),r("div",{staticClass:"quick-title"},[r("img",{attrs:{src:n(850)}}),t._v(" "),r("span",[t._v("\n              "+t._s(t.forums&&t.forums.set_reg&&2!==t.forums.set_reg.register_type?t.$t("user.wechatlogin"):t.$t("user.wechatlogin")+"/注册")+"\n            ")])]),t._v(" "),r("div",{staticClass:"agreement"},[t.forums&&t.forums.set_reg&&2===t.forums.set_reg.register_type?r("reg-agreement",{attrs:{check:!1},on:{check:t.check}}):t._e()],1),t._v(" "),r("div",{staticClass:"otherlogin"},[t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms&&t.forums.set_reg&&2!==t.forums.set_reg.register_type?r("svg-icon",{staticClass:"phone-icon",attrs:{type:"phonelogin"},on:{click:t.toPhonelogin}}):t._e(),t._v(" "),r("svg-icon",{staticClass:"wechat-icon",attrs:{type:"userlogin"},on:{click:t.toUserlogin}})],1)])])]):t._e()],1)],1):t._e()}),[],!1,null,"69bed754",null);e.default=component.exports;installComponents(component,{RegAgreement:n(83).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var head=n(10),r={mixins:[n.n(head).a],data:function(){return{title:this.$t("core.registerValidate"),username:""}},mounted:function(){var t=this.$route.query.username;t&&(this.username=t)},methods:{home:function(){this.$router.push("/")}}},o=(n(766),n(0)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info"},[n("h2",{staticClass:"info-title"},[t._v(t._s(t.$t("core.registerValidate")))]),t._v(" "),n("div",{staticClass:"payinfo"},[n("p",{staticClass:"payinfo-title"},[t._v('感谢"'+t._s(t.username)+'"用户您的注册')]),t._v(" "),n("p",[n("span",{staticClass:"color"},[t._v(t._s(t.$t("core.regcode")))])]),t._v(" "),n("el-button",{staticClass:"h-button1",attrs:{type:"primary",plain:"",size:"small"},on:{click:t.home}},[t._v("返回首页")])],1)])}),[],!1,null,"a50df118",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l=n(23),d=n.n(l),h=n(114),m={mixins:[r.a,c.a,h,d.a],data:function(){return{title:this.$t("profile.register"),userName:"",passWord:"",repeatPassWord:"",activeName:"0",Reason:"",validate:!1,code:"",register_captcha:!1,site_mode:"",isPaid:!1,captcha:null,ticket:"",randstr:"",ischeck:!0,loading:!1,passerror:!1,mobileToken:"",phoneNumber:"",preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,e=t.validate,code=t.code,n=t.phoneNumber,r=t.preurl;r&&(this.preurl=r),this.mobileToken=localStorage.getItem("mobileToken"),n&&(this.phoneNumber=n),e&&(this.validate=JSON.parse(e)),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_reg&&this.forums.set_reg.register_captcha&&(this.register_captcha=this.forums.set_reg.register_captcha),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&(this.validate=this.forums.set_reg.register_validate)},methods:{notsame:function(){this.passWord!==this.repeatPassWord?this.passerror=!0:this.passerror=!1},check:function(t){this.ischeck=t},register:function(){""===this.userName?this.$message.error("用户名不能为空"):""===this.passWord?this.$message.error("密码不能为空"):this.passWord!==this.repeatPassWord?(this.$message.error("两次输入的密码不一致,请重新输入"),this.passWord="",this.repeatPassWord="",this.passerror=!0):this.ischeck?this.forums&&this.forums.set_reg&&this.forums.set_reg.register_captcha?this.validate&&""===this.Reason?this.$message.error("注册原因不能为空"):this.toTCaptcha():this.registerClick():this.$message.error("请同意协议")},toTCaptcha:function(){var t=this;this.forums&&this.forums.qcloud&&this.forums.qcloud.qcloud_captcha_app_id&&(this.captcha=new TencentCaptcha(this.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret&&(t.ticket=e.ticket,t.randstr=e.randstr,t.registerClick())})),this.captcha.show())},registerClick:function(){var t=this;this.loading=!0;var e={data:{attributes:{username:this.userName,password:this.passWord,mobileToken:this.mobileToken}}};this.register_captcha&&this.validate&&(e.data.attributes.register_reason=this.Reason,e.data.attributes.captcha_ticket=this.ticket,e.data.attributes.captcha_rand_str=this.randstr),this.validate&&(e.data.attributes.register_reason=this.Reason),this.register_captcha&&(e.data.attributes.captcha_ticket=this.ticket,e.data.attributes.captcha_rand_str=this.randstr),""!==this.code&&(e.data.attributes.code=this.code),this.$store.dispatch("session/h5Register",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.$message.success(t.$t("user.registerSuccess"))),e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code)t.$router.push("/user/warning?username=".concat(t.userName));else if(e&&e.data&&e.data.errors&&e.data.errors[0]){var n=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,r=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(n));t.$message.error(r)}})).catch((function(e){t.loading=!1,t.passWord="",t.repeatPassWord=""}))},jump2Login:function(){this.$router.push("/user/login-bind-phone?&validate=".concat(this.validate,"&code=").concat(this.code,"&phoneNumber=").concat(this.phoneNumber,"&preurl=").concat(this.preurl))}}},f=(n(765),n(0)),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("user.registerBindPhone"),name:"0"}},[n("form",[n("div",{staticClass:"bindtext"},[n("div",[t._v(t._s(t.$t("user.phoneuser"))+" "),n("b",[t._v(t._s(t.phoneNumber))]),t._v(" "+t._s(t.$t("user.user")))]),t._v(" "),n("div",[t._v(t._s(t.$t("user.yourPhone"))),n("b",[t._v(t._s(t.$t("user.withoutBind")))]),t._v("，"),n("b",[t._v(t._s(t.$t("user.register")))]),t._v(t._s(t.$t("user.readyBInd")))])]),t._v(" "),n("div",[n("span",{staticClass:"title"},[t._v(t._s(t.$t("profile.username")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.username")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),t._v(" "),n("div",[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.passwd")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.passWord,callback:function(e){t.passWord=e},expression:"passWord"}})],1),t._v(" "),n("div",{class:t.passerror?"rep passerr":"rep"},[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.repeatpasswd")))]),t._v(" "),n("el-input",{class:t.passerror?"reg-input inputerr":"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},on:{input:t.notsame},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.repeatPassWord,callback:function(e){t.repeatPassWord=e},expression:"repeatPassWord"}}),t._v(" "),t.passerror?n("div",{staticClass:"passerror"},[t._v(t._s(t.$t("modify.reenter")))]):t._e()],1),t._v(" "),t.validate?n("div",[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.registerReason")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.reason")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.Reason,callback:function(e){t.Reason=e},expression:"Reason"}})],1):t._e(),t._v(" "),n("div",{staticClass:"agreement"},[n("reg-agreement",{on:{check:t.check}})],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.register}},[t._v("注册并绑定")]),t._v(" "),n("div",{staticClass:"tologin"},[n("span",{on:{click:t.jump2Login}},[t._v(t._s(t.$t("user.exist"))),n("nuxt-link",{attrs:{to:"/user/login-bind-phone"}},[t._v("登录并绑定")])],1)])],1)])],1)],1):t._e()}),[],!1,null,"e8d221ac",null);e.default=component.exports;installComponents(component,{RegAgreement:n(83).default})},function(t,e,n){"use strict";n.r(e);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l=n(23),d=n.n(l),h=n(114),m={mixins:[r.a,c.a,h,d.a],data:function(){return{title:this.$t("profile.register"),userName:"",passWord:"",repeatPassWord:"",activeName:"0",Reason:"",validate:!1,code:"",register_captcha:!1,site_mode:"",isPaid:!1,captcha:null,ticket:"",randstr:"",ischeck:!0,loading:!1,passerror:!1,nickname:"",headimgurl:"",token:"",preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userInfo:function(){return this.$store.state.user.info.attributes||{}}},mounted:function(){var t=this.$route.query,e=t.validate,code=t.code,n=t.nickname,r=t.headimgurl,o=t.preurl;o&&(this.preurl=o),this.token=localStorage.getItem("wechat"),n&&(this.nickname=n),r&&(this.headimgurl=r),e&&(this.validate=JSON.parse(e)),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_reg&&this.forums.set_reg.register_captcha&&(this.register_captcha=this.forums.set_reg.register_captcha),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&(this.validate=this.forums.set_reg.register_validate)},methods:{notsame:function(){this.passWord!==this.repeatPassWord?this.passerror=!0:this.passerror=!1},check:function(t){this.ischeck=t},register:function(){""===this.userName?this.$message.error("用户名不能为空"):""===this.passWord?this.$message.error("密码不能为空"):this.passWord!==this.repeatPassWord?(this.$message.error("两次输入的密码不一致,请重新输入"),this.passWord="",this.repeatPassWord="",this.passerror=!0):this.ischeck?this.forums&&this.forums.set_reg&&this.forums.set_reg.register_captcha?this.validate&&""===this.Reason?this.$message.error("注册原因不能为空"):this.toTCaptcha():this.registerClick():this.$message.error("请同意协议")},toTCaptcha:function(){var t=this;this.forums&&this.forums.qcloud&&this.forums.qcloud.qcloud_captcha_app_id&&(this.captcha=new TencentCaptcha(this.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret&&(t.ticket=e.ticket,t.randstr=e.randstr,t.registerClick())})),this.captcha.show())},registerClick:function(){var t=this;this.loading=!0;var e={data:{attributes:{username:this.userName,password:this.passWord,token:this.token}}};this.register_captcha&&this.validate&&(e.data.attributes.register_reason=this.Reason,e.data.attributes.captcha_ticket=this.ticket,e.data.attributes.captcha_rand_str=this.randstr),this.validate&&(e.data.attributes.register_reason=this.Reason),this.register_captcha&&(e.data.attributes.captcha_ticket=this.ticket,e.data.attributes.captcha_rand_str=this.randstr),""!==this.code&&(e.data.attributes.code=this.code),this.$store.dispatch("session/h5Register",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.$message.success(t.$t("user.registerSuccess"))),e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code)t.$router.push("/user/warning?username=".concat(t.userName));else if(e&&e.data&&e.data.errors&&e.data.errors[0]){var n=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,r=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(n));t.$message.error(r)}})).catch((function(e){t.loading=!1,t.passWord="",t.repeatPassWord=""}))},jump2Login:function(){this.$router.push("/user/login-bind?nickname=".concat(this.nickname,"&headimgurl=").concat(this.headimgurl,"&preurl=").concat(this.preurl))}}},f=(n(764),n(0)),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("user.registerBindWechat"),name:"0"}},[n("form",[n("div",{staticClass:"bindtext"},[n("div",[t._v(t._s(t.$t("user.dear"))+"\n            "),n("avatar",{staticStyle:{display:"inline-block","vertical-align":"text-top"},attrs:{user:{username:t.nickname,avatarUrl:t.headimgurl},size:20,round:!0}}),t._v(" "),n("b",[t._v(t._s(t.nickname||""))]),t._v(" "+t._s(t.$t("user.user")))],1),t._v(" "),n("div",[t._v(t._s(t.$t("user.yourWechat"))),n("b",[t._v(t._s(t.$t("user.withoutBind")))]),t._v("，"),n("b",[t._v(t._s(t.$t("user.register")))]),t._v(t._s(t.$t("user.readyBInd")))])]),t._v(" "),n("div",[n("span",{staticClass:"title"},[t._v(t._s(t.$t("profile.username")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.username")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),t._v(" "),n("div",[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.passwd")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.passWord,callback:function(e){t.passWord=e},expression:"passWord"}})],1),t._v(" "),n("div",{class:t.passerror?"rep passerr":"rep"},[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.repeatpasswd")))]),t._v(" "),n("el-input",{class:t.passerror?"reg-input inputerr":"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},on:{input:t.notsame},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.repeatPassWord,callback:function(e){t.repeatPassWord=e},expression:"repeatPassWord"}}),t._v(" "),t.passerror?n("div",{staticClass:"passerror"},[t._v(t._s(t.$t("modify.reenter")))]):t._e()],1),t._v(" "),t.validate?n("div",[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.registerReason")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.reason")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.Reason,callback:function(e){t.Reason=e},expression:"Reason"}})],1):t._e(),t._v(" "),n("div",{staticClass:"agreement"},[n("reg-agreement",{on:{check:t.check}})],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.register}},[t._v(t._s(t.$t("user.registerbind")))]),t._v(" "),n("div",{staticClass:"tologin"},[n("span",{on:{click:t.jump2Login}},[t._v(t._s(t.$t("user.exist"))),n("nuxt-link",{attrs:{to:"/user/login-bind"}},[t._v(t._s(t.$t("user.loginbind")))])],1)])],1)])],1)],1):t._e()}),[],!1,null,"6020db99",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,RegAgreement:n(83).default})},function(t,e,n){"use strict";n.r(e);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l=n(23),d=n.n(l),h=n(114),m={mixins:[r.a,c.a,h,d.a],data:function(){return{title:this.$t("profile.register"),userName:"",passWord:"",repeatPassWord:"",activeName:"0",Reason:"",validate:!1,code:"",register_captcha:!1,site_mode:"",isPaid:!1,captcha:null,ticket:"",randstr:"",ischeck:!0,loading:!1,passerror:!1,preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,e=t.validate,code=t.code,n=t.preurl;n&&(this.preurl=n),e&&(this.validate=JSON.parse(e)),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_reg&&this.forums.set_reg.register_captcha&&(this.register_captcha=this.forums.set_reg.register_captcha),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&(this.validate=this.forums.set_reg.register_validate)},methods:{notsame:function(){this.passWord!==this.repeatPassWord?this.passerror=!0:this.passerror=!1},check:function(t){this.ischeck=t},register:function(){""===this.userName?this.$message.error("用户名不能为空"):""===this.passWord?this.$message.error("密码不能为空"):this.passWord!==this.repeatPassWord?(this.$message.error("两次输入的密码不一致,请重新输入"),this.passWord="",this.repeatPassWord="",this.passerror=!0):this.ischeck?this.forums&&this.forums.set_reg&&this.forums.set_reg.register_captcha?this.validate&&""===this.Reason?this.$message.error("注册原因不能为空"):this.toTCaptcha():this.registerClick():this.$message.error("请同意协议")},toTCaptcha:function(){var t=this;this.forums&&this.forums.qcloud&&this.forums.qcloud.qcloud_captcha_app_id&&(this.captcha=new TencentCaptcha(this.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret&&(t.ticket=e.ticket,t.randstr=e.randstr,t.registerClick())})),this.captcha.show())},registerClick:function(){var t=this;this.loading=!0;var e={data:{attributes:{username:this.userName,password:this.passWord}}};this.register_captcha&&this.validate&&(e.data.attributes.register_reason=this.Reason,e.data.attributes.captcha_ticket=this.ticket,e.data.attributes.captcha_rand_str=this.randstr),this.validate&&(e.data.attributes.register_reason=this.Reason),this.register_captcha&&(e.data.attributes.captcha_ticket=this.ticket,e.data.attributes.captcha_rand_str=this.randstr),""!==this.code&&(e.data.attributes.code=this.code),this.$store.dispatch("session/h5Register",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.$message.success(t.$t("user.registerSuccess"))),e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code)t.$router.push("/user/warning?username=".concat(t.userName));else if(e&&e.data&&e.data.errors&&e.data.errors[0]){var n=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,r=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(n));t.$message.error(r)}})).catch((function(e){t.loading=!1,t.passWord="",t.repeatPassWord=""}))},jump2Login:function(){this.$router.push("/user/login?&validate=".concat(this.validate,"&code=").concat(this.code,"&preurl=").concat(this.preurl))}}},f=(n(763),n(0)),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"用户名注册",name:"0"}},[n("form",[n("div",[n("span",{staticClass:"title"},[t._v(t._s(t.$t("profile.username")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.username")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),t._v(" "),n("div",[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.passwd")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.passWord,callback:function(e){t.passWord=e},expression:"passWord"}})],1),t._v(" "),n("div",{class:t.passerror?"rep passerr":"rep"},[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.repeatpasswd")))]),t._v(" "),n("el-input",{class:t.passerror?"reg-input inputerr":"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},on:{input:t.notsame},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.repeatPassWord,callback:function(e){t.repeatPassWord=e},expression:"repeatPassWord"}}),t._v(" "),t.passerror?n("div",{staticClass:"passerror"},[t._v(t._s(t.$t("modify.reenter")))]):t._e()],1),t._v(" "),t.validate?n("div",[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.registerReason")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.reason")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.register(e)}},model:{value:t.Reason,callback:function(e){t.Reason=e},expression:"Reason"}})],1):t._e(),t._v(" "),n("div",{staticClass:"agreement"},[n("reg-agreement",{on:{check:t.check}})],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.register}},[t._v(t._s(t.$t("user.register")))]),t._v(" "),n("div",{staticClass:"tologin"},[n("span",{on:{click:t.jump2Login}},[t._v(t._s(t.$t("user.exist"))),n("nuxt-link",{attrs:{to:"/user/login"}},[t._v(t._s(t.$t("user.login")))])],1)])],1)])],1)],1):t._e()}),[],!1,null,"3dfc10dd",null);e.default=component.exports;installComponents(component,{RegAgreement:n(83).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(28),n(13)),head=n(10),c=n.n(head),l=n(1),d=n.n(l),h=n(55),m=n.n(h),f=n(82),v=n.n(f),_=n(23),y=n.n(_),w={mixins:[c.a,d.a,m.a,v.a,y.a],data:function(){return{title:"手机号登录/注册",phoneNumber:"",content:this.$t("modify.sendVerifyCode"),activeName:"0",verifyCode:"",code:"",site_mode:"",isPaid:!1,canClick:!0,ischeck:!0,loading:!1,preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,code=t.code,e=t.preurl;e&&(this.preurl=e),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode)},methods:{check:function(t){this.ischeck=t},changeinput:function(){var t=this;setTimeout((function(){t.phoneNumber=t.phoneNumber.replace(/[^\d]/g,"")}),30),11===this.phoneNumber.length?this.canClick=!0:this.canClick=!1},sendVerifyCode:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={_jv:{type:"sms/send"},mobile:t.phoneNumber,type:"login"},e.next=3,t.checkCaptcha(n);case 3:n=e.sent,o.b.run((function(){return t.$store.dispatch("jv/post",n)})).then((function(e){e.interval&&t.countDown(e.interval)}),(function(e){return t.handleError(e)}));case 5:case"end":return e.stop()}}),e)})))()},PhoneLogin:function(){var t=this;if(this.loading=!0,""===this.phoneNumber)this.$message.error("手机号不能为空"),this.loading=!1;else if(""===this.verifyCode)this.$message.error("验证码不能为空"),this.loading=!1;else{var e={data:{attributes:{mobile:this.phoneNumber,code:this.verifyCode,type:"login",register:1}}};this.code&&"undefined"!==this.code&&(e.data.attributes.inviteCode=this.code),this.$store.dispatch("session/verificationCodeh5Login",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.$message.success(t.$t("user.loginSuccess"))),e&&e.data&&e.data.errors&&"no_bind_user"===e.data.errors[0].code){var n=e.data.errors[0].token;return localStorage.setItem("mobileToken",n),t.logind(),void t.$message.success(t.$t("user.loginSuccess"))}if(e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code)t.$router.push("/user/warning?username=".concat(t.phoneNumber));else if(e&&e.data&&e.data.errors&&e.data.errors[0]){var r=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,o=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(r));t.$message.error(o)}})).catch((function(e){t.loading=!1,t.handleError(e)}))}},toWechat:function(){this.$router.push("/user/wechat?code=".concat(this.code,"&preurl=").concat(this.preurl))},toUserlogin:function(){this.$router.push("/user/login?code=".concat(this.code,"&preurl=").concat(this.preurl))}}},C=(n(762),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms?n("el-tab-pane",{attrs:{label:t.$t("user.phonelogin")+"/注册",name:"0"}},[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("profile.mobile")))]),t._v(" "),n("el-input",{staticClass:"phone-input",attrs:{placeholder:t.$t("user.phoneNumber"),maxlength:"11"},model:{value:t.phoneNumber,callback:function(e){t.phoneNumber=e},expression:"phoneNumber"}}),t._v(" "),n("el-button",{staticClass:"count-b",class:{disabled:!t.canClick},attrs:{size:"middle"},on:{click:t.sendVerifyCode}},[t._v(t._s(t.content))]),t._v(" "),n("span",{staticClass:"title3"},[t._v(t._s(t.$t("user.verification")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.verificationCode")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.PhoneLogin(e)}},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),t._v(" "),n("div",{staticClass:"agreement"},[n("reg-agreement",{on:{check:t.check}})],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.PhoneLogin}},[t._v(t._s(t.$t("user.login")))]),t._v(" "),n("div",{staticClass:"otherlogin"},[t.forums&&t.forums.passport&&t.forums.passport.oplatform_close&&t.forums.passport.offiaccount_close?n("svg-icon",{staticClass:"wechat-icon",attrs:{type:"wechatlogin"},on:{click:t.toWechat}}):t._e(),t._v(" "),n("svg-icon",{staticClass:"wechat-icon",attrs:{type:"userlogin"},on:{click:t.toUserlogin}})],1)],1):t._e()],1)],1):t._e()}),[],!1,null,"ebc0b00c",null);e.default=component.exports;installComponents(component,{RegAgreement:n(83).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(28),n(13)),head=n(10),c=n.n(head),l=n(1),d=n.n(l),h=n(55),m=n.n(h),f=n(82),v=n.n(f),_=n(23),y=n.n(_),w={mixins:[c.a,d.a,m.a,v.a,y.a],data:function(){return{title:"手机号登录",phoneNumber:"",content:this.$t("modify.sendVerifyCode"),activeName:"0",verifyCode:"",code:"",site_mode:"",isPaid:!1,canClick:!0,ischeck:!0,loading:!1,preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,code=t.code,e=t.preurl;e&&(this.preurl=e),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode)},methods:{check:function(t){this.ischeck=t},changeinput:function(){var t=this;setTimeout((function(){t.phoneNumber=t.phoneNumber.replace(/[^\d]/g,"")}),30),11===this.phoneNumber.length?this.canClick=!0:this.canClick=!1},sendVerifyCode:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={_jv:{type:"sms/send"},mobile:t.phoneNumber,type:"login"},e.next=3,t.checkCaptcha(n);case 3:n=e.sent,o.b.run((function(){return t.$store.dispatch("jv/post",n)})).then((function(e){e.interval&&t.countDown(e.interval)}),(function(e){return t.handleError(e)}));case 5:case"end":return e.stop()}}),e)})))()},PhoneLogin:function(){var t=this;if(this.loading=!0,""===this.phoneNumber)this.$message.error("手机号不能为空"),this.loading=!1;else if(""===this.verifyCode)this.$message.error("验证码不能为空"),this.loading=!1;else{var e={data:{attributes:{mobile:this.phoneNumber,code:this.verifyCode,type:"login"}}};this.code&&"undefined"!==this.code&&(e.data.attributes.inviteCode=this.code),this.$store.dispatch("session/verificationCodeh5Login",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.$message.success(t.$t("user.loginSuccess"))),e&&e.data&&e.data.errors&&"no_bind_user"===e.data.errors[0].code){var n=e.data.errors[0].token;return localStorage.setItem("mobileToken",n),void t.$router.push("/user/register-bind-phone?phoneNumber=".concat(t.phoneNumber))}if(e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code)t.$router.push("/user/warning?username=".concat(t.phoneNumber));else if(e&&e.data&&e.data.errors&&e.data.errors[0]){var r=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,o=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(r));t.$message.error(o)}})).catch((function(e){t.loading=!1,t.handleError(e)}))}},toWechat:function(){this.$router.push("/user/wechat?code=".concat(this.code,"&preurl=").concat(this.preurl))},toUserlogin:function(){this.$router.push("/user/login?code=".concat(this.code,"&preurl=").concat(this.preurl))}}},C=(n(760),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms?n("el-tab-pane",{attrs:{label:t.$t("user.phonelogin"),name:"0"}},[n("span",{staticClass:"title2"},[t._v(t._s(t.$t("profile.mobile")))]),t._v(" "),n("el-input",{staticClass:"phone-input",attrs:{placeholder:t.$t("user.phoneNumber"),maxlength:"11"},model:{value:t.phoneNumber,callback:function(e){t.phoneNumber=e},expression:"phoneNumber"}}),t._v(" "),n("el-button",{staticClass:"count-b",class:{disabled:!t.canClick},attrs:{size:"middle"},on:{click:t.sendVerifyCode}},[t._v(t._s(t.content))]),t._v(" "),n("span",{staticClass:"title3"},[t._v(t._s(t.$t("user.verification")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.verificationCode")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.PhoneLogin(e)}},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),t._v(" "),n("div",{staticClass:"agreement"},[n("reg-agreement",{on:{check:t.check}})],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.PhoneLogin}},[t._v(t._s(t.$t("user.login")))]),t._v(" "),n("div",{staticClass:"otherlogin"},[t.forums&&t.forums.passport&&t.forums.passport.oplatform_close&&t.forums.passport.offiaccount_close?n("svg-icon",{staticClass:"wechat-icon",attrs:{type:"wechatlogin"},on:{click:t.toWechat}}):t._e(),t._v(" "),n("svg-icon",{staticClass:"wechat-icon",attrs:{type:"userlogin"},on:{click:t.toUserlogin}})],1)],1):t._e()],1)],1):t._e()}),[],!1,null,"57a8b1d0",null);e.default=component.exports;installComponents(component,{RegAgreement:n(83).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),c=n(23),l=n.n(c),head=n(10),d={mixins:[n.n(head).a,o.a,l.a],data:function(){return{title:this.$t("user.login"),userName:"",passWord:"",checked:!0,activeName:"0",site_mode:"",isPaid:!1,code:"",loading:!1,canReg:!1,ischeck:!0,mobileToken:"",phoneNumber:"",preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,e=t.phoneNumber,code=t.code,n=t.preurl;n&&(this.preurl=n),this.mobileToken=localStorage.getItem("mobileToken"),e&&(this.phoneNumber=e),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&this.forums.set_reg.register_close&&(this.canReg=!0)},methods:{check:function(t){this.ischeck=t},UserLogin:function(){var t=this;if(this.loading=!0,""===this.userName)this.$message.error("用户名不能为空"),this.loading=!1;else if(""===this.passWord)this.$message.error("密码不能为空"),this.loading=!1;else{var e={data:{attributes:{username:this.userName,password:this.passWord,mobileToken:this.mobileToken}}};this.$store.dispatch("session/h5Login",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.userName="",t.passWord="",t.$message.success("登录成功")),e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code&&t.$router.push("/user/warning?username=".concat(t.userName)),e&&e.data&&e.data.errors&&e.data.errors[0]){var n=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,r=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(n));t.$message.error(r)}})).catch((function(e){t.loading=!1}))}},toRegister:function(){this.$router.push("/user/register-bind-phone?code=".concat(this.code,"&phoneNumber=").concat(this.phoneNumber,"&preurl=").concat(this.preurl))},iscanReg:function(){return[this.canReg?"":"noreg"]}}},h=(n(759),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("user.loginBindPhone"),name:"0"}},[n("form",[n("div",{staticClass:"bindtext"},[n("div",[t._v(t._s(t.$t("user.phoneuser"))+" "),n("b",[t._v(t._s(t.phoneNumber))]),t._v(" "+t._s(t.$t("user.user")))]),t._v(" "),n("div",[t._v(t._s(t.$t("user.loginToBind")))])]),t._v(" "),n("span",{staticClass:"title"},[t._v(t._s(t.$t("user.usrname")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.username")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.pwd")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.UserLogin(e)}},model:{value:t.passWord,callback:function(e){t.passWord=e},expression:"passWord"}}),t._v(" "),n("div",{staticClass:"agreement"},[n("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}),t._v(" "),n("span",{staticClass:"agree"},[t._v(t._s(t.$t("user.status"))+" ")])],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.UserLogin}},[t._v(t._s(t.$t("user.loginbind")))]),t._v(" "),n("div",{staticClass:"logorreg"},[t.canReg?n("span",[t._v("\n            "+t._s(t.$t("user.noexist"))+"\n            "),n("span",{staticClass:"agreement_text",on:{click:t.toRegister}},[t._v(" "+t._s(t.$t("user.registerbind")))])]):t._e()])],1)])],1)],1):t._e()}),[],!1,null,"f9e95ec2",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l=n(23),d=n.n(l),h={mixins:[r.a,c.a,d.a],data:function(){return{title:this.$t("user.login"),userName:"",passWord:"",checked:!0,activeName:"0",site_mode:"",isPaid:!1,code:"",loading:!1,canReg:!1,ischeck:!0,nickname:"",headimgurl:"",token:"",preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userInfo:function(){return this.$store.state.user.info.attributes||{}}},mounted:function(){var t=this.$route.query,code=t.code,e=t.nickname,n=t.headimgurl,r=t.preurl;r&&(this.preurl=r),this.token=localStorage.getItem("wechat"),e&&(this.nickname=e),n&&(this.headimgurl=n),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&this.forums.set_reg.register_close&&(this.canReg=!0)},methods:{check:function(t){this.ischeck=t},UserLogin:function(){var t=this;if(this.loading=!0,""===this.userName)this.$message.error("用户名不能为空"),this.loading=!1;else if(""===this.passWord)this.$message.error("密码不能为空"),this.loading=!1;else{var e={data:{attributes:{username:this.userName,password:this.passWord,token:this.token}}};this.$store.dispatch("session/h5Login",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.userName="",t.passWord="",t.$message.success("登录成功")),e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code&&t.$router.push("/user/warning?username=".concat(t.userName)),e&&e.data&&e.data.errors&&e.data.errors[0]){var n=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,r=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(n));t.$message.error(r)}})).catch((function(e){t.loading=!1}))}},toRegister:function(){this.$router.push("/user/register-bind?nickname=".concat(this.nickname,"&headimgurl=").concat(this.headimgurl,"&preurl=").concat(this.preurl))},iscanReg:function(){return[this.canReg?"":"noreg"]}}},m=(n(758),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("user.loginBindWechat"),name:"0"}},[n("form",[n("div",{staticClass:"bindtext"},[n("div",[t._v(t._s(t.$t("user.dear"))+"\n            "),n("avatar",{staticStyle:{display:"inline-block","vertical-align":"text-top"},attrs:{user:{username:t.nickname,avatarUrl:t.headimgurl},size:20,round:!0}}),t._v(" "),n("b",[t._v(t._s(t.nickname||""))]),t._v(" "+t._s(t.$t("user.user")))],1),t._v(" "),n("div",[t._v(t._s(t.$t("user.changeWechat")))])]),t._v(" "),n("span",{staticClass:"title"},[t._v(t._s(t.$t("user.usrname")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.username")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.pwd")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.UserLogin(e)}},model:{value:t.passWord,callback:function(e){t.passWord=e},expression:"passWord"}}),t._v(" "),n("div",{staticClass:"agreement"},[n("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}),t._v(" "),n("span",{staticClass:"agree"},[t._v(t._s(t.$t("user.status"))+" ")])],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.UserLogin}},[t._v(t._s(t.$t("user.loginbind")))]),t._v(" "),n("div",{staticClass:"logorreg"},[t.canReg?n("span",[t._v("\n            "+t._s(t.$t("user.noexist"))+"\n            "),n("span",{staticClass:"agreement_text",on:{click:t.toRegister}},[t._v(" "+t._s(t.$t("user.registerbind")))])]):t._e()])],1)])],1)],1):t._e()}),[],!1,null,"641b8c72",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default})},function(t,e,n){"use strict";n.r(e);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l=n(23),d=n.n(l),h={mixins:[r.a,c.a,d.a],data:function(){return{title:this.$t("user.login"),userName:"",passWord:"",checked:!0,activeName:"0",site_mode:"",isPaid:!1,code:"",loading:!1,canReg:!1,ischeck:!0,preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=this.$route.query,code=t.code,e=t.preurl;e&&(this.preurl=e),"undefined"!==code&&(this.code=code),this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.site_mode=this.forums.set_site.site_mode),this.forums&&this.forums.set_reg&&this.forums.set_reg.register_close&&(this.canReg=!0)},methods:{check:function(t){this.ischeck=t},UserLogin:function(){var t=this;if(this.loading=!0,""===this.userName)this.$message.error("用户名不能为空"),this.loading=!1;else if(""===this.passWord)this.$message.error("密码不能为空"),this.loading=!1;else{var e={data:{attributes:{username:this.userName,password:this.passWord}}};this.$store.dispatch("session/h5Login",e).then((function(e){if(t.loading=!1,e&&e.data&&e.data.data&&e.data.data.id&&(t.logind(),t.userName="",t.passWord="",t.$message.success("登录成功")),e&&e.data&&e.data.errors&&"register_validate"===e.data.errors[0].code&&t.$router.push("/user/warning?username=".concat(t.userName)),e&&e.data&&e.data.errors&&e.data.errors[0]){var n=e.data.errors[0].detail?e.data.errors[0].detail[0]:e.data.errors[0].code,r=e.data.errors[0].detail?e.data.errors[0].detail[0]:t.$t("core.".concat(n));t.$message.error(r)}})).catch((function(e){t.loading=!1}))}},toRegister:function(){this.$router.push("/user/register?code=".concat(this.code,"&preurl=").concat(this.preurl))},iscanReg:function(){return[this.canReg&&this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type?"":"noreg"]},toWechat:function(){this.$router.push("/user/wechat?code=".concat(this.code,"&preurl=").concat(this.preurl))},toPhonelogin:function(){this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type?this.$router.push("/user/phone-login-register?code=".concat(this.code,"&preurl=").concat(this.preurl)):this.$router.push("/user/phone-login?code=".concat(this.code,"&preurl=").concat(this.preurl))}}},m=(n(757),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.forums?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"register"},[n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.$t("user.userlogin"),name:"0"}},[n("form",[n("span",{staticClass:"title"},[t._v(t._s(t.$t("user.usrname")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.username")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),n("span",{staticClass:"title2"},[t._v(t._s(t.$t("user.pwd")))]),t._v(" "),n("el-input",{staticClass:"reg-input",attrs:{placeholder:t.$t("user.password"),type:"password","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.UserLogin(e)}},model:{value:t.passWord,callback:function(e){t.passWord=e},expression:"passWord"}}),t._v(" "),n("div",{staticClass:"agreement"},[n("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}),t._v(" "),n("span",{staticClass:"agree"},[t._v(t._s(t.$t("user.status"))+" ")])],1),t._v(" "),n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.UserLogin}},[t._v(t._s(t.$t("user.login")))]),t._v(" "),n("div",{staticClass:"logorreg"},[t.canReg&&t.forums&&t.forums.set_reg&&0===t.forums.set_reg.register_type?n("span",[t._v("\n            "+t._s(t.$t("user.noexist"))+"\n            "),n("span",{staticClass:"agreement_text",on:{click:t.toRegister}},[t._v(" "+t._s(t.$t("user.register")))])]):t._e(),t._v(" "),t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms?n("nuxt-link",{class:["findpass",t.iscanReg()],attrs:{to:"/modify/findpwd"}},[t._v("\n            "+t._s(t.$t("modify.findpawdtitle")))]):t._e()],1),t._v(" "),n("div",{staticClass:"otherlogin"},[t.forums&&t.forums.passport&&t.forums.passport.oplatform_close&&t.forums.passport.offiaccount_close?n("svg-icon",{staticClass:"wechat-icon",attrs:{type:"wechatlogin"},on:{click:t.toWechat}}):t._e(),t._v(" "),t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms&&t.forums.set_reg&&2!==t.forums.set_reg.register_type?n("svg-icon",{staticClass:"phone-icon",attrs:{type:"phonelogin"},on:{click:t.toPhonelogin}}):t._e(),t._v(" "),t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms&&t.forums.set_reg&&2===t.forums.set_reg.register_type&&t.forums.passport&&!t.forums.passport.oplatform_close?n("svg-icon",{staticClass:"phone-icon",attrs:{type:"phonelogin"},on:{click:t.toPhonelogin}}):t._e()],1)],1)])],1)],1):t._e()}),[],!1,null,"10e7de7e",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r={data:function(){return{type:"",forums:"",popTitle:"‎",popDetail:""}},mounted:function(){var t=this.$route.query.type;this.type=t,this.getAttachMent()},methods:{getAttachMent:function(){var t=this;this.$store.dispatch("jv/get",["forum",{params:{include:"users","filter[tag]":"agreement"}}]).then((function(e){t.forums=e,t.open(t.type)}))},open:function(t){"register"===t?(this.popTitle=this.$t("permission.user.agreementRegister"),this.popDetail=this.forums.agreement.register_content):(this.popTitle=this.$t("permission.user.agreementPrivacy"),this.popDetail=this.forums.agreement.privacy_content)}},head:function(){return{title:this.forums&&this.forums.set_site&&this.forums.set_site.site_name?this.popTitle+" - "+this.forums.set_site.site_name:this.popTitle}}},o=(n(756),n(0)),component=Object(o.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"agreement"},[e("div",{staticClass:"container"},[e("div",{staticClass:"title"},[this._v(this._s(this.popTitle))]),this._v(" "),e("div",{staticClass:"content"},[this._v(this._s(this.popDetail))])])])}),[],!1,null,"24ba9fa2",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);n(28),n(18);var r=n(13),head=n(10),o=n.n(head),c=n(1),l=n.n(c),d=n(709),h=n.n(d),m=n(114),f={layout:"center_layout",mixins:[o.a,l.a,h.a,m],data:function(){return{title:this.$t("profile.myprofile"),userInfo:"",num:140,wordnumber:"",signcontent:"",content:this.$t("modify.sendVerifyCode"),content2:this.$t("modify.sendVerifyCode"),canClick:!0,canClick2:!1,captcha:null,ticket:"",randstr:"",newVerifyCode:"",newPhoneNumber:"",newphon:"",setnum:"",novice:"",oldPassWord:"",newPassWord:"",renewPassword:"",realName:"",idNumber:"",newName:"",isSignModify:!1,isMobileModify:!1,isPassModify:!1,isWechatModify:!1,isRealModify:!1,isNameModify:!1,isMobileVerify:!1,loading:!0,rebind:!1,isShowAvatar:!1,passerror:!1,isChange:!1,phoneError:!1}},computed:{inputVal:{get:function(){return this.signcontent},set:function(t){this.signcontent=t}},forums:function(){return this.$store.state.site.info.attributes||{}},userId:function(){return this.$store.getters["session/get"]("userId")},avataruserInfo:function(){return this.$store.state.user.info.attributes||{}}},watch:{userId:function(t){t&&this.userinfo()}},mounted:function(){this.userId&&this.userinfo(),this.$route.query.phonebind&&(this.isMobileModify=!0)},methods:{countDown:function(t){var e=this;if(this.canClick){this.canClick=!1,this.content=t+this.$t("modify.retransmission");var n=setInterval((function(){t--,e.content=t+e.$t("modify.retransmission"),t<0&&(clearInterval(n),e.content=e.$t("modify.sendVerifyCode"),e.canClick=!0)}),1e3)}},countDown2:function(t){var e=this;if(this.canClick2){this.canClick2=!1,this.content2=t+this.$t("modify.retransmission");var n=window.setInterval((function(){t--,e.content2=t+e.$t("modify.retransmission"),t<0&&(window.clearInterval(n),e.content2=e.$t("modify.sendVerifyCode"),e.canClick2=!0)}),1e3)}},userinfo:function(){var t=this;this.$store.dispatch("jv/get",["users/".concat(this.userId),{params:{include:"groups,wechat"}}]).then((function(e){t.loading=!1,t.userInfo=e,t.signcontent=t.userInfo.signature,t.userInfo.groupsName=t.userInfo.groups?t.userInfo.groups[0].name:"",t.wordnumber=t.signcontent.length}),(function(e){var n=e.response.data.errors;if(n&&Array.isArray(n)&&n.length>0&&n[0]){var r=n[0].detail&&n[0].detail.length>0?n[0].detail[0]:n[0].code;if("Invalid includes [wechat]"===r)t.$message.error(r),localStorage.removeItem("access_token"),localStorage.removeItem("user_id"),window.location.replace("/");else{var o=n[0].detail&&n[0].detail.length>0?n[0].detail[0]:t.$t("core.".concat(r));t.$message.error(o)}}}))},setAvatar:function(){this.isShowAvatar=!0},changeShow:function(t){this.isShowAvatar=t,this.$store.dispatch("user/getUserInfo",this.userId)},fun:function(t){this.wordnumber=t.length},signModify:function(){var t=this;this.isSignModify=!this.isSignModify,this.$nextTick((function(){t.$refs.sign.focus()}))},sigComfirm:function(){var t=this,e={_jv:{type:"users",id:this.userId},signature:this.inputVal};r.b.run((function(){return t.$store.dispatch("jv/patch",e)})).then((function(e){e&&(t.isSignModify=!t.isSignModify,t.$message.success(t.$t("modify.modificationsucc")),t.userinfo())}),(function(e){return t.handleError(e)}))},changeinput:function(){var t=this;this.isChange=!0,""===this.newphon&&(this.isChange=!1),setTimeout((function(){t.newphon=t.newphon.replace(/[^\d]/g,"")}),30),this.newphon.length<11?(this.canClick=!0,this.canClick2=!1):11===this.newphon.length&&(this.canClick=!0,this.canClick2=!0,this.novice=this.newphon.replace(/\s+/g,""))},sendsms:function(){/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.novice)?this.forums.qcloud.qcloud_captcha?this.tcaptcha():this.rebind?this.sendVerifyCode2():this.setphon():this.$message.error("手机号错误")},sendsms2:function(){this.newphon="",this.forums.qcloud.qcloud_captcha?this.tcaptcha():this.sendVerifyCode()},tcaptcha:function(){var t=this;this.captcha=new TencentCaptcha(this.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret&&(t.ticket=e.ticket,t.randstr=e.randstr,t.novice?t.rebind?t.sendVerifyCode2():t.setphon():t.sendVerifyCode())})),this.captcha.show()},setphon:function(){var t=this,e={_jv:{type:"sms/send"},mobile:this.novice,type:"bind",captcha_ticket:this.ticket,captcha_rand_str:this.randstr};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e.interval&&t.countDown(e.interval),t.ticket="",t.randstr=""}),(function(e){return t.handleError(e)}))},dingphon:function(){this.newphon&&this.bindphon()},bindphon:function(){var t=this,e={_jv:{type:"sms/verify"},mobile:this.newphon,code:this.setnum,type:"bind"};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e&&(t.isMobileModify=!t.isMobileModify,t.$message.success(t.$t("modify.phontitle")),t.userinfo(),t.$store.dispatch("user/getUserInfo",t.userId),t.newphon="")}),(function(e){return t.handleError(e)}))},mobileModify:function(){this.isMobileModify=!this.isMobileModify},mobileVerify:function(){this.isMobileVerify=!this.isMobileVerify},sendVerifyCode:function(){var t=this;this.canClick=!0;var e={_jv:{type:"sms/send"},type:"verify",captcha_ticket:this.ticket,captcha_rand_str:this.randstr};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e.interval&&t.countDown(e.interval),t.rebind=!0,t.ticket="",t.randstr=""}),(function(e){return t.handleError(e)}))},sendVerifyCode2:function(){var t=this,e={_jv:{type:"sms/send"},mobile:this.novice,type:"rebind",captcha_ticket:this.ticket,captcha_rand_str:this.randstr};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e.interval&&t.countDown2(e.interval),t.rebind=!0,t.ticket="",t.randstr=""}),(function(e){return t.handleError(e)}))},mobileComfirm:function(){this.oldVerify()},oldError:function(){this.isMobileModify=!1,this.phoneError=!1},oldVerify:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={_jv:{type:"sms/verify"},code:e,type:"verify"};this.$store.dispatch("jv/post",n).then((function(e){e&&(t.isMobileModify=!1,t.isMobileVerify=!0)}),(function(e){t.$refs.verifyphone.empty(),t.phoneError=!0,t.handleError(e)}))},newVerify:function(){var t=this,e={_jv:{type:"sms/verify"},mobile:this.newphon,code:this.newVerifyCode,type:"rebind"};r.b.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(e){e&&(t.isMobileModify=!1,t.isMobileVerify=!1,t.$message.success(t.$t("modify.phontitle")),t.newVerifyCode="",t.newphon="",t.userinfo(),t.$store.dispatch("user/getUserInfo",t.userId))}),(function(e){t.handleError(e),t.newVerifyCode="",t.newphon=""}))},passModify:function(){var t=this;this.isPassModify=!this.isPassModify,this.$refs.oldpass&&this.$nextTick((function(){t.$refs.oldpass.focus()}))},passSub:function(){this.oldPassWord&&this.newPassWord&&this.renewPassword&&this.newPassWord===this.renewPassword?this.passwordComfirm():this.oldPassWord?this.newPassWord?this.newPassWord!==this.renewPassword&&(this.$message.error(this.$t("modify.masstext")),this.passerror=!0):this.$message.error(this.$t("modify.newpassword")):this.$message.error(this.$t("modify.oldpassword"))},notsame:function(){this.newPassWord!==this.renewPassword?this.passerror=!0:this.passerror=!1},passSub2:function(){this.newPassWord&&this.renewPassword&&this.newPassWord===this.renewPassword?this.passwordComfirm():this.newPassWord?this.newPassWord!==this.renewPassword&&(this.$message.error(this.$t("modify.masstext")),this.passerror=!0):this.$message.error(this.$t("modify.newpassword"))},passwordComfirm:function(){var t=this,e={_jv:{type:"users",id:this.userId},password:this.oldPassWord,newPassword:this.newPassWord,password_confirmation:this.renewPassword};r.b.run((function(){return t.$store.dispatch("jv/patch",e)})).then((function(e){e&&(t.$message.success(t.$t("modify.titlepassword")),t.isPassModify=!t.isPassModify,t.oldPassWord="",t.newPassWord="",t.renewPassword="",t.passerror=!1,t.userinfo())}),(function(e){return t.handleError(e)}))},wechatModify:function(){var t=this;this.isWechatModify=!this.isWechatModify,this.wehcatTimer&&window.clearInterval(this.wehcatTimer),this.isWechatModify&&!this.userInfo.wechat?this.createQRcode():this.isWechatModify&&this.userInfo.wechat&&this.userInfo.wechat&&this.$confirm('\n        <i class="el-icon-warning" style=" width: 25px;height: 25px;font-size: 25px;color: #E6A23C;position: absolute;left: 0px;"></i>\n        <p style="margin-left:40px;">确定解除微信绑定?</p>\n        <p style="margin-bottom:50px;margin-left:40px;margin-top:10px;">您确定要解除微信'.concat(this.userInfo.wechat.nickname,"和用户账号的绑定么？</p>"),{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0}).then((function(){t.$store.dispatch("jv/delete",["users/".concat(t.userId,"/wechat")]).then((function(e){e&&(t.isWechatModify=!1,t.userinfo(),t.$message({type:"success",message:"解绑成功!"}))}),(function(e){return t.handleError(e)}))})).catch((function(){t.isWechatModify=!1,t.$message({type:"info",message:"已取消解绑"})}))},realModify:function(){var t=this;this.isRealModify=!this.isRealModify,this.$nextTick((function(){t.$refs.realname.focus()}))},realSub:function(){this.realName&&this.idNumber?this.idNumber.length<18||this.idNumber.length>18?this.$message.error(this.$t("modify.idtitl")):this.authentication():this.realName?this.idNumber||this.$message.error(this.$t("modify.idcardisempty")):this.$message.error(this.$t("modify.emptyname"))},authentication:function(){var t=this,e={_jv:{type:"users/real"},realname:this.realName,identity:this.idNumber};r.b.run((function(){return t.$store.dispatch("jv/patch",e)})).then((function(e){t.isRealModify=!t.isRealModify,t.userinfo(),t.$store.dispatch("user/getUserInfo",t.userId),t.$message.success(t.$t("modify.nameauthensucc"))}),(function(e){var n=e.response.data.errors;422===n[0].statusCode&&n[0].detail||"422"===n[0].status&&n[0].detail?t.$message.error(n[0].detail[0]):n[0].detail&&t.$message.error(n[0].detail)}))},usernameModify:function(){var t=this;this.isNameModify=!this.isNameModify,this.$nextTick((function(){t.$refs.username.focus()}))},nameSub:function(){this.newName?this.newName===this.userInfo.username?this.$message.error(this.$t("modify.repeatname")):this.changename():this.$message.error(this.$t("modify.emptyname"))},changename:function(){var t=this,e={_jv:{type:"users",id:this.userId},username:this.newName};r.b.run((function(){return t.$store.dispatch("jv/patch",e)})).then((function(e){e&&(t.isNameModify=!t.isNameModify,t.$message.success(t.$t("modify.modifysucc"))),t.userinfo(),t.$store.dispatch("user/getUserInfo",t.userId)}),(function(e){return t.handleError(e)}))},toTopic:function(){this.$router.push("/user/".concat(this.userId,"?current=1"))},toFollowing:function(){this.$router.push("/user/".concat(this.userId,"?current=4"))},toFollowers:function(){this.$router.push("/user/".concat(this.userId,"?current=5"))},toLikes:function(){this.$router.push("/user/".concat(this.userId,"?current=3"))},toQuestion:function(){this.$router.push("/user/".concat(this.userId,"?current=2"))}}},v=(n(710),n(0)),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"myprofile"},[t.userInfo?n("div",{staticClass:"myprofile-c",staticStyle:{"padding-bottom":"0px"}},[n("div",{staticClass:"myprofile-top mtop"},[n("Avatar",{staticClass:"avatar",attrs:{user:{id:t.userInfo.id,username:t.userInfo.username,avatarUrl:t.avataruserInfo.avatarUrl,isReal:t.avataruserInfo.isReal},size:50,round:!0}}),t._v(" "),n("div",{staticClass:"usr"},[n("span",{staticClass:"usrname"},[t._v("\n          "+t._s(t.userInfo.username)+"\n          "),t.userInfo&&t.userInfo.isReal?n("span",{staticClass:"iden"},[n("svg-icon",{staticClass:"auth-icon",attrs:{type:"auth"}}),t._v(" "),n("span",{staticClass:"real"},[t._v(t._s(t.$t("modify.isrealname")))])],1):t.userInfo&&!t.userInfo.isReal&&t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_faceid?n("span",{staticClass:"iden"},[n("svg-icon",{staticClass:"auth-icon",attrs:{type:"warning"}}),t._v(" "),n("span",{staticClass:"nreal"},[t._v(t._s(t.$t("modify.norealname")))])],1):t._e()]),t._v(" "),n("span",{staticClass:"usrid"},[t._v(t._s(t.userInfo&&t.userInfo.groupsName?t.userInfo.groupsName:""))])]),t._v(" "),n("span",{staticClass:"setavatar"},[n("span",{staticClass:"setbutton",on:{click:t.setAvatar}},[t._v(t._s(t.$t("modify.setavatar")))])]),t._v(" "),t.isShowAvatar?n("show-avatar",{attrs:{"user-id":t.userId},on:{change:t.changeShow}}):t._e()],1),t._v(" "),n("div",{staticClass:"myprofile-bottom"},[n("div",{staticClass:"myprofile-title marglef",on:{click:t.toTopic}},[n("span",[t._v(t._s(t.$t("profile.topic")))]),t._v(" "),n("span",{staticClass:"num"},[t._v(t._s(t.userInfo.threadCount))])]),t._v(" "),n("div",{staticClass:"myprofile-title",on:{click:t.toQuestion}},[n("span",[t._v(t._s(t.$t("profile.question")))]),t._v(" "),n("span",{staticClass:"num"},[t._v(t._s(t.userInfo.questionCount))])]),t._v(" "),n("div",{staticClass:"myprofile-title",on:{click:t.toFollowing}},[n("span",[t._v(t._s(t.$t("profile.following")))]),t._v(" "),n("span",{staticClass:"num"},[t._v(t._s(t.userInfo.followCount))])]),t._v(" "),n("div",{staticClass:"myprofile-title",on:{click:t.toFollowers}},[n("span",[t._v(t._s(t.$t("profile.followers")))]),t._v(" "),n("span",{staticClass:"num"},[t._v(t._s(t.userInfo.fansCount))])]),t._v(" "),n("div",{staticClass:"myprofile-title",on:{click:t.toLikes}},[n("span",[t._v(t._s(t.$t("profile.likes")))]),t._v(" "),n("span",{staticClass:"num"},[t._v(t._s(t.userInfo.likedCount))])])])]):t._e(),t._v(" "),t.userInfo?n("div",{class:t.isNameModify?"myprofile-c bgcolor":"myprofile-c"},[n("div",{class:{profileborder:!0,pborder:!t.isNameModify}},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("profile.username")))]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.userInfo&&t.userInfo.canEditUsername,expression:"userInfo && userInfo.canEditUsername"}],staticClass:"setavatar"},[n("span",{staticClass:"setbutton",on:{click:t.usernameModify}},[t._v(t._s(t.isNameModify?t.$t("profile.cancelModify"):t.$t("profile.modify")))])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isNameModify,expression:"!isNameModify"}],staticClass:"myprofile-btom2"},[t._v(t._s(t.userInfo&&t.userInfo.username?t.userInfo.username:""))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isNameModify,expression:"isNameModify"}],staticClass:"myprofile-btom"},[n("el-dialog",{attrs:{title:t.$t("profile.username"),visible:t.isNameModify,width:"620px","before-close":t.usernameModify},on:{"update:visible":function(e){t.isNameModify=e}}},[n("form",{staticClass:"form"},[n("el-input",{ref:"username",staticClass:"passbtom",attrs:{placeholder:t.$t("modify.numbermodifitions")},model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}}),t._v(" "),n("el-button",{staticClass:"ebutton",attrs:{type:"primary"},on:{click:t.nameSub}},[t._v(t._s(t.$t("profile.confirmModify")))])],1)])],1)])]):t._e(),t._v(" "),t.userInfo?n("div",{class:t.isSignModify?"myprofile-c bgcolor":"myprofile-c"},[n("div",{staticClass:"profileborder"},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("modify.signaturetitle")))]),t._v(" "),n("span",{staticClass:"setavatar"},[n("span",{staticClass:"setbutton",on:{click:t.signModify}},[t._v(t._s(t.isSignModify?t.$t("profile.cancelModify"):t.$t("profile.modify")))])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isSignModify,expression:"!isSignModify"}],class:""!==t.userInfo.signature?"myprofile-btom-sign":"myprofile-btom-sign signcolor"},[t._v(t._s(t.userInfo.signature?t.userInfo.signature:t.$t("modify.nosignature")))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isSignModify,expression:"isSignModify"}],staticClass:"text"},[n("el-dialog",{attrs:{title:t.$t("modify.signaturetitle"),visible:t.isSignModify,width:"620px","before-close":t.signModify},on:{"update:visible":function(e){t.isSignModify=e}}},[n("form",[n("el-input",{ref:"sign",attrs:{type:"textarea",rows:5,placeholder:t.$t("modify.inputsignautre")},on:{input:t.fun},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}}),t._v(" "),n("div",{staticClass:"cannum"},[t._v(t._s(t.$t("modify.canalsoinput")+""+(t.num-t.wordnumber)+t.$t("modify.wordnumber")))]),t._v(" "),n("div",{staticClass:"confirmbtn"},[n("div",{staticClass:"allbtn"},[n("el-button",{staticClass:"comfirm",attrs:{type:"small"},on:{click:t.sigComfirm}},[t._v(t._s(this.$t("report.confirm")))]),t._v(" "),n("el-button",{staticClass:"cancel",attrs:{type:"small"},on:{click:t.signModify}},[t._v(t._s(this.$t("report.cancel")))])],1)])],1)])],1)])]):t._e(),t._v(" "),t.userInfo&&t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_sms?n("div",{staticClass:"myprofile-c",class:t.isMobileModify?"myprofile-c bgcolor":"myprofile-c"},[n("div",{staticClass:"profileborder"},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("profile.mobile")))]),t._v(" "),n("span",{staticClass:"setavatar"},[n("span",{staticClass:"setbutton",on:{click:t.mobileModify}},[t._v("\n            "+t._s(t.isMobileModify?t.$t("profile.cancelModify"):t.userInfo.mobile?t.$t("profile.modify"):t.$t("profile.bindingmobile"))+"\n          ")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMobileModify,expression:"!isMobileModify"}],staticClass:"myprofile-btom2"},[n("div",{class:t.userInfo.mobile?"pmobile":""},[t._v(t._s(t.userInfo.mobile?t.userInfo.mobile:t.$t("modify.setphontitle")))])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isMobileModify&&t.userInfo.mobile,expression:"(isMobileModify && userInfo.mobile)"}],staticClass:"myprofile-btom"},[n("div",{staticClass:"pmobile"},[t._v(t._s(t.userInfo.mobile))]),t._v(" "),t.isMobileModify&&t.userInfo.mobile?n("verify-phone",{ref:"verifyphone",attrs:{error:t.phoneError,mobile:t.userInfo.mobile},on:{close:t.oldError,password:t.oldVerify,sendsms:t.sendsms2}}):t._e()],1),t._v(" "),n("el-dialog",{attrs:{title:t.$t("profile.bindingmobile"),visible:t.isMobileVerify,width:"620px","before-close":t.mobileVerify},on:{"update:visible":function(e){t.isMobileVerify=e}}},[n("form",{staticClass:"form"},[n("el-input",{class:t.isChange?"phone-input phonechange":"phone-input",attrs:{placeholder:t.$t("modify.newphonnumber")},on:{input:t.changeinput},model:{value:t.newphon,callback:function(e){t.newphon=e},expression:"newphon"}}),t._v(" "),n("el-button",{staticClass:"count-b",class:{disabled:!t.canClick2},attrs:{disabled:!t.canClick2,size:"middle"},on:{click:t.sendsms}},[t._v(t._s(t.content2))]),t._v(" "),n("el-input",{staticClass:"passbtom",attrs:{placeholder:t.$t("modify.inputnewverifycode")},model:{value:t.newVerifyCode,callback:function(e){t.newVerifyCode=e},expression:"newVerifyCode"}}),t._v(" "),n("el-button",{staticClass:"ebutton",attrs:{type:"primary"},on:{click:t.newVerify}},[t._v(t._s(t.$t("profile.submitchange")))])],1)]),t._v(" "),t.isMobileModify&&!t.userInfo.mobile?n("div",{staticClass:"myprofile-btom"},[n("el-dialog",{attrs:{title:t.$t("profile.bindingmobile"),visible:t.isMobileModify,width:"620px","before-close":t.mobileModify},on:{"update:visible":function(e){t.isMobileModify=e}}},[n("form",{staticClass:"form"},[n("el-input",{ref:"oldphone",class:t.isChange?"phone-input phonechange":"phone-input",attrs:{maxlength:"11",placeholder:t.$t("modify.newphon")},on:{input:t.changeinput},model:{value:t.newphon,callback:function(e){t.newphon=e},expression:"newphon"}}),t._v(" "),n("el-button",{staticClass:"count-b",class:{disabled:!t.canClick},attrs:{disabled:!t.canClick,size:"middle"},on:{click:t.sendsms}},[t._v(t._s(t.content))]),t._v(" "),n("el-input",{staticClass:"passbtom",attrs:{placeholder:t.$t("modify.newverifycode")},model:{value:t.setnum,callback:function(e){t.setnum=e},expression:"setnum"}}),t._v(" "),n("el-button",{staticClass:"ebutton",attrs:{type:"primary"},on:{click:t.dingphon}},[t._v(t._s(t.$t("profile.submitchange")))])],1)])],1):t._e()],1)]):t._e(),t._v(" "),t.userInfo?n("div",{class:t.isPassModify?"myprofile-c bgcolor":"myprofile-c"},[n("div",{staticClass:"profileborder"},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("profile.password")))]),t._v(" "),n("span",{staticClass:"setavatar"},[n("span",{staticClass:"setbutton",on:{click:t.passModify}},[t._v("\n            "+t._s(t.isPassModify?t.userInfo&&t.userInfo.hasPassword?t.$t("profile.cancelModify"):"取消设置":t.userInfo&&t.userInfo.hasPassword?t.$t("profile.modify"):"设置")+"\n          ")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isPassModify,expression:"!isPassModify"}],staticClass:"myprofile-btom2"},[t._v(t._s(t.userInfo&&t.userInfo.hasPassword?t.$t("profile.isset"):t.$t("profile.withoutsetpass")))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isPassModify,expression:"isPassModify"}],staticClass:"myprofile-btom"},[t.userInfo&&t.userInfo.hasPassword?n("div",[n("el-dialog",{attrs:{title:t.$t("profile.password"),visible:t.isPassModify,width:"620px","before-close":t.passModify},on:{"update:visible":function(e){t.isPassModify=e}}},[n("form",{staticClass:"form"},[n("el-input",{ref:"oldpass",staticClass:"passbtom",attrs:{placeholder:t.$t("modify.enterold"),type:"password","show-password":""},model:{value:t.oldPassWord,callback:function(e){t.oldPassWord=e},expression:"oldPassWord"}}),t._v(" "),n("el-input",{staticClass:"passbtom",attrs:{placeholder:t.$t("modify.enterNew"),type:"password","show-password":""},model:{value:t.newPassWord,callback:function(e){t.newPassWord=e},expression:"newPassWord"}}),t._v(" "),n("div",{class:t.passerror?"rep passerr":"rep"},[n("el-input",{class:t.passerror?"passbtom inputerr":"passbtom",attrs:{placeholder:t.$t("modify.enterNewRepeat"),type:"password","show-password":""},on:{input:t.notsame},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.passSub(e)}},model:{value:t.renewPassword,callback:function(e){t.renewPassword=e},expression:"renewPassword"}}),t._v(" "),t.passerror?n("div",{staticClass:"passerror"},[t._v(t._s(t.$t("modify.reenter")))]):t._e()],1),t._v(" "),n("el-button",{staticClass:"ebutton",attrs:{type:"primary"},on:{click:t.passSub}},[t._v(t._s(t.$t("profile.submitchange")))])],1)])],1):n("div",[n("el-dialog",{attrs:{title:t.$t("profile.password"),visible:t.isPassModify,width:"620px","before-close":t.passModify},on:{"update:visible":function(e){t.isPassModify=e}}},[n("form",{staticClass:"form"},[n("el-input",{staticClass:"passbtom",attrs:{placeholder:t.$t("modify.enterNew"),type:"password","show-password":""},model:{value:t.newPassWord,callback:function(e){t.newPassWord=e},expression:"newPassWord"}}),t._v(" "),n("div",{class:t.passerror?"rep passerr":"rep"},[n("el-input",{class:t.passerror?"passbtom inputerr":"passbtom",attrs:{placeholder:t.$t("modify.enterNewRepeat"),type:"password","show-password":""},on:{input:t.notsame},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.passSub2(e)}},model:{value:t.renewPassword,callback:function(e){t.renewPassword=e},expression:"renewPassword"}}),t._v(" "),t.passerror?n("div",{staticClass:"passerror"},[t._v(t._s(t.$t("modify.reenter")))]):t._e()],1),t._v(" "),n("el-button",{staticClass:"ebutton",attrs:{type:"primary"},on:{click:t.passSub2}},[t._v(t._s(t.$t("modify.submit")))])],1)])],1)])])]):t._e(),t._v(" "),t.userInfo&&t.forums&&t.forums.passport&&t.forums.passport.oplatform_close?n("div",{class:t.isWechatModify?"myprofile-c bgcolor":"myprofile-c"},[n("div",{staticClass:"profileborder"},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("profile.wechat")))]),t._v(" "),n("el-button",{staticClass:"setavatar",attrs:{type:"text"}},[n("span",{staticClass:"setbutton",on:{click:t.wechatModify}},[t._v("\n            "+t._s(t.isWechatModify?t.userInfo&&t.userInfo.wechat&&t.userInfo.wechat.nickname?"取消解绑":"取消绑定":t.userInfo&&t.userInfo.wechat&&t.userInfo.wechat.nickname?"解绑":"绑定")+"\n          ")])])],1),t._v(" "),n("div",{staticClass:"myprofile-btom2"},[t._v("\n        "+t._s(t.userInfo&&t.userInfo.wechat?t.userInfo.wechat.nickname:t.$t("profile.withoutbindwechat"))+"\n      ")]),t._v(" "),t.isWechatModify&&t.userInfo&&!t.userInfo.wechat?n("div",{staticClass:"wehcat-bind"},[n("el-dialog",{attrs:{visible:t.isWechatModify,width:"180px","before-close":t.wechatModify},on:{"update:visible":function(e){t.isWechatModify=e}}},[n("div",{staticClass:"qrcode-text"},[n("svg-icon",{staticClass:"wechat-logo",attrs:{type:"wechat-logo"}}),t._v(" "),n("span",{staticClass:"qrtext"},[t._v("微信扫码绑定")])],1),t._v(" "),n("el-image",{staticClass:"qr-code",attrs:{src:t.wechatBind.base64_img}}),t._v(" "),n("div",[t._v("请用微信扫一扫")]),t._v(" "),n("div",{staticClass:"scanqr"},[t._v("扫码上方二维码")])],1)],1):t._e()])]):t._e(),t._v(" "),t.userInfo&&!t.userInfo.realname&&t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_faceid?n("div",{class:t.isRealModify?"myprofile-c bgcolor":"myprofile-c"},[n("div",{staticClass:"profileborder"},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("modify.realnametitle")))]),t._v(" "),n("span",{staticClass:"setavatar"},[n("span",{staticClass:"setbutton",on:{click:t.realModify}},[t._v("\n            "+t._s(t.isRealModify?t.$t("profile.cancelcertification"):t.$t("profile.tocertification"))+"\n          ")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isRealModify,expression:"!isRealModify"}],staticClass:"myprofile-btom2 myprofile-btom3"},[t._v(t._s(t.userInfo&&t.userInfo.realname?t.$t("profile.isset"):t.$t("profile.withoutcertification")))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isRealModify,expression:"isRealModify"}],staticClass:"myprofile-btom"},[n("el-dialog",{attrs:{title:t.$t("modify.realnametitle"),visible:t.isRealModify,width:"620px","before-close":t.realModify},on:{"update:visible":function(e){t.isRealModify=e}}},[n("form",{staticClass:"form"},[n("el-input",{ref:"realname",staticClass:"passbtom",attrs:{placeholder:t.$t("modify.realname")},model:{value:t.realName,callback:function(e){t.realName=e},expression:"realName"}}),t._v(" "),n("el-input",{staticClass:"passbtom",attrs:{placeholder:t.$t("modify.enteridnumber")},model:{value:t.idNumber,callback:function(e){t.idNumber=e},expression:"idNumber"}}),t._v(" "),n("el-button",{staticClass:"ebutton",attrs:{type:"primary"},on:{click:t.realSub}},[t._v(t._s(t.$t("profile.comfirmsubmit")))])],1)])],1)])]):t._e(),t._v(" "),t.userInfo&&t.userInfo.realname&&t.forums&&t.forums.qcloud&&t.forums.qcloud.qcloud_faceid?n("div",{staticClass:"myprofile-c"},[n("div",{staticClass:"profileborder"},[n("div",{staticClass:"myprofile-top"},[n("span",{staticClass:"sig"},[t._v(t._s(t.$t("modify.realnametitle")))])]),t._v(" "),n("div",{staticClass:"myprofile-btom2 myprofile-btom3"},[t._v("\n        "+t._s(t.userInfo&&t.userInfo.realname?t.userInfo.realname+" ("+t.userInfo.identity+")":"")+"\n      ")])])]):t._e()])}),[],!1,null,"3c5ebc32",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,SvgIcon:n(11).default,ShowAvatar:n(805).default,VerifyPhone:n(806).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(19),n(25);var r=n(7),o=(n(9),n(12)),c=(n(16),n(8)),l=n(1),d=n.n(l),head=n(10),h=n.n(head),m=n(27);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _="user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio",y={layout:"custom_layout",name:"Index",mixins:[h.a,d.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,h,f,y,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,o=t.query,m.a.isSpider||e(null,{}),c={include:_,"filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","page[limit]":10,"filter[location]":"".concat(o.longitude,",").concat(o.latitude)},l={include:"groups",limit:4},n.prev=4,d={},n.next=8,r.dispatch("jv/get",["threads",{params:c}]);case 8:return h=n.sent,n.next=11,r.dispatch("jv/get",["users/recommended",{params:l}]);case 11:f=n.sent,Array.isArray(h)?d.threadsData=h.slice(0,10):h&&h._jv&&h._jv.json&&((y=h._jv.json.data||[]).forEach((function(t,e){y[e]=v(v(v({},t),t.attributes),{},{firstPost:t.relationships.firstPost.data,user:t.relationships.user.data,groups:t.relationships.groups.data,_jv:{id:t.id}})})),d.threadsData=y),Array.isArray(f)?d.recommendUserData=f:f&&f._jv&&f._jv.json&&((w=f._jv.json.data||[]).forEach((function(t,e){w[e]=v(v({},t),t.attributes)})),d.recommendUserData=w),e(null,d),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(4),e(null,{});case 20:case"end":return n.stop()}}),n,null,[[4,17]])})))()},data:function(){return{title:this.$t("home.location"),loading:!1,index_loading:!0,threadsData:[],total:0,recommendUserData:[],pageNum:1,pageSize:10,hasMore:!1,longitude:"",latitude:"",location:"",address:"",currentAudioId:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{$route:"init"},mounted:function(){this.init()},methods:{init:function(){this.threadsData=[],this.$route.query&&this.$route.query.longitude&&this.$route.query.latitude&&(this.longitude=this.$route.query.longitude,this.latitude=this.$route.query.latitude,this.getThreadsList())},getThreadsList:function(){var t=this;this.loading=!0;var e={include:_,"filter[isApproved]":1,"filter[isDeleted]":"no","filter[isDisplay]":"yes","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[location]":"".concat(this.longitude,",").concat(this.latitude)};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(e){t.hasMore=e.length===t.pageSize,t.total=e._jv.json.meta.threadCount,1===t.pageNum?(t.threadsData=e,!t.address&&e.length>0&&(t.address=e[0].address),!t.location&&e.length>0&&(t.location=e[0].location)):t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(e)),t.pageNum+=1,e._jv&&(t.hasMore=t.threadsData.length<e._jv.json.meta.threadCount)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1,t.index_loading=!1}))},loadMore:function(){this.getThreadsList()},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},w=(n(755),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.index_loading,expression:"index_loading"}],staticClass:"location-container"},[t.location||t.address?n("header",{staticClass:"location-info"},[n("svg-icon",{staticClass:"icon",attrs:{type:"location-map"}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"location"},[t._v(t._s(t.location))]),t._v(" "),n("div",{staticClass:"address"},[t._v(t._s(t.address))])])],1):t._e(),t._v(" "),n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("div",{staticClass:"thread-count"},[t._v(t._s(t.$t("home.threadCount",{total:t.total})))]),t._v(" "),n("div",{staticClass:"post-list"},[t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsData.length},on:{loadMore:t.loadMore}})],2)]),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"background-color"},[n("advertising")],1),t._v(" "),n("div",{staticClass:"recommend-user background-color"},[n("recommend-user",{attrs:{list:t.recommendUserData}})],1),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])])}),[],!1,null,"9c1c5bd8",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,Header:n(107).default,PostItem:n(57).default,ListLoadMore:n(40).default,Advertising:n(62).default,RecommendUser:n(89).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(19),n(25);var r=n(7),o=(n(9),n(12)),c=(n(16),n(8)),l=n(1),d=n.n(l),h=n(27),head=n(10),m=n.n(head);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _={layout:"custom_layout",name:"TopicContent",mixins:[d.a,m.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,m,f,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,h.a.isSpider||e(null,{}),o={include:"lastThread,lastThread.firstPost,lastThread.firstPost.images","page[limit]":10},c={include:"groups",limit:4},n.prev=4,l={},n.next=8,r.dispatch("jv/get",["topics",{params:o}]);case 8:return d=n.sent,n.next=11,r.dispatch("jv/get",["users/recommended",{params:c}]);case 11:m=n.sent,Array.isArray(d)?l.topicsData=d.slice(0,10):d&&d._jv&&d._jv.json&&((f=d._jv.json.data||[]).forEach((function(t,e){f[e]=v(v(v({},t),t.attributes),{},{_jv:{id:t.id}})})),l.topicsData=f),Array.isArray(m)?l.recommendUserData=m:m&&m._jv&&m._jv.json&&((_=m._jv.json.data||[]).forEach((function(t,e){_[e]=v(v({},t),t.attributes)})),l.recommendUserData=_),e(null,l),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(4),e(null,{});case 20:case"end":return n.stop()}}),n,null,[[4,17]])})))()},data:function(){return{title:this.$t("topic.topictitlelist"),loading:!1,topicsData:[],total:0,recommendUserData:[],pageNum:1,pageSize:10,hasMore:!1,filterSort:[{label:this.$t("topic.hot"),value:"-viewCount"},{label:this.$t("topic.contents"),value:"-threadCount"}],sort:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){this.getTopicList()},methods:{getTopicList:function(){var t=this;this.loading=!0;var e={include:"lastThread,lastThread.firstPost,lastThread.firstPost.images","page[number]":this.pageNum,"page[limit]":this.pageSize,sort:this.sort};this.$store.dispatch("jv/get",["topics",{params:e}]).then((function(e){t.hasMore=e.length===t.pageSize,1===t.pageNum?t.topicsData=e:t.topicsData=[].concat(Object(r.a)(t.topicsData),Object(r.a)(e)),t.pageNum+=1,e&&e._jv&&e._jv.json&&e._jv.json.meta&&(t.hasMore=t.topicsData.length<e._jv.json.meta.total,t.total=e._jv.json.meta.total)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getTopicList()},handleCommandSort:function(t){this.sort=t,this.pageNum=1,this.topicsData=[],this.getTopicList()}}},y=(n(752),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-content-container"},[n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("div",{staticClass:"header-filter"},[n("div",{staticClass:"title"},[t._v(t._s(t.total+t.$t("topic.topicCount")))]),t._v(" "),n("div",{staticClass:"filter"},[n("el-dropdown",{staticClass:"filter-dropdown",attrs:{placement:"bottom"},on:{command:t.handleCommandSort}},[n("span",{staticClass:"el-dropdown-link",class:{active:""!==t.sort}},[t._v("\n              "+t._s(t.$t("core.sort"))),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.filterSort,(function(e,r){return n("el-dropdown-item",{key:r,class:{active:e.value===t.sort},attrs:{command:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)]),t._v(" "),n("div",{staticClass:"topic-list"},[t._l(t.topicsData,(function(t,e){return[n("topic-item",{key:e,attrs:{item:t}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.topicsData.length},on:{loadMore:t.loadMore}})],2)]),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"background-color"},[n("advertising")],1),t._v(" "),n("div",{staticClass:"recommend-user background-color"},[n("recommend-user",{attrs:{list:t.recommendUserData}})],1),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])])}),[],!1,null,"034c81ab",null);e.default=component.exports;installComponents(component,{TopicItem:n(807).default,ListLoadMore:n(40).default,Advertising:n(62).default,RecommendUser:n(89).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);n(61),n(77),n(715),n(18),n(24),n(9);var head=n(10),r=n.n(head),o=n(1),c=n.n(o),l={layout:"center_layout",mixins:[r.a,c.a],data:function(){return{title:this.$t("profile.myshield"),activeName:"all",shieldList:[],shieldTotal:0,pageNum:1,pageSize:10,loading:!1,loading2:!1,hasMore:!1,unbundlingArry:[],unbundUserData:[],shieldType:"",isSearch:!1,inputVal:"",time:null,userList:[],searchTotal:0}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},mounted:function(){this.getShieldList(),this.getShieldData()},methods:{handleSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getShieldList()},handleCurrentChange:function(t){this.pageNum=t,this.getShieldList()},handleSizeChange2:function(t){this.pageNum=1,this.pageSize=t,this.getUserList(this.inputVal)},handleCurrentChange2:function(t){this.pageNum=t,this.getUserList(this.inputVal)},getShieldData:function(){var t=this;this.loading=!0,this.$store.dispatch("jv/get","users/".concat(this.userId,"/deny")).then((function(e){t.unbundUserData=[],t.unbundUserData.push(Number(t.userId)),e.forEach((function(n,i){t.unbundUserData.push(e[i].id)})),t.shieldTotal=e.length}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))},getShieldList:function(){var t=this;this.loading=!0;var e={"page[limit]":this.pageSize,"page[number]":this.pageNum};this.$store.dispatch("jv/get",["users/".concat(this.userId,"/deny"),{params:e}]).then((function(e){t.shieldList=e}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))},changeshield:function(t){var e=this;this.$confirm("是否解除屏蔽该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.unbundlingUser(t)})).catch((function(){e.$message({type:"info",message:"已取消解除屏蔽"})}))},unbundlingUser:function(t){var e=this;this.$store.dispatch("jv/delete","users/".concat(t,"/deny")).then((function(){e.unbundlingArry.push(t),e.$message.success(e.$t("profile.unboundsucceed")),e.getShieldList(),e.getShieldData()}))},addShield:function(){this.isSearch=!0,this.userList=[],this.searchTotal=0},onClickSearch:function(t){this.inputVal=t.target.value,this.unbundlingArry=[],this.userList=[],this.pageNum=1,this.getUserList(t.target.value)},searchinput:function(){this.userList=[],this.searchTotal=0},getUserList:function(t){var e=this;this.loading2=!0;var n={include:"groups",sort:"createdAt","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[username]":"*".concat(t,"*")};this.$store.dispatch("jv/get",["users",{params:n}]).then((function(t){var n=t;n.forEach((function(t,i){n[i].groupName=t.groups[0]?t.groups[0].name:""}));var data=n.filter((function(t){return-1===e.unbundUserData.indexOf(t.id)}));e.userList=data,e.searchTotal=n._jv.json.meta.total}),(function(t){return e.handleError(t)})).finally((function(){e.loading2=!1}))},shieldUser:function(t){var e=this;this.uid=t,this.$confirm("是否屏蔽该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.handleShield()})).catch((function(){e.$message({type:"info",message:"已取消屏蔽"})}))},handleShield:function(){var t=this,e={_jv:{type:"users/".concat(this.uid,"/deny")}};this.$store.dispatch("jv/post",e).then((function(){t.unbundlingID(t.uid)&&t.unbundlingArry.splice(t.unbundlingArry.findIndex((function(e){return e===t.uid})),1),t.inputVal="",t.pageNum=1,t.getUserList(""),t.getShieldData(),t.getShieldList(),t.isSearch=!1,t.$message.success(t.$t("profile.boundsucceed"))}))},unbundlingID:function(t){if(this.unbundlingArry&&this.unbundlingArry.includes(t))return!0}}},d=(n(716),n(0)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shield-container"},[t.shieldList.length>=0?n("div",[n("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:t.isSearch?t.$t("profile.addshield"):t.$t("profile.myshield"),name:"all"}})],1),t._v(" "),t.isSearch?n("div",{staticClass:"shieldtop"},[n("div",{class:0===t.userList.length?"shieldnum hide":"shieldnum"},[t._v("\n        "+t._s(t.$t("manage.find"))+"\n        "),n("span",{staticClass:"searchusr"},[t._v('"'+t._s(t.inputVal)+'"')]),t._v("\n        "+t._s(t.$t("profile.searchresult"))+t._s(t.searchTotal)+t._s(t.$t("topic.item"))+"\n      ")]),t._v(" "),n("el-input",{staticClass:"shieldsearch",attrs:{autocomplete:"off",size:"small",placeholder:t.$t("invite.searchPlaceholder")},on:{input:t.searchinput},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onClickSearch(e)}},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[n("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.onClickSearch},slot:"suffix"})])],1):n("div",{staticClass:"shieldtop"},[n("div",{staticClass:"shieldnum"},[t._v("\n        "+t._s(t.$t("profile.totalshield"))+t._s(t.shieldTotal)+t._s(t.$t("profile.person"))+"\n      ")]),t._v(" "),n("el-button",{staticClass:"shieldbtn",attrs:{type:"primary",size:"small"},on:{click:t.addShield}},[t._v(t._s(t.$t("profile.addshield")))])],1),t._v(" "),t.isSearch?t.searchTotal>0?n("div",{staticClass:"shieldtable"},[n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{data:t.userList}},[n("el-table-column",{attrs:{label:t.$t("manage.userName"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"flex"},[n("avatar",{attrs:{user:{id:e.row.id,username:e.row.username,avatarUrl:e.row.avatarUrl},size:30,round:!0}}),t._v(" "),n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+e.row.id}},[t._v(t._s(e.row.username))])],1)]}}],null,!1,712560739)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.identity"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.groupName)+"\n            ")]}}],null,!1,3853133765)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.operate"),width:"97"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"operabtn",attrs:{type:"text"},on:{click:function(n){return t.shieldUser(e.row.id)}}},[t._v(t._s(t.$t("profile.shield")))])]}}],null,!1,4135945611)})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"","pager-count":5,"current-page":t.pageNum,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.searchTotal},on:{"size-change":t.handleSizeChange2,"current-change":t.handleCurrentChange2}})],1)]):[t.hasMore?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v(t._s(t.$t("topic.showMore")))]):n("div",{staticClass:"no-more"},[0===t.userList.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v(t._s(t.userList.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n      ")],1)]:n("div",{staticClass:"shieldtable"},[t.shieldTotal>0?n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.shieldList}},[n("el-table-column",{attrs:{label:t.$t("manage.userName"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"flex"},[n("avatar",{attrs:{user:{id:e.row.id,username:e.row.username,avatarUrl:e.row.avatarUrl},size:30,round:!0}}),t._v(" "),n("nuxt-link",{staticClass:"user-name",attrs:{to:"/user/"+e.row.id}},[t._v(t._s(e.row.username))])],1)]}}],null,!1,712560739)}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("manage.operate"),width:"97"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"operabtn",attrs:{type:"text"},on:{click:function(n){return t.changeshield(e.row.id)}}},[t._v(t._s(t.$t("profile.deleteshield")))])]}}],null,!1,3522184869)})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.pageNum,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.shieldTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):[t.hasMore?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v(t._s(t.$t("topic.showMore")))]):n("div",{staticClass:"no-more"},[0===t.shieldList.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v(t._s(t.shieldList.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noshield"))+"\n        ")],1)]],2)],2):t._e()])}),[],!1,null,"5e1482b4",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,SvgIcon:n(11).default})},function(t,e,n){"use strict";n.r(e);var r=n(13),head=n(10),o=n.n(head),c=n(1),l=n.n(c),d={layout:"center_layout",mixins:[o.a,l.a],data:function(){return{title:this.$t("profile.mywallet"),isWithdraw:!1,inputpas:"",usertokenid:"",showNewverify:!1,showNewverify2:!1,setPasswordInput:!1,repPasswordInput:!1,showPasswordInput:!1,passError:!1,codeError:!1,loadingType:"",dataInfo:"",hasPassword:!1,issendcode:!1,isfindpwd:!1,isWithoutphone:!1,passwordErrorTip:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userId:function(){return this.$store.getters["session/get"]("userId")}},watch:{userId:function(t){t&&this.getInfo()}},mounted:function(){this.userId&&this.getInfo()},methods:{updateWithdraw:function(){this.isWithdraw=!1,this.$refs.cash.getList()},showWithdraw:function(){this.isWithdraw=!0},setPassword:function(){this.setPasswordInput=!0},changePassword:function(){this.showPasswordInput=!0},repeatclose:function(){this.showNewverify2=!1,this.codeError=!1},validatePass:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={_jv:{type:"users/pay-password/reset"},pay_password:e},o=r.b.run((function(){return t.$store.dispatch("jv/post",n)}));o.then((function(e){e._jv.json.data.id&&(t.passError=!1,t.showPasswordInput=!1,t.$message.success(t.$t("modify.authensucceeded")),t.showNewverify=!0,t.usertokenid=e._jv.json.data.id)})).catch((function(e){t.$refs.walletpass.empty();var n=e.response.data.errors;if("validation_error"===n[0].code)return t.passError=!0,void(t.passwordErrorTip=n[0].detail[0]);t.handleError(e)}))},checkpass:function(t){t.length>=6&&(this.inputpas=t,this.showNewverify=!1,this.showNewverify2=!0)},checkpass2:function(t){t.length>=6&&this.validateVerify(t)},setPass:function(t){t.length>=6&&(this.inputpas=t,this.setPasswordInput=!1,this.repPasswordInput=!0)},setPass2:function(t){t.length>=6&&this.validateVerify(t)},validateVerify:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={_jv:{type:"users",id:this.userId},pay_password_token:this.usertokenid,payPassword:this.inputpas,pay_password_confirmation:e},o=r.b.run((function(){return t.$store.dispatch("jv/patch",n)}));o.then((function(e){t.inputpas="",e&&(t.repPasswordInput=!1,t.showNewverify2=!1,t.$message.success(t.$t("modify.paymentsucceed")),t.getInfo())})).catch((function(e){t.$refs.repeatnewpass&&t.$refs.repeatnewpass.empty(),t.$refs.repeatpass&&t.$refs.repeatpass.empty(),t.codeError=!0,t.handleError(e)}))},getInfo:function(){var t=this;r.b.run((function(){return t.$store.dispatch("jv/get","wallet/user/".concat(t.userId))})).then((function(e){t.dataInfo=e,t.hasPassword=e.user.canWalletPay}),(function(e){return t.handleError(e)}))},findPaypwd:function(){this.dataInfo.user.mobile?this.isfindpwd=!0:this.isWithoutphone=!0}}},h=(n(717),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.dataInfo?n("div",{staticClass:"mywallet"},[n("div",{staticClass:"mywallet-top"},[n("div",{staticClass:"mywallet-topitem"},[n("div",{staticClass:"margbtm"},[t._v(t._s(t.$t("profile.availableamount")))]),t._v(" "),t.dataInfo.available_amount>0?n("div",{staticClass:"amount",staticStyle:{color:"#1878F3"}},[t._v(t._s("¥ "+(t.dataInfo&&t.dataInfo.available_amount||0))+"\n        "),n("span",{staticClass:"availmount",on:{click:t.showWithdraw}},[t._v(t._s(t.$t("modify.withdratitle")))])]):n("div",{staticClass:"amount"},[t._v(t._s("¥ "+(t.dataInfo&&t.dataInfo.available_amount||0))+"\n        "),n("span",{staticClass:"availmount",on:{click:t.showWithdraw}},[t._v(t._s(t.$t("modify.withdratitle")))])])]),t._v(" "),n("div",{staticClass:"mywallet-topitem mymarg"},[n("div",{staticClass:"margbtm"},[t._v(t._s(t.$t("profile.freezeamount")))]),t._v(" "),t.dataInfo.freeze_amount>0?n("div",{staticClass:"amount",staticStyle:{color:"#FA5151"}},[t._v(t._s("¥ "+(t.dataInfo&&t.dataInfo.freeze_amount||0)))]):n("div",{staticClass:"amount"},[t._v(t._s("¥ "+(t.dataInfo&&t.dataInfo.freeze_amount||0)))])]),t._v(" "),n("div",{staticClass:"mywallet-topitem mywallet-r"},[n("div",{staticClass:"margbtm"},[t._v(t._s(t.$t("pay.payPassword")))]),t._v(" "),t.hasPassword?n("div",[n("span",{staticClass:"changepas",on:{click:t.changePassword}},[n("svg-icon",{staticClass:"shield-icon",attrs:{type:"shield"}}),t._v(t._s(t.$t("profile.walletpasset"))+"\n        ")],1)]):n("div",{staticStyle:{cursor:"pointer"},on:{click:t.setPassword}},[n("svg-icon",{staticClass:"shield-icon",attrs:{type:"warning"}}),t._v(t._s(t.$t("profile.setpaypassword"))+"\n      ")],1)]),t._v(" "),t.hasPassword?n("div",[t.showPasswordInput?n("wallet-password",{ref:"walletpass",attrs:{error:t.passError,"password-error-tip":t.passwordErrorTip},on:{close:function(e){t.showPasswordInput=!1},password:t.validatePass,findpaypwd:t.findPaypwd}}):t._e(),t._v(" "),t.showNewverify?n("set-newpassword",{on:{close:function(e){t.showNewverify=!1},password:t.checkpass}}):t._e(),t._v(" "),t.showNewverify2?n("repeat-newpassword",{ref:"repeatnewpass",attrs:{error:t.codeError},on:{close:t.repeatclose,password:t.checkpass2}}):t._e()],1):n("div",[t.setPasswordInput?n("set-password",{on:{close:function(e){t.setPasswordInput=!1},password:t.setPass}}):t._e(),t._v(" "),t.repPasswordInput?n("repeat-password",{ref:"repeatpass",attrs:{error:t.codeError},on:{close:function(e){t.repPasswordInput=!1},password:t.setPass2}}):t._e()],1),t._v(" "),t.isfindpwd?n("find-paypwd",{attrs:{mobile:t.dataInfo.user.mobile,phonenum:t.dataInfo.user.originalMobile},on:{close:function(e){t.isfindpwd=!1}}}):t._e(),t._v(" "),t.isWithoutphone?n("without-phone",{on:{close:function(e){t.isWithoutphone=!1}}}):t._e()],1),t._v(" "),n("el-tabs",{staticClass:"register-select",attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:t.$t("profile.withdrawalslist")}},[n("cash-dialog",{ref:"cash"})],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.freezeamount")}},[n("freeze-amount")],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.walletlist")}},[n("wallet-detail")],1),t._v(" "),n("el-tab-pane",{attrs:{label:t.$t("profile.orderlist")}},[n("order-detail")],1)],1),t._v(" "),t.isWithdraw?n("withdrawal",{on:{close:t.updateWithdraw}}):t._e()],1):t._e()}),[],!1,null,"dae42dfa",null);e.default=component.exports;installComponents(component,{SvgIcon:n(11).default,WalletPassword:n(808).default,SetNewpassword:n(809).default,RepeatNewpassword:n(810).default,SetPassword:n(811).default,RepeatPassword:n(812).default,FindPaypwd:n(301).default,WithoutPhone:n(302).default,CashDialog:n(813).default,FreezeAmount:n(814).default,WalletDetail:n(815).default,OrderDetail:n(817).default,Withdrawal:n(818).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(48),n(16);var r=n(8),o=n(12),head=(n(19),n(9),n(25),n(28),n(10)),c=n.n(head),l=n(65),d=n.n(l),h=n(1),m=n.n(h),f=n(45),v=n.n(f),_=n(55),y=n.n(_),w=n(298),C=n.n(w);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var k={name:"Post",mixins:[c.a,y.a,m.a,d.a,v.a,C.a],data:function(){return{title:this.$t("topic.publish"),editThread:{},categoryList:[],post:{id:"",title:"",text:"",imageList:[],videoList:[],attachedList:[]},payment:{paidType:"free",price:0,freeWords:0,attachmentPrice:0},location:{latitude:"",location:"",longitude:""},product:{},question:{beUser:"",orderId:"",price:"",isOnlooker:!1,paymentType:"free",isAnonymous:!1,isPaid:!1},editResourceShow:{showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1},typeInformation:{0:{type:0,headerText:"postText",textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!1,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!0,showCaller:!0,placeholder:"请输入您要发表的内容 ..."},1:{type:1,headerText:"postPost",textLimit:49999,showPayment:!0,showTitle:!0,showImage:!0,showVideo:!1,showAttached:!0,showEmoji:!0,showTopic:!0,showCaller:!0,placeholder:"请输入您要发表的内容 ..."},2:{type:2,headerText:"postVideo",textLimit:5e3,showPayment:!0,showTitle:!1,showImage:!1,showVideo:!0,showAttached:!1,showEmoji:!0,showTopic:!0,showCaller:!0,placeholder:"请输入您要发表的内容 ..."},3:{type:3,headerText:"postImage",textLimit:5e3,showPayment:!0,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!0,showCaller:!0,placeholder:"请输入您要发表的内容 ..."},5:{type:5,headerText:"postQA",textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!0,showCaller:!0,placeholder:"请输入您要发表的内容 ..."},6:{type:6,headerText:"postProduct",textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!0,showCaller:!0,placeholder:"请输入您要发表的内容 ..."}},categorySelectedId:"",isEditor:!1,onPublish:!1,showCheckoutCounter:!1,showPasswordInput:!1,showWxPay:!1,wechatQrCode:"",defaultLoading:!1,passwordError:!1,findPassword:!1,passwordErrorTip:""}},computed:{type:function(){return this.$route.query.type},threadId:function(){return this.$route.query.threadId},categoryId:function(){return this.$route.query.categoryId},forums:function(){return this.$store.state.site.info.attributes||{}},canWechatPay:function(){return!(!this.forums||!this.forums.paycenter)&&this.forums.paycenter.wxpay_close},textarea:function(){return document.querySelector("#textarea")},currentUser:function(){return this.$store.state.user.info.attributes||{}},beaskId:function(){return this.$route.query.beaskId}},mounted:function(){if(["0","1","2","3","5","6"].indexOf(this.type)<0)return this.$router.replace("/error");this.getCategoryList(),this.getThread(),this.beaskId&&this.getBeAskUserInfo()},methods:{getBeAskUserInfo:function(){var t=this;this.$store.dispatch("jv/get",["users/".concat(this.beaskId),{params:{include:"groups"}}]).then((function(e){e&&(t.question.beUser=e)})).catch((function(e){t.handleError(e)}))},getCategoryList:function(){var t=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(e){t.categoryList=e,t.categoryId&&(t.categorySelectedId=t.categoryId)}),(function(e){return t.handleError(e)}))},getThread:function(){var t=this;if(this.threadId)return this.$store.dispatch("jv/get",["threads/".concat(this.threadId),{params:{include:"firstPost,firstPost.images,firstPost.attachments,category,threadVideo"}}]).then((function(data){if(data.isDeleted)return t.$router.push("/");t.initData(data),t.isEditor=!0,t.textarea&&t.$nextTick((function(){t.textarea.style.height=t.textarea.scrollHeight+"px"})),data.firstPost.images.length>0&&(t.editResourceShow.showUploadImg=!0,t.initThreadResource(t.post.imageList,data.firstPost.images)),data.firstPost.attachments.length>0&&(t.editResourceShow.showUploadAttached=!0,t.initThreadResource(t.post.attachedList,data.firstPost.attachments)),data.threadVideo&&Object.keys(data.threadVideo).length>0&&(t.editResourceShow.showUploadVideo=!0,t.initThreadResource(t.post.videoList,[data.threadVideo],"videoList"),t.post.videoList[0].videoPercent=1)}),(function(e){return t.handleError(e)}))},initData:function(data){this.editThread=data,this.categorySelectedId=data.category._jv.id,this.post.title=data.title,this.post.text=data.firstPost.content,this.post.id=data.firstPost._jv.id,this.payment.price=parseFloat(data.price),this.payment.attachmentPrice=parseFloat(data.attachmentPrice),this.payment.freeWords=data.freeWords,0===parseFloat(data.price)&&0===parseFloat(data.attachmentPrice)?this.payment.paidType="free":parseFloat(data.price)>0&&0===parseFloat(data.attachmentPrice)?this.payment.paidType="paid":0===parseFloat(data.price)&&parseFloat(data.attachmentPrice)>0&&(this.payment.paidType="attachmentPaid"),this.location.location=data.location,this.location.latitude=data.latitude,this.location.longitude=data.longitude,this.product=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},data.firstPost.postGoods)},initThreadResource:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.forEach((function(e){var r={name:"videoList"===n?e.file_name:e.fileName,url:"videoList"===n?e.media_url:e.thumbUrl,id:"videoList"===n?e.file_id:e._jv.id,size:"videoList"===n?"":e.fileSize,deleted:!1};t.push(r)}))},paying:function(t){var e=this,n=t.payWay,r=t.hideAvatar,o=t.rewardAmount;if(!o||0===parseFloat(o))return this.$message.error(this.$t("pay.AmountCannotBeLessThan0"));this.question.price=o,this.showCheckoutCounter=!1;var c=this.question.beUser._jv.id;if("walletPay"===n)this.createOrder(r,this.question.price,5,20,c).then((function(){e.showPasswordInput=!0})).finally((function(){e.defaultLoading=!1}));else if("wxPay"===n){if(!this.forums.paycenter.wxpay_close)return this.$message.warning(this.$t("pay.wxPayClose"));this.createOrder(r,this.question.price,5,10,c).then((function(){e.payOrder().then((function(t){e.wechatQrCode=t,e.wxPayActive().then((function(t){e.question.orderId=t,e.question.isPaid=!0,e.publish()}),(function(){}))}),(function(){}))})).finally((function(){e.defaultLoading=!1}))}},payQA:function(){this.showCheckoutCounter=!0},onPasswordInputCompleted:function(t){var e=this;this.payOrder(t).then((function(t){e.question.orderId=t,e.question.isPaid=!0,e.publish()}),(function(){}))},checkPublish:function(){if(this.isLogin())return this.categorySelectedId?this.post.text.length>this.typeInformation[this.type].textLimit?this.$message.warning(this.$t("post.messageLengthCannotOver")):("0"!==this.type||this.post.text)&&("1"!==this.type||this.post.text)?"1"!==this.type||this.post.title?"1"===this.type&&this.post.title&&this.post.title.length>150?this.$message.warning(this.$t("post.titleLengthCannotOver")):"1"===this.type&&"attachmentPaid"===this.payment.paidType&&0===this.post.attachedList.length?this.$message.warning(this.$t("post.attachmentListCanNotBeEmptyWhileAttachmentPaid")):"2"===this.type&&0===this.post.videoList.length?this.$message.warning(this.$t("post.videoCannotBeEmpty")):"3"===this.type&&0===this.post.imageList.length?this.$message.warning(this.$t("post.imageCannotBeEmpty")):"4"!==this.type||this.post.text?"5"!==this.type||this.question.beUser.username?"5"!==this.type||this.post.text?"5"!==this.type||"paid"!==this.question.paymentType||this.question.isPaid?"6"===this.type&&(0===Object.keys(this.product).length||this.product&&this.product._jv&&!this.product._jv.id)?this.$message.warning(this.$t("post.goodsEmpty")):"paid"===this.payment.paidType&&0===this.payment.price?this.$message.warning(this.$t("post.paidTypePaidPriceCanNotBeZero")):"paid"===this.payment.paidType&&this.payment.price<.1?this.$message.warning(this.$t("post.paidAmountTooLow")):"attachmentPaid"===this.payment.paidType&&0===this.payment.attachmentPrice?this.$message.warning(this.$t("post.paidTypeAttachmentPaidPriceCanNotBeZero")):"attachmentPaid"===this.payment.paidType&&this.payment.attachmentPrice<.1?this.$message.warning(this.$t("post.paidAmountTooLow")):"success":this.payQA():this.$message.warning(this.$t("post.theContentCanNotBeBlank")):this.$message.warning(this.$t("post.pleaseChooseBeAskedUser")):this.$message.warning(this.$t("post.theContentCanNotBeBlank")):this.$message.warning(this.$t("post.theTitleCanNotBeBlank")):this.$message.warning(this.$t("post.theContentCanNotBeBlank")):this.$message.warning(this.$t("post.theClassifyCanNotBeBlank"))},publish:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("success"===t.checkPublish()){e.next=2;break}return e.abrupt("return");case 2:if(t.onPublish=!0,!t.isEditor){e.next=5;break}return e.abrupt("return",Promise.all([t.editThreadPublish(),t.editPostPublish()]).then((function(e){t.$router.push("/thread/".concat(e[0]._jv.id))}),(function(e){return t.handleError(e)})).finally((function(){t.onPublish=!1})));case 5:if(n={_jv:{type:"threads",relationships:{category:{data:{type:"categories",id:t.categorySelectedId}}}},content:t.post.text},t.post.title&&(n.title=t.post.title),n.type=t.type,n=t.publishPayment(n,t.payment),n=t.publishLocation(n,t.location),n=t.publishThreadResource(n,t.post),n=t.publishPostResource(n,t.post),"5"===t.type&&(n=t.publishQuestion(n,t.question)),"6"===t.type&&(n=t.publishProduct(n,t.product)),!t.forums.other.create_thread_with_captcha){e.next=25;break}return e.prev=15,e.next=18,t.checkCaptcha(n);case 18:n=e.sent,e.next=25;break;case 21:return e.prev=21,e.t0=e.catch(15),t.onPublish=!1,e.abrupt("return");case 25:return e.abrupt("return",t.$store.dispatch("jv/post",n).then((function(data){t.$router.push("/thread/".concat(data._jv.id))}),(function(e){return t.handleError(e)})).finally((function(){t.onPublish=!1})));case 26:case"end":return e.stop()}}),e,null,[[15,21]])})))()},editPostPublish:function(){var t={_jv:{type:"posts",relationships:{}},content:this.post.text};return this.threadId&&(t._jv.id=this.threadId),t=this.publishPostResource(t,this.post),"6"===this.type&&(t=this.publishProduct(t,this.product)),this.deleteAttachmentsAfterEdit(this.editThread.firstPost.attachments,this.post.attachedList),this.$store.dispatch("jv/patch",[t,{url:"/posts/".concat(this.post.id)}])},editThreadPublish:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={_jv:{type:"threads",relationships:{category:{data:{type:"categories",id:t.categorySelectedId}}}}},t.threadId&&(n._jv.id=t.threadId),t.post.title&&(n.title=t.post.title),n.type=t.type,n=t.publishPayment(n,t.payment),n=t.publishLocation(n,t.location),n=t.publishThreadResource(n,t.post),!t.forums.other.create_thread_with_captcha){e.next=18;break}return e.prev=8,e.next=11,t.checkCaptcha(n);case 11:n=e.sent,e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(8),t.onPublish=!1,e.abrupt("return");case 18:return e.abrupt("return",t.$store.dispatch("jv/patch",[n,{url:"/threads/".concat(t.threadId)}]));case 19:case"end":return e.stop()}}),e,null,[[8,14]])})))()}}},x=(n(748),n(0)),component=Object(x.a)(k,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.defaultLoading,expression:"defaultLoading"}],staticClass:"page-post"},[t.type?n("div",{staticClass:"title"},[t._v(t._s(t.$t("post."+t.typeInformation[t.type].headerText)))]):t._e(),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:0===t.categoryList.length,expression:"categoryList.length === 0"}],staticClass:"category-list"},[t._l(t.categoryList,(function(e,r){return[e.canCreateThread?n("span",{key:r,class:{category:!0,selected:t.categorySelectedId===e._jv.id},on:{click:function(n){t.categorySelectedId=e._jv.id}}},[t._v(t._s(e.name))]):t._e()]}))],2),t._v(" "),n("editor",{attrs:{"type-information":t.typeInformation[t.type],"edit-resource-show":t.editResourceShow,question:t.question,product:t.product,payment:t.payment,"on-publish":t.onPublish,"is-edit":t.isEditor,post:t.post},on:{"update:question":function(e){t.question=e},"update:product":function(e){t.product=e},"update:payment":function(e){t.payment=e},"update:post":function(e){t.post=e},publish:t.publish}}),t._v(" "),t.showCheckoutCounter?n("topic-checkout-counter",{attrs:{"thread-type":5,user:t.currentUser||{},amount:0,"be-asked-user":t.question.beUser||{},"show-anonymous":!1,"show-wechat-pay":t.canWechatPay,"reward-or-pay":"reward"},on:{close:function(e){t.showCheckoutCounter=!1},paying:t.paying}}):t._e(),t._v(" "),t.showPasswordInput?n("topic-password",{attrs:{price:t.question.price,"password-error":t.passwordError,"password-error-tip":t.passwordErrorTip},on:{"update:passwordError":function(e){t.passwordError=e},"update:password-error":function(e){t.passwordError=e},close:function(e){t.showPasswordInput=t.passwordError=!1},password:t.onPasswordInputCompleted,findPassword:t.onFindPassword}}):t._e(),t._v(" "),t.showWxPay?n("topic-wx-pay",{attrs:{"qr-code":t.wechatQrCode},on:{close:function(e){t.showWxPay=!1}}}):t._e(),t._v(" "),t.findPassword&&t.currentUser.originalMobile?n("find-paypwd",{attrs:{mobile:t.currentUser.mobile,phonenum:t.currentUser.originalMobile},on:{close:function(e){t.findPassword=!1}}}):t._e(),t._v(" "),t.findPassword&&!t.currentUser.originalMobile?n("without-phone",{on:{close:function(e){t.findPassword=!1}}}):t._e()],1)}),[],!1,null,"5330780d",null);e.default=component.exports;installComponents(component,{Editor:n(88).default,TopicCheckoutCounter:n(369).default,TopicPassword:n(368).default,TopicWxPay:n(303).default,FindPaypwd:n(301).default,WithoutPhone:n(302).default})},function(t,e,n){"use strict";n.r(e);n(16);var r=n(8),o=(n(28),{data:function(){return{close_tips:"",forums:""}},mounted:function(){var t=this;this.getSiteInfo(),this.$store.dispatch("jv/get","/forum").then((function(e){t.forums=e,t.forums&&t.forums.set_site&&!t.forums.set_site.site_close&&window.location.replace("/")}))},methods:{getSiteInfo:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.$store.state.forum.error,t.close_tips=n?n.detail:"";case 2:case"end":return e.stop()}}),e)})))()}},head:function(){return{title:this.$t("site.siteClose")}}}),c=(n(730),n(0)),component=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"close-info"},[e("div",{staticClass:"title"},[this._v("抱歉，论坛暂时关闭")]),this._v(" "),e("div",{staticClass:"text"},[this._v("管理员关闭了论坛，请稍后访问。")]),this._v(" "),e("div",{staticClass:"time"},[this._v(this._s(this.close_tips))])])}),[],!1,null,"79b9670f",null);e.default=component.exports},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(1),l=n.n(c),head=n(10),d=null,h={mixins:[n.n(head).a,l.a],data:function(){return{title:this.$t("profile.circleinfo"),isLogin:this.$store.getters["session/get"]("isLogin"),qrcodeShow:!1,payStatus:0,orderSn:"",codeUrl:"",site_price:0,threadsData:[],loading:!0,canDetail:!1,currentAudioId:"",preurl:"/"}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},userId:function(){return this.$store.getters["session/get"]("userId")}},watch:{userId:function(t){t&&this.userinfo()},forums:{handler:function(t){t.set_site&&t.set_site.site_price&&(this.site_price=(1*t.set_site.site_price).toFixed(2))}}},mounted:function(){this.preurl=this.$route.fullPath,this.userId&&this.userinfo(),this.loadThreads(),this.site_price=this.forums&&this.forums.set_site&&this.forums.set_site.site_price?(1*this.forums.set_site.site_price).toFixed(2):0,(this.forums.set_site&&this.forums.set_site.site_mode||!this.userId)&&(this.canDetail=!0)},methods:{time2YearMonthDay:function(t){var e=new Date(t);return["".concat(e.getFullYear(),"年"),e.getMonth()<10?"0".concat(e.getMonth()+1,"月"):"".concat(e.getMonth()+1,"月"),e.getDate()<10?"0".concat(e.getDate(),"日"):"".concat(e.getDate(),"日")].join("")},userinfo:function(){var t=this;this.$store.dispatch("jv/get",["users/".concat(this.userId),{params:{include:"groups,wechat"}}]).then((function(e){e.paid&&t.$router.push("/")}))},tologin:function(){this.$router.push("/user/login?preurl=".concat(this.preurl))},paysureShow:function(){this.creatOrder(this.forums.set_site.site_price,1,this.value)},creatOrder:function(t,e,n){var r=this,o={_jv:{type:"orders"},type:e,amount:t};this.$store.dispatch("jv/post",o).then((function(t){r.orderSn=t.order_sn,r.orderPay(10,n,r.orderSn,"3")}),(function(t){return r.handleError(t)}))},orderPay:function(t,e,n,r){var o,c=this;o={_jv:{type:"trade/pay/order/".concat(n)},payment_type:t},this.$store.dispatch("jv/post",o).then((function(t){c.wxRes=t,"3"===r&&t&&(c.codeUrl=t.wechat_qrcode,c.payShowStatus=!1,c.qrcodeShow=!0,d=setInterval((function(){1!==c.payStatus?c.getOrderStatus(c.orderSn,r):clearInterval(d)}),3e3))}),(function(t){return c.handleError(t)}))},getOrderStatus:function(t,e){var n=this;this.$store.dispatch("jv/get","orders/".concat(t)).then((function(t){n.payStatus=t.status,1===n.payStatus&&(n.payShowStatus=!1,"3"===e&&(n.qrcodeShow=!1),window.location.href="/",n.$message.success(n.$t("pay.paySuccess")))})).catch((function(){n.$message.success(n.$t("pay.payFail"))}))},loadThreads:function(){var t=this;this.loading=!0;var e={"filter[isDeleted]":"no",sort:"-createdAt",include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question,question.beUser,question.beUser.groups","page[number]":1,"page[limit]":10,"filter[isApproved]":1,"filter[isSite]":"yes"};o.b.run((function(){return t.$store.dispatch("jv/get",["threads",{params:e}])})).then((function(e){t.loading=!1,t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(e))}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},m=(n(731),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"infocontainer"},[t.forums&&t.forums.users?n("div",{staticClass:"info"},[n("h2",{staticClass:"info-title"},[t._v(t._s(t.$t("manage.payJoin")))]),t._v(" "),n("div",{staticClass:"payinfo"},[n("p",{staticClass:"payinfo-title"},[t._v(t._s(t.$t("manage.payInfoTitle")))]),t._v(" "),n("p",[n("span",{staticClass:"color"},[t._v(t._s(t.$t("post.paymentAmount")))]),t._v(" "),n("span",{staticClass:"paymoney"},[t._v(t._s("¥ "+t.site_price+" ")+"元")])]),t._v(" "),n("p",[n("span",{staticClass:"date color"},[t._v(t._s(t.$t("site.periodvalidity")))]),t._v(" "),n("span",{staticClass:"workdate"},[t._v("自加入起 "+t._s(t.forums.set_site&&t.forums.set_site.site_expire?(t.forums.set_site&&t.forums.set_site.site_expire)+" "+t.$t("site.day"):t.$t("site.permanent")))])])]),t._v(" "),n("div",{staticClass:"content-info abs"},[n("p",[n("span",{staticClass:"color"},[t._v(t._s(t.$t("site.creationtime")))]),t._v(" "),n("span",{staticClass:"workdate"},[t._v(t._s(t.forums.set_site&&t.time2YearMonthDay(t.forums.set_site.site_install)))])]),t._v(" "),n("p",[n("span",{staticClass:"date color"},[t._v(t._s(t.$t("site.circlemaster")))]),t._v(" "),t.forums.set_site&&t.forums.set_site.site_author?n("span",{staticClass:"img"},[n("Avatar",{staticClass:"avatar",attrs:{user:{username:t.forums.set_site&&t.forums.set_site.site_author&&t.forums.set_site.site_author.username||"",avatarUrl:t.forums.set_site&&t.forums.set_site.site_author&&t.forums.set_site.site_author.avatar||""},size:30,round:!0}})],1):n("span",[n("avatar",{attrs:{user:{id:0,username:"无",avatarUrl:""},"prevent-jump":!0,size:30,round:!0}})],1),t._v(" "),n("span",{staticClass:"workdate3"},[t._v("\n          "+t._s(t.forums.set_site&&t.forums.set_site.site_author&&t.forums.set_site.site_author.username||"")+"\n        ")])]),t._v(" "),n("p",[n("span",{staticClass:"date color"},[t._v(t._s(t.$t("home.theme")))]),t._v(" "),n("span",{staticClass:"workdate bold"},[t._v(t._s(t.forums.other&&t.forums.other.count_users))])]),t._v(" "),n("p",{staticClass:"member-img"},t._l(t.forums.users,(function(t,e){return n("span",{key:e,staticClass:"img"},[n("Avatar",{staticClass:"avatar",attrs:{user:t,size:30,round:!0}})],1)})),0),t._v(" "),n("p",[n("span",{staticClass:"date color "},[t._v(t._s(t.$t("manage.contents")))]),t._v(" "),n("span",{staticClass:"workdate bold"},[t._v(t._s(t.forums.other&&t.forums.other.count_threads))])]),t._v(" "),n("p",[n("span",{staticClass:"date color rel"},[t._v(t._s(t.$t("manage.siteintroduction")))]),t._v(" "),n("span",{staticClass:"workdate2"},[t._v(t._s(t.forums.set_site&&t.forums.set_site.site_introduction))])])]),t._v(" "),t.isLogin?n("p",{staticClass:"joinnow"},[n("span",[t._v(t._s(t.$t("site.justonelaststepjoinnow")))]),t._v(" "),n("span",{staticClass:"bold"},[t._v("\n        "+t._s(t.forums.set_site&&t.forums.set_site.site_name)+"\n      ")]),t._v(" "),n("span",[t._v(t._s(t.$t("site.site")))]),t._v(" "),n("el-button",{class:t.isLogin?"r-button islogin":"r-button",attrs:{type:"primary"},on:{click:t.paysureShow}},[t._v("\n        "+t._s(t.$t("site.paynow"))+"，¥"+t._s(" "+t.site_price+" "||!1)+"\n        "+t._s(t.forums.set_site&&t.forums.set_site.site_expire?"  / "+t.$t("site.periodvalidity")+(t.forums.set_site&&t.forums.set_site.site_expire)+t.$t("site.day"):" / "+t.$t("site.permanent"))+"\n      ")])],1):t._e(),t._v(" "),t.isLogin?t._e():n("div",[n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.tologin}},[t._v(t._s(t.$t("site.joinnow")))])],1),t._v(" "),t.qrcodeShow?n("topic-wx-pay",{attrs:{"qr-code":t.codeUrl},on:{close:function(e){t.qrcodeShow=!1}}}):t._e()],1):t._e(),t._v(" "),t.threadsData.length>0?n("div",{staticClass:"thread"},[n("div",{staticClass:"threadtitle"},[t._v("部分内容预览")]),t._v(" "),t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,infoimage:!0,"can-detail":t.canDetail},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e,infoimage:!0,"can-detail":t.canDetail}})]}))],2):t._e()])}),[],!1,null,"a65ce6bc",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,Avatar:n(20).default,TopicWxPay:n(303).default,PostItem:n(57).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(9),n(13)),c=n(23),l=n.n(c),d=n(1),h=n.n(d),head=n(10),m=n.n(head),f={mixins:[l.a,h.a,m.a],data:function(){return{isLogin:this.$store.getters["session/get"]("isLogin"),pageSize:7,pageNum:1,userList:[],threadsData:[],searchText:"",permission:[],inviteData:{},dialogVisible:!1,codeTips:"",codeTitle:"",inviteCode:"",normal:!1,loading:!0,canDetail:!1,currentAudioId:"",title:this.$t("site.inviteJoin")}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var code=this.$route.query.code;this.inviteCode=code,this.getInviteInfo(this.inviteCode),this.loadThreads(),(this.forums&&this.forums.set_site&&this.forums.set_site.site_mode||!this.userId)&&(this.canDetail=!0)},methods:{handleClose:function(t){this.$confirm("确认关闭？").then((function(){t()})).catch((function(){}))},getInviteInfo:function(code){var t=this;o.b.run((function(){return t.$store.dispatch("jv/get","invite/".concat(code)).then((function(e){t.inviteData=e,t.check2();var n=e.group.permission.filter((function(t){return"createThread"!==t.permission}));t.permission=n.slice(0,3)})).catch((function(e){t.check2()}))}))},check:function(){if(this.inviteCode&&32!==this.inviteCode.length)this.inviteData.id?this.submit():(this.codeTips=this.$t("site.codenotfound"),this.dialogVisible=!0);else switch(this.inviteData.status||0===this.inviteData.status?this.inviteData.status:"error"){case 0:this.codeTips=this.$t("site.codeinvalid"),this.dialogVisible=!0;break;case 1:this.submit();break;case 2:this.codeTips=this.$t("site.codeused"),this.dialogVisible=!0;break;case 3:this.codeTips=this.$t("site.codeexpired"),this.dialogVisible=!0;break;case"error":this.codeTips=this.$t("site.codenotfound"),this.dialogVisible=!0;break;default:return""}},check2:function(){if(this.inviteCode&&32!==this.inviteCode.length)this.inviteData.id?(this.codeTitle=this.$t("manage.payJoin"),this.codeTips=this.$t("manage.inviteInfoTitle"),this.normal=!0):(this.codeTitle=this.$t("site.codenotfound2"),this.codeTips=this.$t("site.codenotfound"));else switch(this.inviteData.status||0===this.inviteData.status?this.inviteData.status:"error"){case 0:this.codeTitle=this.$t("site.codeinvalid2"),this.codeTips=this.$t("site.codeinvalid");break;case 1:this.codeTitle=this.$t("manage.payJoin"),this.codeTips=this.$t("manage.inviteInfoTitle"),this.normal=!0;break;case 2:this.codeTitle=this.$t("site.codeused2"),this.codeTips=this.$t("site.codeused");break;case 3:this.codeTitle=this.$t("site.codeexpired2"),this.codeTips=this.$t("site.codeexpired");break;case"error":this.codeTitle=this.$t("site.codenotfound2"),this.codeTips=this.$t("site.codenotfound");break;default:return""}},submit:function(){this.dialogVisible=!1,this.$store.getters["session/get"]("isLogin")?this.$router.push("/"):this.handleLogin("/",this.inviteCode)},loadThreads:function(){var t=this;this.loading=!0;var e={"filter[isDeleted]":"no",sort:"-createdAt",include:"user,user.groups,firstPost,firstPost.images,firstPost.postGoods,category,threadVideo,threadAudio,question,question.beUser,question.beUser.groups","page[number]":1,"page[limit]":10,"filter[isApproved]":1,"filter[isSite]":"yes"};o.b.run((function(){return t.$store.dispatch("jv/get",["threads",{params:e}])})).then((function(e){t.loading=!1,t.threadsData=[].concat(Object(r.a)(t.threadsData),Object(r.a)(e))}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},v=(n(733),n(0)),component=Object(v.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"infocontainer"},[t.forums&&t.forums.users?n("div",{staticClass:"info"},[n("h2",{class:t.normal?"info-title":"info-title tcolor"},[t._v(t._s(t.codeTitle))]),t._v(" "),n("div",{staticClass:"content-info abs"},[n("p",{staticClass:"payinfo-title"},[t._v(t._s(t.codeTips))]),t._v(" "),n("p",[n("span",{staticClass:"color"},[t._v(t._s(t.$t("site.creationtime")))]),t._v(" "),n("span",{staticClass:"workdate"},[t._v(t._s(t.forums.set_site&&t.forums.set_site.site_install))])]),t._v(" "),n("p",[n("span",{staticClass:"date color"},[t._v(t._s(t.$t("site.circlemaster")))]),t._v(" "),t.forums.set_site&&t.forums.set_site.site_author?n("span",{staticClass:"img"},[n("Avatar",{staticClass:"avatar",attrs:{user:{username:t.forums.set_site&&t.forums.set_site.site_author&&t.forums.set_site.site_author.username||"",avatarUrl:t.forums.set_site&&t.forums.set_site.site_author&&t.forums.set_site.site_author.avatar||""},size:30,round:!0}})],1):n("span",[n("avatar",{attrs:{user:{id:0,username:"无",avatarUrl:""},"prevent-jump":!0,size:30,round:!0}})],1),t._v(" "),n("span",{staticClass:"workdate"},[t._v(t._s(t.forums.set_site&&t.forums.set_site.site_author&&t.forums.set_site.site_author.username||""))])]),t._v(" "),n("p",[n("span",{staticClass:"date color"},[t._v(t._s(t.$t("home.theme")))]),t._v(" "),n("span",{staticClass:"workdate bold"},[t._v(t._s(t.forums.other&&t.forums.other.count_users))])]),t._v(" "),n("p",{staticClass:"member-img"},t._l(t.forums.users,(function(t,e){return n("span",{key:e,staticClass:"img"},[n("Avatar",{staticClass:"avatar",attrs:{user:t,size:30,round:!0}})],1)})),0),t._v(" "),n("p",[n("span",{staticClass:"date color"},[t._v(t._s(t.$t("manage.contents")))]),t._v(" "),n("span",{staticClass:"workdate bold"},[t._v(t._s(t.forums.other&&t.forums.other.count_threads))])]),t._v(" "),n("p",[n("span",{staticClass:"date color "},[t._v(t._s(t.$t("site.circlemode")))]),t._v(" "),n("span",{staticClass:"workdate"},[t._v("\n          "+t._s(t.forums.set_site&&"pay"===t.forums.set_site.site_mode?t.$t("site.paymentmode")+"， ¥"+(t.forums.set_site&&t.forums.set_site.site_price||0)+t.$t("post.yuan")+"， "+t.$t("site.periodvalidity")+(t.forums.set_site&&t.forums.set_site.site_expire||0)+t.$t("site.day"):t.$t("site.publicmode"))+"\n        ")])]),t._v(" "),n("div",{staticClass:"myauthority"},[n("div",{staticClass:"myauth-t "},[t._v(" "+t._s(t.$t("site.myauthority"))+" ")]),t._v(" "),n("div",{staticClass:"myauth-c"},t._l(t.permission,(function(e,r){return n("span",{key:r},[t._v(t._s(t.$t("permission."+e.permission)))])})),0)]),t._v(" "),n("p",[n("span",{staticClass:"date color rel"},[t._v(t._s(t.$t("manage.siteintroduction")))]),t._v(" "),n("span",{staticClass:"workdate2"},[t._v(t._s(t.forums.set_site&&t.forums.set_site.site_introduction))])])]),t._v(" "),n("p",[n("span",{staticClass:"bold"},[t._v(t._s(t.inviteData.user&&t.inviteData.user.username))]),t._v("\n      邀请您，作为\n      "),n("span",{staticClass:"bold"},[t._v(t._s("[ "+(t.inviteData.group&&t.inviteData.group.name?t.inviteData.group.name:"")+" ]"))]),t._v("加入\n      "),n("span",{staticClass:"bold"},[t._v(t._s(t.forums.set_site&&t.forums.set_site.site_name))]),t._v("\n      "+t._s(t.$t("site.site"))+"\n    ")]),t._v(" "),n("div",[n("el-button",{staticClass:"r-button",attrs:{type:"primary"},on:{click:t.check}},[t._v("\n        "+t._s(t.$t("site.accepttheinvitationandbecome"))+"\n        "+t._s(t.inviteData.group&&t.inviteData.group.name)+"\n      ")])],1),t._v(" "),n("el-dialog",{attrs:{title:"提示",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("span",[t._v(t._s(t.codeTips))]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)])],1):t._e(),t._v(" "),t.threadsData.length>0?n("div",{staticClass:"thread"},[n("div",{staticClass:"threadtitle"},[t._v("部分内容预览")]),t._v(" "),t._l(t.threadsData,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e,infoimage:!0,"can-detail":t.canDetail},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e,infoimage:!0,"can-detail":t.canDetail}})]}))],2):t._e()])}),[],!1,null,"764e39a8",null);e.default=component.exports;installComponents(component,{Avatar:n(20).default,Avatar:n(20).default,PostItem:n(57).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(19),n(25);var r=n(7),o=(n(18),n(9),n(12)),c=(n(16),n(8)),l=n(1),d=n.n(l),h=n(27),head=n(10);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={layout:"custom_layout",name:"Index",mixins:[n.n(head).a,d.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,h.a.isSpider||e(null,{}),n.prev=2,o={},n.next=6,r.dispatch("jv/get",["categories",{}]);case 6:c=n.sent,Array.isArray(c)?o.categoryData=c:c&&c._jv&&c._jv.json&&((l=c._jv.json.data||[]).forEach((function(t,e){l[e]=f(f(f({},t),t.attributes),{},{_jv:{id:t.id}})})),o.categoryData=l),e(null,o),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),e(null,{});case 14:case"end":return n.stop()}}),n,null,[[2,11]])})))()},data:function(){return{title:this.$t("search.search"),loading:!1,categoryData:[],threadsList:[],pageNum:1,pageSize:10,categoryId:0,q:"",hasMore:!1,threadCount:0,userCount:0,userList:[],userLoading:!1,userPageSize:3,currentAudioId:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{$route:"init"},mounted:function(){this.init()},methods:{init:function(){this.$route.query.categoryId&&(this.categoryId=this.$route.query.categoryId),this.$route.query.q&&(this.q=this.$route.query.q,this.getUserList(),this.pageNum=1,this.getThreadsList())},getUserList:function(){var t=this;this.userList=[],this.userLoading=!0;var e={include:"groups",sort:"createdAt","page[limit]":this.userPageSize,"filter[status]":"normal","filter[username]":"*".concat(this.q,"*")};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(e){var data=e;e&&data.forEach((function(t,i){data[i].groupName=t.groups[0]?t.groups[0].name:""})),t.userCount=data._jv.json.meta.total,t.userList=data}),(function(e){t.handleError(e)})).finally((function(){t.userLoading=!1}))},getThreadsList:function(){var t=this;this.loading=!0;var e={include:"user,user.groups,firstPost,firstPost.images,category,threadVideo,question,question.beUser,question.beUser.groups,firstPost.postGoods,threadAudio","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":this.categoryId,"filter[q]":this.q,"page[number]":this.pageNum,"page[limit]":this.pageSize};this.$store.dispatch("jv/get",["threads",{params:e}]).then((function(e){t.hasMore=e.length===t.pageSize,t.threadCount=e._jv.json.meta.threadCount,1===t.pageNum?t.threadsList=e:t.threadsList=[].concat(Object(r.a)(t.threadsList),Object(r.a)(e)),t.pageNum+=1,e._jv&&(t.hasMore=t.threadsList.length<e._jv.json.meta.threadCount)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getThreadsList()},reloadThreadsList:function(){this.pageNum=1,this.threadsList=[],this.getThreadsList()},onChangeCategory:function(t){this.categoryId=t,this.reloadThreadsList()},toUserList:function(){this.$route.query.q&&this.$router.push("/site/search-user?value=".concat(this.$route.query.q))},audioPlay:function(t){this.currentAudioId&&this.currentAudioId!==t&&this.$refs["audio".concat(this.currentAudioId)][0].pause(),this.currentAudioId=t}}},_=(n(734),n(0)),component=Object(_.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("div",{staticClass:"search-header"},[n("div",{staticClass:"result-count"},[t._v("\n        "+t._s(t.$t("search.find"))+" "),t.q?n("span",{staticClass:"keyword"},[t._v('"'+t._s(t.q)+'"')]):t._e(),t._v("\n        "+t._s(t.$t("search.searchresult"))+" "+t._s(t.userCount+t.threadCount)+" "+t._s(t.$t("topic.item"))+"\n      ")]),t._v(" "),n("create-post-popover")],1),t._v(" "),n("div",{staticClass:"count"},[t._v(t._s(t.$t("search.users")+t.userCount+t.$t("search.usercount"))+" ")]),t._v(" "),n("div",{staticClass:"user-list"},[n("div",{staticClass:"user-flex"},t._l(t.userList.slice(0,t.userPageSize),(function(e,r){return n("nuxt-link",{key:r,staticClass:"user-item",attrs:{to:"/user/"+e.id}},[n("avatar",{attrs:{user:e,size:45}}),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"name text-hidden"},[t._v(t._s(e.username))]),t._v(" "),n("div",{staticClass:"fans"},[t._v(t._s(t.$t("profile.followers"))+" "+t._s(e.fansCount||0))])])],1)})),1),t._v(" "),t.userLoading?n("loading"):[t.userCount>t.userPageSize?n("div",{staticClass:"user-load-more",on:{click:t.toUserList}},[t._v("\n          "+t._s(t.$t("topic.showMore"))+t._s(t.$t("search.users"))+"\n        ")]):t._e(),t._v(" "),0===t.userList.length?n("div",{staticClass:"no-more"},[n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}),t._v(t._s(t.$t("search.norelatedusersfound"))+"\n        ")],1):t._e()]],2),t._v(" "),n("div",{staticClass:"count"},[t._v(t._s(t.$t("home.invitation"))+" "+t._s(t.threadCount)+" "+t._s(t.$t("topic.item")))]),t._v(" "),n("div",{staticClass:"post-list"},[t._l(t.threadsList,(function(e,r){return[4===e.type?n("post-item",{key:r,ref:"audio"+(e&&e.threadAudio&&e.threadAudio._jv&&e.threadAudio._jv.id),refInFor:!0,attrs:{item:e},on:{audioPlay:t.audioPlay}}):n("post-item",{key:r,attrs:{item:e}})]})),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.threadsList.length},on:{loadMore:t.loadMore}})],2)]),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"category background-color"},[n("category",{attrs:{"post-loading":t.loading,list:t.categoryData},on:{onChange:t.onChangeCategory}})],1),t._v(" "),n("advertising"),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])}),[],!1,null,"3f59f381",null);e.default=component.exports;installComponents(component,{CreatePostPopover:n(304).default,Avatar:n(20).default,Loading:n(364).default,SvgIcon:n(11).default,PostItem:n(57).default,ListLoadMore:n(40).default,Category:n(136).default,Advertising:n(62).default,Copyright:n(63).default})},function(t,e,n){"use strict";n.r(e);var r=n(7),o=(n(19),n(9),n(25),n(16),n(8)),c=n(65),l=n.n(c),d=n(84),h=n.n(d),head=n(10),m=n.n(head),f=n(1),v=n.n(f),_=n(32),y=n.n(_),w=n(45),C=n.n(w),$=n(27),k="posts.replyUser,user.groups,user,posts,posts.user,posts.likedUsers,posts.images,firstPost,firstPost.likedUsers,firstPost.images,firstPost.attachments,rewardedUsers,category,threadVideo,paidUsers",x="user,likedUsers,commentPosts,commentPosts.user,commentPosts.user.groups,commentPosts.replyUser,commentPosts.replyUser.groups,commentPosts.mentionUsers,commentPosts.images,images,attachments",j={name:"Comment",layout:"custom_layout",mixins:[m.a,y.a,v.a,C.a,l.a,h.a],asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.store,r=t.query,$.a.isSpider){e.next=3;break}return e.abrupt("return",{});case 3:return o=r.threadId,c=r.commentId,e.prev=5,e.next=8,n.dispatch("jv/get",["threads/".concat(o),{params:{include:k}}]);case 8:return l=e.sent,e.next=11,n.dispatch("jv/get",["posts/".concat(c),{params:{include:x}}]);case 11:return d=e.sent,e.abrupt("return",{thread:l,comment:d});case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return",{loading:!0});case 18:case"end":return e.stop()}}),e,null,[[5,15]])})))()},data:function(){return{thread:{},comment:{},afterPushReply:!0,pageLimit:5,pageNumber:1,replyCount:0,isPositiveSort:!0,replyList:[],replyLoading:!1,scrollLoading:!1,loading:!1,onReplyPublish:!1,replyPost:{text:"",imageList:[],attachedList:[]},replyType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的回复 ..."}}},computed:{threadId:function(){return this.$route.query.threadId},commentId:function(){return this.$route.query.commentId}},mounted:function(){var t=this;0===Object.keys(this.comment).length&&this.getComment().then((function(){t.loading=!1})),0===Object.keys(this.thread).length&&this.getThread(),this.getReplyList("scroll")},methods:{getThread:function(){var t=this;return this.$store.dispatch("jv/get",["threads/".concat(this.threadId),{params:{include:k}}]).then((function(e){if(e.isDeleted)return t.$router.push("/404");t.thread=e}),(function(e){return t.handleError(e)}))},getComment:function(){var t=this;return this.$store.dispatch("jv/get",["posts/".concat(this.commentId),{params:{include:x}}]).then((function(e){if(e.isDeleted)return t.$router.push("/404");t.replyCount=e.replyCount,t.comment=e}),(function(e){return t.handleError(e)}))},getReplyList:function(t){var e=this;if(!this.replyLoading)return"commit"===t?this.replyLoading=!0:this.scrollLoading=!0,this.$store.dispatch("jv/get",["posts",{params:{"filter[thread]":this.threadId,"filter[reply]":this.commentId,"page[number]":this.pageNumber,"page[limit]":this.pageLimit,"filter[isDeleted]":"no","filter[isComment]":"yes",sort:this.isPositiveSort?"createdAt":"-createdAt",include:"replyUser,user.groups,user,images"}}]).then((function(data){var t;(t=e.replyList).push.apply(t,Object(r.a)(data)),e.pageNumber+=1}),(function(t){return e.handleError(t)})).finally((function(){e.replyLoading=e.scrollLoading=!1}))},changeSort:function(t){this.scrollLoading=!0,this.pageNumber=1,this.replyList=[],this.isPositiveSort=t,this.getReplyList("commit")},deleteComment:function(t){var e=this,n=t.id,r=t.type,o={_jv:{type:"posts",id:n},isDeleted:!0};this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$store.dispatch("jv/patch",o).then((function(){if("comment"===r)e.$router.push("/thread/".concat(e.thread._jv.id));else if("reply"===r){var t=e.replyList.filter((function(t){return t._jv.id===n}))[0];e.replyList.splice(e.replyList.indexOf(t),1),e.replyCount-=1}e.$message.success(e.$t("topic.deleteSuccess"))}),(function(t){return e.handleError(t)}))}),(function(){}))},onLike:function(t){var e=this,n=t.reply,r=t.index,o={_jv:{type:"posts",id:n._jv.id},isLiked:!n.isLiked,include:"replyUser,user.groups,user,images"};return this.$store.dispatch("jv/patch",o).then((function(data){e.$set(e.replyList,r,data)}),(function(t){return e.handleError(t)}))},replyPublish:function(t){var e,n,r=this;if(this.isLogin()){if(!this.replyPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.replyPost.text.length>this.replyType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onReplyPublish=!0;var o={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:null===(e=this.thread)||void 0===e||null===(n=e._jv)||void 0===n?void 0:n.id}}}},isComment:!0,replyId:t,content:this.replyPost.text};return this.publishPostResource(o,this.replyPost),this.$store.dispatch("jv/post",o).then((function(t){r.afterPushReply=!1,r.$nextTick((function(){r.afterPushReply=!0})),r.replyPost.text="",r.replyPost.imageList=[],r.replyCount+=1,r.isPositiveSort?r.replyList.length===r.replyCount&&r.replyList.push(t):r.replyList.unshift(t),r.postLegalityCheck(t,r.$t("topic.replyPublishSuccess"))}),(function(t){return r.handleError(t)})).finally((function(){r.onReplyPublish=!1}))}}},head:function(){return{title:this.comment?this.comment.summaryText:"评论详情页"}}},I=(n(741),n(0)),component=Object(I.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-comment"},[n("main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("div",{staticClass:"container-comment"},[n("div",{staticClass:"title"},[n("avatar-component",{attrs:{author:t.comment.user||{}}},[t._v("\n          "+t._s(t.timerDiff(t.comment.updatedAt)+t.$t("topic.before"))+"..\n        ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.comment.canHide,expression:"comment.canHide"}],staticClass:"delete-comment"},[n("div",{staticClass:"wrapper",on:{click:function(e){return t.deleteComment({id:t.comment._jv.id,type:"comment"})}}},[n("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{type:"trash"}}),t._v(" "),n("span",[t._v(t._s(t.$t("topic.delete")))])],1)])],1),t._v(" "),n("topic-content",{attrs:{article:t.comment||{},"paid-information":{paid:!0,price:0},"thread-type":3,category:{},video:{}}}),t._v(" "),n("div",{staticClass:"thread-card"},[n("avatar-component",{attrs:{size:40,round:"",author:t.thread&&t.thread.user||{}}},[t._v("\n          "+t._s(t.timerDiff(t.thread.createdAt)+t.$t("topic.before"))+" ..\n        ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.thread&&t.thread.firstPost,expression:"thread && thread.firstPost"}],staticClass:"content-html",domProps:{innerHTML:t._s(t.thread&&t.thread.firstPost&&t.$xss(t.thread.firstPost.summary)||"")}}),t._v(" "),n("nuxt-link",{staticClass:"view-more",attrs:{to:"/thread/"+(t.thread._jv?t.thread._jv.id:"")}},[t._v(t._s(t.$t("topic.viewDetail")))]),t._v(" "),t.thread&&t.thread.isEssence?n("svg-icon",{staticClass:"essence",staticStyle:{"font-size":"50px"},attrs:{type:"essence-comment"}}):t._e()],1),t._v(" "),n("div",{staticClass:"container-reply",attrs:{id:"reply"}},[t.replyCount?n("comment-header",{attrs:{"comment-count":t.replyCount,"is-positive-sort":t.isPositiveSort},on:{changeSort:t.changeSort}}):n("div",{staticClass:"without-comment"},[t._v(t._s(t.$t("topic.noComment")))]),t._v(" "),t.afterPushReply?n("editor",{staticClass:"reply-editor",staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{"editor-style":"comment",selector:"reply-editor","type-information":t.replyType,post:t.replyPost,"on-publish":t.onReplyPublish},on:{"update:post":function(e){t.replyPost=e},publish:function(e){return t.replyPublish(t.comment._jv.id)}}}):t._e(),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.replyLoading,expression:"replyLoading"}]},[n("reply-list",{attrs:{"reply-list":t.replyList||[]},on:{delete:t.deleteComment,onLike:t.onLike}})],1),t._v(" "),n("list-load-more",{attrs:{loading:t.scrollLoading,length:t.replyList.length,"has-more":t.replyCount>t.replyList.length,"page-num":t.pageNumber},on:{loadMore:function(e){return t.getReplyList("scroll")}}})],1)],1)]),t._v(" "),n("topic-aside",{attrs:{author:t.thread&&t.thread.user||{}}})],1)}),[],!1,null,"615f6621",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(72).default,SvgIcon:n(11).default,TopicContent:n(362).default,CommentHeader:n(371).default,Editor:n(88).default,ReplyList:n(816).default,ListLoadMore:n(40).default,TopicAside:n(370).default})},function(t,e,n){"use strict";n.r(e);n(34),n(22),n(19),n(25);var r=n(7),o=(n(18),n(9),n(12)),c=(n(16),n(8)),l=n(1),d=n.n(l),h=n(27),head=n(10),m=n.n(head);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _={layout:"custom_layout",name:"Index",mixins:[d.a,m.a],asyncData:function(t,e){return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.store,h.a.isSpider||e(null,{}),n.prev=2,o={},n.next=6,r.dispatch("jv/get",["categories",{}]);case 6:c=n.sent,Array.isArray(c)?o.categoryData=c:c&&c._jv&&c._jv.json&&((l=c._jv.json.data||[]).forEach((function(t,e){l[e]=v(v(v({},t),t.attributes),{},{_jv:{id:t.id}})})),o.categoryData=l),e(null,o),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),e(null,{});case 14:case"end":return n.stop()}}),n,null,[[2,11]])})))()},data:function(){return{loading:!1,categoryData:[],pageNum:1,pageSize:10,categoryId:0,value:"",hasMore:!1,userCount:0,userList:[],title:this.$t("search.search")}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{$route:"init"},mounted:function(){this.init()},methods:{init:function(){this.$route.query.categoryId&&(this.categoryId=this.$route.query.categoryId),this.$route.query.value&&(this.value=this.$route.query.value,this.reloadList())},getUserList:function(){var t=this;this.loading=!0;var e={include:"groups",sort:"createdAt","filter[status]":"normal","page[limit]":this.pageSize,"page[number]":this.pageNum,"filter[username]":"*".concat(this.value,"*")};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(e){var data=e;e&&data.forEach((function(t,i){data[i].groupName=t.groups[0]?t.groups[0].name:""})),t.userCount=data._jv.json.meta.total,t.hasMore=data.length===t.pageSize,1===t.pageNum?t.userList=data:t.userList=[].concat(Object(r.a)(t.userList),Object(r.a)(data)),t.pageNum+=1,data._jv&&(t.hasMore=t.userList.length<data._jv.json.meta.total)}),(function(e){t.handleError(e)})).finally((function(){t.loading=!1}))},loadMore:function(){this.getUserList()},reloadList:function(){this.pageNum=1,this.userList=[],this.getUserList()}}},y=(n(739),n(0)),component=Object(y.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("main",{staticClass:"cont-left"},[n("div",{staticClass:"search-header"},[n("div",{staticClass:"result-count"},[t._v("\n        "+t._s(t.$t("search.find"))+" "),t.value?n("span",{staticClass:"keyword"},[t._v('"'+t._s(t.value)+'"')]):t._e(),t._v("\n        "+t._s(t.$t("search.searchuserresult"))+" "+t._s(t.userCount)+" "+t._s(t.$t("topic.item"))+"\n      ")]),t._v(" "),n("create-post-popover")],1),t._v(" "),n("div",{staticClass:"user-list"},[n("div",{staticClass:"user-flex"},t._l(t.userList,(function(t,e){return n("user-item",{key:e,attrs:{item:t}})})),1),t._v(" "),n("list-load-more",{attrs:{loading:t.loading,"has-more":t.hasMore,"page-num":t.pageNum,length:t.userList.length,"load-more-text":t.$t("topic.showMore")+t.$t("search.users")},on:{loadMore:t.loadMore}})],1)]),t._v(" "),n("aside",{staticClass:"cont-right"},[n("div",{staticClass:"category background-color"},[n("category",{attrs:{list:t.categoryData}})],1),t._v(" "),n("advertising"),t._v(" "),n("copyright",{attrs:{forums:t.forums}})],1)])}),[],!1,null,"3842f67c",null);e.default=component.exports;installComponents(component,{CreatePostPopover:n(304).default,UserItem:n(372).default,ListLoadMore:n(40).default,Category:n(136).default,Advertising:n(62).default,Copyright:n(63).default})}]]);